Compiling Program: C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\sag-cfg.src
Memory Available: 2147483646
Including file: base.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\base.pkg)
1>>// Classes do VDF
1>>Use LanguageText.pkg
Including file: LanguageText.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\LanguageText.pkg)
1>>>>// Generic Language include file.
1>>>>
1>>>>// List all languages supported
1>>>>Enumeration_list
1>>>>    define Language$English
1>>>>    define Language$Nederlands
1>>>>    define Language$Svenska
1>>>>    define Language$Deutsch
1>>>>    define Language$Dansk
1>>>>    define Language$Portugues
1>>>>    define Language$Francais
1>>>>    define Language$Italiano
1>>>>    define Language$Espanol
1>>>>    define Language$Norsk
1>>>>    Define Language$Russian
1>>>>    Define Language$Polish
1>>>>    Define Language$Hungarian
1>>>>End_Enumeration_List
1>>>>
1>>>>// this will define Language$Current and include all language constants.
Including file: Language_Current.inc    (C:\Program Files (x86)\DataFlex 18.1\Pkg\Language_Current.inc)
1>>>>>// define current language. Included by LanguageText.pkg or LanguageTextWebApp.pkg
1>>>>>// (see LanguageText.pkg for a list of supported languages).
1>>>>>
1>>>>>Define Language$Current for Language$Portugues
Including file: Language_Portugues.inc    (C:\Program Files (x86)\DataFlex 18.1\Pkg\Language_Portugues.inc)
1>>>>>>// Commonly used symbols.
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>    
1>>>>>>// DataDict.pkg
Including file: Language_DD_Portugues.inc    (C:\Program Files (x86)\DataFlex 18.1\Pkg\Language_DD_Portugues.inc)
1>>>>>>>//
1>>>>>>>// Replacement text for DDOs.
1>>>>>>>//
1>>>>>>>
1>>>>>>>
1>>>>>>
1>>>>>>//Batchdd.pkg
1>>>>>>
1>>>>>>//cAnimation.pkg
1>>>>>>
1>>>>>>//cApplication.pkg
1>>>>>>
1>>>>>>//cHtmlHelp.pkg
1>>>>>>
1>>>>>>//cIniFile.pkg
1>>>>>>
1>>>>>>//cMapiHandler.Pkg
1>>>>>>
1>>>>>>//codecsl.pkg
1>>>>>>
1>>>>>>//Comm.pkg
1>>>>>>
1>>>>>>//CrystalReport.pkg
1>>>>>>
1>>>>>>//cWorkspace.pkg
1>>>>>>
1>>>>>>//DefaultStatusbar.pkg
1>>>>>>
1>>>>>>//Dfabout.pkg
1>>>>>>
1>>>>>>//Dfadlg.pkg
1>>>>>>
1>>>>>>//Dfbitmap.pkg
1>>>>>>
1>>>>>>//Dfcdsl.pkg
1>>>>>>
1>>>>>>//Dfconfrm.pkg
1>>>>>>
1>>>>>>//Dfenrad.pkg
1>>>>>>
1>>>>>>//Dferror.pkg
1>>>>>>
1>>>>>>//Dfrepky.pkg
1>>>>>>
1>>>>>>//Dfrpt.pkg
1>>>>>>
1>>>>>>//Dftimer.pkg
1>>>>>>
1>>>>>>//FlexCom.pkg
1>>>>>>    // these were originally in FlxOleUS.inc
1>>>>>>    // these were in the actual package
1>>>>>>
1>>>>>>//Flexml.pkg
1>>>>>>
1>>>>>>//GlobalFunctionsProcedures.pkg
1>>>>>>
1>>>>>>//RegistryAPI.pkg
1>>>>>>
1>>>>>>//SelectWorkspace.dg
1>>>>>>
1>>>>>>//seq_chnl.pkg
1>>>>>>
1>>>>>>//Sercomm.pkg
1>>>>>>
1>>>>>>//VersionControl.pkg
1>>>>>>
1>>>>>>//sql.pkg
1>>>>>>
1>>>>>>// Df_Print.pkg
Including file: Language_WinPrint_Portugues.inc    (C:\Program Files (x86)\DataFlex 18.1\Pkg\Language_WinPrint_Portugues.inc)
1>>>>>>>//****************************************************************************//
1>>>>>>>//                                                                            //
1>>>>>>>// $File name  : DFRPTEUS.INC                                                 //
1>>>>>>>// $File title : US error messages for WinPrint                               //
1>>>>>>>// Notice      : Copyright (c) ADB-UTVECKLING AB 1996-1997, Sweden            //
1>>>>>>>// $Author     : Janne Wassberg                                               //
1>>>>>>>// $System     : WinPrint                                                     //
1>>>>>>>// Created     : 97-01-11 @ 12.00.00                                          //
1>>>>>>>// $Last Rev   : 97-01-11 @ 12.00.00                                          //
1>>>>>>>//                                                                            //
1>>>>>>>// $Description  All error messages for WinPrint in Portugues                 //
1>>>>>>>//                                                                            //
1>>>>>>>//               The DataFlex class and DLL is written by:                    //
1>>>>>>>//                                                                            //
1>>>>>>>//               ADB-UTVECKLING AB                                            //
1>>>>>>>//               Gustvalundsv. 153                                            //
1>>>>>>>//               167 51 Bromma                                                //
1>>>>>>>//               Sweden                                                       //
1>>>>>>>//               Phone +46 (0)8 704 04 00                                     //
1>>>>>>>//               Fax   +46 (0)8 704 04 02                                     //
1>>>>>>>//               Compuserve  100336,2407                                      //
1>>>>>>>//               Internet    dataflex.adbutveckling.se                        //
1>>>>>>>//                                                                            //
1>>>>>>>//                                                                            //
1>>>>>>>// $Rev History                                                               //
1>>>>>>>//                                                                            //
1>>>>>>>//   97-01-11 Janne Wassberg                                                  //
1>>>>>>>//                                                                            //
1>>>>>>>//            Moved all error messages to a include file                      //
1>>>>>>>//                                                                            //
1>>>>>>>//****************************************************************************//
1>>>>>>>
1>>>>>>>
1>>>>>>>
1>>>>>>>
1>>>>>>
1>>>>>>// cXmlHttpTransfer.pkg and cClientWebService.pkg
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>// cWebService.pkg
1>>>>>>
1>>>>>>// cDbTextEdit and cDbRichEdit
1>>>>>>
1>>>>>>// cCrystal.pkg
1>>>>>>
1>>>>>>// cCrystalPreview.pkg
1>>>>>>
1>>>>>>// This adds all webapp constants. 
Including file: Language_WebApp_Portugues.inc    (C:\Program Files (x86)\DataFlex 18.1\Pkg\Language_WebApp_Portugues.inc)
1>>>>>>>//cHtmlreport.pkg
1>>>>>>>
1>>>>>>>//RemoteEntryMixin.pkg
1>>>>>>>
1>>>>>>>// cAutoWebReport.pkg
1>>>>>>>
1>>>>>>>// cVDFInternetSession.pkg
1>>>>>>>
1>>>>>>>//cInternetSessionBusinessProcess.plg
1>>>>>>>
1>>>>>>>//cDistributedBusinessProcess.pkg
1>>>>>>>
1>>>>>>>//cWebBusinessProcess.pkg
1>>>>>>>
1>>>>>>>//cWebApp.pkg
1>>>>>>>    
1>>>>>>>//cWebService.pkg
1>>>>>>>    
1>>>>>>>// cWebObject.pkg
1>>>>>>>
1>>>>>>>// cWebSyncPropsHandler.pkg
1>>>>>>>
1>>>>>>>// cWebControlLocator.pkg
1>>>>>>> 
1>>>>>>>// cWebList.pkg
1>>>>>>>    
1>>>>>>>// cWebGrid.pkg
1>>>>>>>    
1>>>>>>>// cWebPromptList,pkg    
1>>>>>>>     
1>>>>>>>// cWebView
1>>>>>>>    
1>>>>>>>// cWebSessionManagerStandard.pkg
1>>>>>>>    
1>>>>>>>// WebServerApplication.tpl
1>>>>>>>    
1>>>>>>>// WebServerMobileApplication.tpl
1>>>>>>>    
1>>>>>>>// WebMobileSelect.tpl
1>>>>>>>
1>>>>>>>// cWebViewStack.pkg
1>>>>>>>    
1>>>>>>>// cWebBaseDEOServer.pkg
1>>>>>>>
1>>>>>>>// cWebActionBar.pkg
1>>>>>>>
1>>>>>>>// cWebMenuButton.pkg
1>>>>>>>
1>>>>>>>//  Translation symbols
1>>>>>>>                        
1>>>>>>>
1>>>>>>>
1>>>>>>>
1>>>>>>>
1>>>>>>
1>>>>>>// cCJStandardMenuItemClasses.pkg
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>
1>>>>>>    
1>>>>>>
1>>>>>>
1>>>>>>    
1>>>>>>    
1>>>>>>
1>>>>>>
1>>>>>>    
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>// cCJDeoMenuItemClasses.pkg
1>>>>>>
1>>>>>>
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>    
1>>>>>>                                          
1>>>>>>                                          
1>>>>>>                                          
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>
1>>>>>>    // Note: These are only provided to support translations that match other
1>>>>>>    // keyboards for "Delete", "Ctrl", "Alt" and "Shift". Requring that the entire
1>>>>>>    // shortcut be translated allows the Studio to properly translate these. Only the
1>>>>>>    // absolute minimum keys are provided. We will add these as needed.
1>>>>>>
1>>>>>>
1>>>>>>// cCJSkinFramework
1>>>>>>
1>>>>>>    
1>>>>>>// cCJGrid related classes
1>>>>>>    
1>>>>>>    
1>>>>>>
1>>>>>
1>>>>
1>>Use DfAllEnt.pkg
Using pre-compiled package DFALLENT.PKG
Including file: dfallent.pkd    (C:\Program Files (x86)\DataFlex 18.1\Pkg\dfallent.pkd)
74655>>Use Dfaclnt.pkg
74655>>Use Dftimer.pkg
Including file: Dftimer.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\Dftimer.pkg)
74655>>>>//************************************************************************
74655>>>>//--- DFTimer   Timer package for DataFlex programs
74655>>>>//
74655>>>>// Copyright (c) 1983-2002 Data Access Corporation, Miami Florida,
74655>>>>// All rights reserved.
74655>>>>// DataFlex is a registered trademark of Data Access Corporation.
74655>>>>//
74655>>>>//************************************************************************
74655>>>>//  Description:
74655>>>>//      This package contains all components needed to implement timers
74655>>>>//      in a DataFlex 4 program.
74655>>>>//
74655>>>>//
74655>>>>//  Author: Eddy Kleinjan, Data Access Nederland
74655>>>>//************************************************************************
74655>>>>// 03/03/2001 EK  Fixed Timer_Active_State to check for valid windows
74655>>>>//                handle before trying to set or kill a timer.
74655>>>>//                Fixed Kill_All_Timers to check for valid windows
74655>>>>//                handle before trying to kill a timer.
74655>>>>//                The windows handle might not exist anymore when the
74655>>>>//                program is being exited using Exit_Application.
74655>>>>// 12/13/2001 JJT fixed Timer_Active_State to check for -1 (not 0). Fixed a
74655>>>>//                a bug where set Timeout started inactive timers.
74655>>>>//                Added code to force timer object to desktop
74655>>>>//************************************************************************
74655>>>>// CLASS DFTimer
74655>>>>//
74655>>>>// Usage:
74655>>>>//    Object MyTimer is a DFTimer
74655>>>>//
74655>>>>//        Set Timeout to 2000                             // Default 1000
74655>>>>//        Set Auto_Start_State to TRUE|FALSE              // Default TRUE
74655>>>>//        Set Auto_Stop_State to TRUE|FALSE               // Default TRUE
74655>>>>//        Set Timer_Message to MyMessage                  // Default 0
74655>>>>//        Set Timer_Object to (MyObject(self))            // Default 0
74655>>>>//        Set Timer_Active_State to TRUE|FALSE            // Default FALSE
74655>>>>//
74655>>>>//        // Augment when no Timer_Message
74655>>>>//        Procedure OnTimer
74655>>>>//            Send Info_Box "HEY, WAKE UP!"
74655>>>>//        End_Procedure
74655>>>>//
74655>>>>//    End_Object
74655>>>>//
74655>>>>// DESCRIPTION
74655>>>>//      Objects of this class can be used to trigger an event after a
74655>>>>//      certain amount of time has passed. You can specify this time
74655>>>>//      by setting the Timeout property of the object. This timeout
74655>>>>//      is in miliseconds.
74655>>>>//
74655>>>>//      Whenever a timer event happens, it will notify the object by
74655>>>>//      sending an OnTimer event. You can trap this event to do whatever
74655>>>>//      you want the timer to do. By default this OnTimer event
74655>>>>//      will send the Timer_Message to Timer_Object, when these have
74655>>>>//      been specified.
74655>>>>//
74655>>>>//      By default, you have to activate a timer by setting its
74655>>>>//      Timer_Active_State to TRUE. When the timer has been placed
74655>>>>//      inside a user-interface object, it can also be activated
74655>>>>//      automatically when this user-interface object is being
74655>>>>//      activated. This only happes when it Auto_Start_State is TRUE,
74655>>>>//      which is the default setting. In such a case, the timer will
74655>>>>//      also automatically being stopped when the user-interface
74655>>>>//      object is taken of the screen. This depends on the
74655>>>>//      Auto_Stop_Timer state to happen.
74655>>>>//
74655>>>>//      When you need to set a new timeout value, you can do so
74655>>>>//      even when the timer is active. It will adjust the timeout
74655>>>>//      immediately.
74655>>>>//
74655>>>>//      Note that timer events depend on Windows for the delivery of
74655>>>>//      the event. Since timer events get a low priority in Windows,
74655>>>>//      it might put your program on hold when other programs are very
74655>>>>//      busy. In such a case, you will only receive one timer event
74655>>>>//      after the process stopped. There is no way, other than
74655>>>>//      calculating it yourself, to determine how many time has passed
74655>>>>//      or how many timer event should have happened since the last
74655>>>>//      timer event or timer activation.
74655>>>>//
74655>>>>// PUBLIC INTERFACE
74655>>>>//
74655>>>>//    PROPERTIES
74655>>>>//
74655>>>>//    Auto_Start_State When TRUE (default) the timer will be activated
74655>>>>//                     automatically when the object will be (virtually)
74655>>>>//                     paged on the screen.
74655>>>>//                     Example: When a timer object has been placed
74655>>>>//                     inside a view, then the timer will be activated
74655>>>>//                     when the view is activated.
74655>>>>//
74655>>>>//    Auto_Stop_State  When TRUE (default) the timer will be deactivated
74655>>>>//                     automatically when the object will be (virtually)
74655>>>>//                     taken off the screen.
74655>>>>//
74655>>>>//    Timeout          The timeout value for the timer to fire. The
74655>>>>//                     timeout value must be set in miliseconds.
74655>>>>//                     This property may be set even when the timer is
74655>>>>//                     active. The new timeout value will be applied
74655>>>>//                     immediately.
74655>>>>//                     NOTE: The timeout set here is never precise. It
74655>>>>//                     depends on Windows to deliver the message to our
74655>>>>//                     application.
74655>>>>//                     Default 1000.
74655>>>>//
74655>>>>//    Timer_Active_State
74655>>>>//                     Set to TRUE to activate the timer, to FALSE to
74655>>>>//                     deactivate the timer.
74655>>>>//
74655>>>>//
74655>>>>//    Timer_Message    This property can be set to a messageID which has
74655>>>>//                     to be sent whenever a timer event occurs. Default
74655>>>>//                     this message will be send to the object itself
74655>>>>//                     unless a Timer_Object as been specified.
74655>>>>//
74655>>>>//    Timer_Object     This property can be set to an objectID which has
74655>>>>//                     to receive the Timer_Message whenever a timer
74655>>>>//                     event occurs. This value has no meaning when
74655>>>>//                     no Timer_Message has been set.
74655>>>>//
74655>>>>//    METHODS
74655>>>>//
74655>>>>//    OnTimer          This event will happen whenever the specified
74655>>>>//                     amount of time has passed and the timer is
74655>>>>//                     active. By default it sends the message in
74655>>>>//                     the Timer_Message property to the object in
74655>>>>//                     the Timer_Object when these have been specified.
74655>>>>//                     When you don't need this, you can just override
74655>>>>//                     the OnTimer event.
74655>>>>//
74655>>>>// PUBLIC INTERFACE
74655>>>>//
74655>>>>//    Page_Object      Has been augmented to auto_start the timer when
74655>>>>//                     it becomes active as part or a user-interface
74655>>>>//                     object.
74655>>>>//
74655>>>>//    Page_Delete      Has been augmented to auto_stop the timer when
74655>>>>//                     it is deactivated as part or a user-interface
74655>>>>//                     object.
74655>>>>//
74655>>>>//    Destroy_Object   Has been augmented to deactivate the timer.
74655>>>>//
74655>>>>Use LanguageText.pkg
74655>>>>Use Windows.pkg
74655>>>>Use WinUser.pkg
74655>>>>
74655>>>>External_Function SetTimer "SetTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Integer idTimeout ;    Pointer tmprc ;    Returns Integer
74656>>>>
74656>>>>External_Function KillTimer "KillTimer" User32.DLL ;    Integer hWnd ;    Integer idTimer ;    Returns Integer
74657>>>>
74657>>>>// This global integer holds the ID of the object
74657>>>>// that manages all timers.
74657>>>>Integer giTimerManager
74657>>>>
74657>>>>// This class is used to store the object IDs
74657>>>>// of the active timer objects. It augments
74657>>>>// the Destroy_Object procedure to notify
74657>>>>// the DFTimerManager to kill all its active
74657>>>>// timers.
74657>>>>// NOTE: This class looks very much like the
74657>>>>// Set class. I didn't want to use Set because
74657>>>>// Remove_Element shifts items which I don't
74657>>>>// want to happen because item numbers are used
74657>>>>// as timerIDs.
74657>>>>
74657>>>>Class TimersArray is an Array
74658>>>>
74658>>>>    Function Find_Object Integer iObj Returns Integer
74660>>>>        Integer iMax
74660>>>>        Integer iItem
74660>>>>        Integer iValue
74660>>>>        Get Item_count to iMax
74661>>>>        Decrement iMax
74662>>>>        For iItem from 1 to iMax
74668>>>>>
74668>>>>            Get Integer_Value item iItem to iValue
74669>>>>            If iValue EQ iObj;                Function_Return iItem
74672>>>>        Loop
74673>>>>>
74673>>>>        Function_Return -1
74674>>>>    End_Function
74675>>>>
74675>>>>    Procedure Add_Object Integer iObj Returns Integer
74677>>>>        Integer iItem
74677>>>>        Get Find_Object iObj to iItem
74678>>>>        If iItem LT 0 Begin
74680>>>>            Get Find_Object 0 to iItem
74681>>>>            If iItem LT 0 ;                Get Item_Count to iItem
74684>>>>        End
74684>>>>>
74684>>>>        Set Array_Value item iItem to iObj
74685>>>>        Procedure_Return iItem
74686>>>>    End_Procedure
74687>>>>
74687>>>>    Procedure Remove_Object Integer iObj
74689>>>>        Integer iItem
74689>>>>        Get Find_Object iObj to iItem
74690>>>>        If iItem GT 0 ;            Set Array_Value item iItem to 0
74693>>>>    End_Procedure
74694>>>>
74694>>>>    Procedure Destroy_Object
74696>>>>        Delegate Send Kill_All_Timers
74698>>>>        Forward Send Destroy_Object
74700>>>>    End_Procedure
74701>>>>
74701>>>>End_Class // TimersArray
74702>>>>
74702>>>>// This class is the actual timer manager
74702>>>>// A timer will be created when Message Set_Timer_Active_State
74702>>>>// has been send. This message needs two arguments. The first
74702>>>>// is the objectID of the object to receive the timer event,
74702>>>>// and the second is state. The object which ID has been passed,
74702>>>>// needs to have a Timeout property to return the timeout for the
74702>>>>// timer and it also needs to handle the MSG_OnTimer whenever a
74702>>>>// timer event occurs.
74702>>>>// The objectID of the Object will be placed in an array which contains
74702>>>>// the objectIDs of all active timers. The Windows timer ID of a timer
74702>>>>// is the itemnumber of the object in the array.
74702>>>>//
74702>>>>Class DFTimerManager is a DfBaseControl
74703>>>>
74703>>>>    Procedure Construct_Object
74705>>>>
74705>>>>        Forward Send Construct_Object
74707>>>>
74707>>>>        Set Visible_State to FALSE
74708>>>>
74708>>>>        Set External_Class_Name "cVdfTimer" to "static"
74709>>>>        Set External_Message WM_TIMER to OnTimer
74710>>>>
74710>>>>        Object TimersArray is a TimersArray
74712>>>>            Set Array_Value item 0 to -9999 // So we don't use item 0
74713>>>>        End_Object
74714>>>>
74714>>>>        Move self to giTimerManager
74715>>>>
74715>>>>    End_Procedure
74716>>>>
74716>>>>    Procedure Set Timer_Active_State Integer iObj Integer iState
74718>>>>        Integer iTimerID
74718>>>>        Integer iTimeout
74718>>>>        Integer iResult
74718>>>>        Integer iSet
74718>>>>        Dword   nResult
74718>>>>        Handle  hWnd
74718>>>>
74718>>>>        // Get the handle of this object
74718>>>>        Get Window_Handle to hWnd
74719>>>>        If (Not(hWnd)) Begin
74721>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
74722>>>>>
74722>>>>            Procedure_Return
74723>>>>        End
74723>>>>>
74723>>>>
74723>>>>        // Test if handle is valid. If not, we leave.
74723>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
74726>>>>
74726>>>>        Move (TimersArray(self)) to iSet
74727>>>>
74727>>>>        If (iSet) Begin
74729>>>>
74729>>>>            // Let's create or modify a timer
74729>>>>            If iState Begin
74731>>>>
74731>>>>                // Get the exising to new TimerID
74731>>>>                Get MSG_Add_Object of iSet iObj to iTimerID
74732>>>>
74732>>>>                // Set/Modify the timer
74732>>>>                Get Timeout of iObj to iTimeout
74733>>>>                Move (SetTimer(hWnd, iTimerID, iTimeout, 0)) to iResult
74734>>>>                If Not iResult Begin
74736>>>>                    Error DFERR_DFTIMER C_$TooManyTimers
74737>>>>>
74737>>>>                    Procedure_Return
74738>>>>                End
74738>>>>>
74738>>>>
74738>>>>            End
74738>>>>>
74738>>>>
74738>>>>            // Let's kill an existing timer
74738>>>>            Else Begin
74739>>>>
74739>>>>                // Look up the object in the set
74739>>>>                Get Find_Object of iSet iObj to iTimerID
74740>>>>
74740>>>>                If iTimerID EQ -1 ;                    Procedure_Return
74743>>>>
74743>>>>                // Kill the timer
74743>>>>                Move (KillTimer(hWnd, iTimerID)) to iResult
74744>>>>                If Not iResult Begin
74746>>>>                    Move (GetLastError()) to nResult
74747>>>>                    Error DFERR_DFTIMER (C_$CantKillTimer * string(nResult) - "!")
74748>>>>>
74748>>>>                    Procedure_Return
74749>>>>                End
74749>>>>>
74749>>>>
74749>>>>                // Remove the objectID
74749>>>>                Send Remove_Object to iSet iObj
74750>>>>            End
74750>>>>>
74750>>>>        End
74750>>>>>
74750>>>>    End_Procedure
74751>>>>
74751>>>>    Function Timer_Active_State Integer iObj Returns Integer
74753>>>>        Integer iResult
74753>>>>        Get Find_Object of (TimersArray(self)) iObj to iResult
74754>>>>        Function_Return (iResult<>-1) // note: -1= not found
74755>>>>    End_Function
74756>>>>
74756>>>>    // Will be called by the Set when it is being destroyed.
74756>>>>    Procedure Kill_All_Timers
74758>>>>        Integer iMax
74758>>>>        Integer iSet
74758>>>>        Integer iItem
74758>>>>        Integer iObj
74758>>>>        Integer iResult
74758>>>>        Handle  hWnd
74758>>>>
74758>>>>        // Get the handle of this object
74758>>>>        Get Window_Handle to hWnd
74759>>>>        If (Not(hWnd)) Begin
74761>>>>            Error DFERR_DFTIMER C_$TimerNoHandle
74762>>>>>
74762>>>>            Procedure_Return
74763>>>>        End
74763>>>>>
74763>>>>
74763>>>>        // If the window handle is no longer valid, we
74763>>>>        // leave this procedure. This can happen when the
74763>>>>        // program is begin aborted using Exit_Application
74763>>>>        If (Not(IsWindow(hWnd))) ;            Procedure_Return
74766>>>>
74766>>>>        // Scan the set and kill all known timers
74766>>>>        Move (TimersArray(self)) to iSet
74767>>>>        If (iSet) Begin
74769>>>>            Get Item_Count of iSet to iMax
74770>>>>            Decrement iMax
74771>>>>            For iItem From 1 to iMax
74777>>>>>
74777>>>>                Get Integer_Value of iSet item iItem to iObj
74778>>>>                If iObj Begin
74780>>>>                    Move (KillTimer(hWnd, iItem)) to iResult
74781>>>>                    Set Array_Value of iSet item iItem to 0
74782>>>>                End
74782>>>>>
74782>>>>            Loop
74783>>>>>
74783>>>>        End
74783>>>>>
74783>>>>
74783>>>>    End_Procedure
74784>>>>
74784>>>>    Procedure OnTimer Integer wParam Integer lParam
74786>>>>        Integer iObj
74786>>>>        Get Integer_Value of (TimersArray(self)) item wParam to iObj
74787>>>>        If Not iObj Begin
74789>>>>            Error DFERR_DFTIMER C_$TimerWithoutObject
74790>>>>>
74790>>>>            Procedure_Return
74791>>>>        End
74791>>>>>
74791>>>>        Send OnTimer to iObj wParam lParam
74792>>>>    End_Procedure
74793>>>>
74793>>>>    Procedure Destroy_Object
74795>>>>        Send Kill_All_Timers
74796>>>>        Forward Send Destroy_Object
74798>>>>        Move 0 to giTimerManager
74799>>>>    End_Procedure
74800>>>>
74800>>>>End_Class // DFTimerManger
74801>>>>
74801>>>>
74801>>>>
74801>>>>
74801>>>>// This class acts as a container for the
74801>>>>// timer manager object. This is needed because
74801>>>>// A DFTimerManager object created directly at the
74801>>>>// desktop doesn't have a Window_Handle which we
74801>>>>// need to create a Windoows timer. By placing
74801>>>>// this non-visual container around the timer
74801>>>>// manager, it does get a Window_Handle.
74801>>>>// The procedure End_Construct_Object has been
74801>>>>// augmented to create a window and also
74801>>>>// automatically page all children, which will
74801>>>>// be the timer manager.
74801>>>>//
74801>>>>Class DFTimerManagerPanel is a dfBasePanel
74802>>>>
74802>>>>    Procedure Construct_Object
74804>>>>        Forward Send Construct_Object
74806>>>>        Set Visible_State to FALSE
74807>>>>        Object DFTimerManager is a DFTimerManager
74809>>>>        End_Object
74810>>>>    End_Procedure
74811>>>>
74811>>>>    Procedure End_Construct_Object
74813>>>>        Forward Send End_Construct_Object
74815>>>>        Send Page_Object TRUE
74816>>>>        Broadcast Send Page_Object TRUE
74818>>>>    End_Procedure
74819>>>>
74819>>>>End_Class
74820>>>>
74820>>>>// This is the class the user uses to create DFTimer objects
74820>>>>
74820>>>>
74820>>>>//{ OverrideProperty=Skip_State DesignTime=False }
74820>>>>//{ OverrideProperty=TypeFace DesignTime=False }
74820>>>>Class DFTimer is a Textbox
74821>>>>
74821>>>>    Procedure Construct_Object
74823>>>>        Forward Send Construct_Object
74825>>>>
74825>>>>        // Make sure this object never appears
74825>>>>        Set Visible_State to FALSE
74826>>>>
74826>>>>        Property Integer Private.Timeout    1000
74827>>>>
74827>>>>        Property Integer Timer_Message      0
74828>>>>        Property Integer Timer_Object       0
74829>>>>        Property Integer Auto_Start_State   True
74830>>>>        Property Integer Auto_Stop_State    True
74831>>>>    End_Procedure
74832>>>>
74832>>>>    Procedure Set Timer_Active_State Integer iState
74834>>>>        Integer iObj
74834>>>>        Move self to iObj
74835>>>>        If giTimerManager ;            Set Timer_Active_State of giTimerManager iObj to iState
74838>>>>    End_Procedure
74839>>>>
74839>>>>    Function Timer_Active_State Returns Integer
74841>>>>        Integer iState
74841>>>>        Integer iObj
74841>>>>        Move self to iObj
74842>>>>        If giTimerManager ;            Get Timer_Active_State of giTimerManager iObj to iState
74845>>>>        Function_Return iState
74846>>>>    End_Function
74847>>>>
74847>>>>    Procedure Set Timeout Integer iTimeout
74849>>>>        Integer iActive
74849>>>>        Set Private.Timeout to iTimeout
74850>>>>        Get Timer_Active_State to iActive
74851>>>>        If iActive ;            Set Timer_Active_State to TRUE
74854>>>>    End_Procedure
74855>>>>
74855>>>>    Function Timeout Returns Integer
74857>>>>        Integer iTimeout
74857>>>>        Get Private.Timeout to iTimeout
74858>>>>        Function_Return iTimeout
74859>>>>    End_Function
74860>>>>
74860>>>>    Procedure OnTimer Integer iwParam Integer ilParam
74862>>>>        Integer iMsg
74862>>>>        Integer iObj
74862>>>>        Get Timer_Message to iMsg
74863>>>>        If (iMsg) Begin
74865>>>>            Get Timer_Object  to iObj
74866>>>>            If iObj ;                Send iMsg to iObj iwParam ilParam
74869>>>>            Else ;                Send iMsg iwParam ilParam
74871>>>>        End
74871>>>>>
74871>>>>    End_Procedure
74872>>>>
74872>>>>    // Augmented to Auto_Start a timer
74872>>>>    //
74872>>>>    Procedure Page_Object Integer iState
74874>>>>        Forward Send Page_Object iState
74876>>>>        If (iState AND Auto_Start_State(self)) ;            Set Timer_Active_State to TRUE
74879>>>>    End_Procedure
74880>>>>
74880>>>>    // Augmented to Auto_Stop a timer
74880>>>>    //
74880>>>>    Procedure Page_Delete
74882>>>>        If (Auto_Stop_State(self)) ;            Set Timer_Active_State to FALSE
74885>>>>        Forward Send Page_Delete
74887>>>>    End_Procedure
74888>>>>
74888>>>>    // Augmented to stop the timer
74888>>>>    //
74888>>>>    Procedure Destroy_Object
74890>>>>        Set Timer_Active_State to FALSE
74891>>>>        Forward Send Destroy_Object
74893>>>>    End_Procedure
74894>>>>
74894>>>>End_Class // DFTimer
74895>>>>
74895>>>>//
74895>>>>// This was moved into a method so it can be reliable created
74895>>>>// at the desktop. Note that cDesktop adds method to cDesktop class (class of desktop)
74895>>>>//
74895>>>>Procedure CreateDfTimerManagerPanel FOR cDesktop
74897>>>>    // Create the Desktop Timer Manager Object.
74897>>>>    Object DFTimerManagerPanel is a DFTimerManagerPanel
74899>>>>    End_Object
74900>>>>End_Procedure
74901>>>>
74901>>>>Send CreateDfTimerManagerPanel of DESKTOP
74902>>>>
74902>>Use Dfpanel.pkg
74902>>
74902>>// Tamanho de argumento padr’o
74902>>Define SYS_ARG_SIZE for 500000
74902>>Set_Argument_Size SYS_ARG_SIZE
74903>>>
74903>>
74903>>// VDF SIG Library
74903>>//Use SigCJLibraries.pkg
74903>>//Use cSigCJDockingPane_Container.pkg
74903>>//Use cSigCjShortcutBar.pkg
74903>>//Use cSigCJGlobalSettings.pkg
74903>>//Use SigCJMonthCalendar.sl
74903>>
74903>>// Standard
74903>>//Use cCJCommandBarSystem.pkg
74903>>Use cCJSkinFramework.pkg
Including file: cCJSkinFramework.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cCJSkinFramework.pkg)
74903>>>>Use windows.pkg
74903>>>>Use cCJComSkinFramework.pkg
Including file: cCJComSkinFramework.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cCJComSkinFramework.pkg)
74903>>>>>>// DataFlex COM proxy classes generated from C:\Program Files\Codejock Software\ActiveX\Xtreme SuitePro ActiveX v16.3.1\Bin\Codejock.SkinFramework.v16.3.1.ocx
74903>>>>>>Use FlexCom20.pkg
74903>>>>>>
74903>>>>>>// Changes to Imported package
74903>>>>>>//     OLEXTPxx to XTPxx
74903>>>>>>//     OLExtpxx to xtpxx
74903>>>>>>//     OLESkinFramework to SkinFramework
74903>>>>>>//     OLESTDxxx and OLEXPxxxx to STD/XP
74903>>>>>>//     cCom classes to cCJ
74903>>>>>>//     cCJAutomationObject back to cComAutomationObject
74903>>>>>>//     cCJActiveXControl back to cComActiveXControl
74903>>>>>>//     cCJSkinFramework to cCJComSkinFramework
74903>>>>>>//     Use statements as noted below (classes moved to these files)
74903>>>>>>//     Set classlibrary of all cComAutomation objects to Windows (for class doc)
74903>>>>>>
74903>>>>>>// These have been extracted from this class and moved into seperate packages
74903>>>>>>// because other Codejock classes use these.
74903>>>>>>Use cCJColorManager.pkg     // cCJColorManager
74903>>>>>>
74903>>>>>>Define SkinFrameworkApplyOptions for Integer
74903>>>>>>    Define xtpSkinApplyMetrics for 1
74903>>>>>>    Define xtpSkinApplyFrame for 2
74903>>>>>>    Define xtpSkinApplyColors for 4
74903>>>>>>    Define xtpSkinApplyMenus for 8
74903>>>>>>
74903>>>>>>// CLSID: {AFA0E6A1-28D7-4F2C-87A7-7266367B4655}
74903>>>>>>// Dispatch interface for SkinFramework Control
74903>>>>>>Class cCJ_DSkinFramework is a Mixin
74904>>>>>>
74904>>>>>>    Function ComApplyOptions Returns SkinFrameworkApplyOptions
74906>>>>>>        SkinFrameworkApplyOptions retVal
74906>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to retVal
74907>>>>>>        Function_Return retVal
74908>>>>>>    End_Function
74909>>>>>>
74909>>>>>>    Procedure Set ComApplyOptions SkinFrameworkApplyOptions value
74911>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_I4 to value
74912>>>>>>    End_Procedure
74913>>>>>>
74913>>>>>>    Function ComAutoApplyNewWindows Returns Boolean
74915>>>>>>        Boolean retVal
74915>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to retVal
74916>>>>>>        Function_Return retVal
74917>>>>>>    End_Function
74918>>>>>>
74918>>>>>>    Procedure Set ComAutoApplyNewWindows Boolean value
74920>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 5 OLE_VT_BOOL to value
74921>>>>>>    End_Procedure
74922>>>>>>
74922>>>>>>    Function ComAutoApplyNewThreads Returns Boolean
74924>>>>>>        Boolean retVal
74924>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to retVal
74925>>>>>>        Function_Return retVal
74926>>>>>>    End_Function
74927>>>>>>
74927>>>>>>    Procedure Set ComAutoApplyNewThreads Boolean value
74929>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 10 OLE_VT_BOOL to value
74930>>>>>>    End_Procedure
74931>>>>>>
74931>>>>>>    Function ComLoadSkin String llResourcePath String llIniFileName Returns Boolean
74933>>>>>>        Handle hDispatchDriver
74933>>>>>>        Boolean retVal
74933>>>>>>        Get phDispatchDriver to hDispatchDriver
74934>>>>>>        Send PrepareParams to hDispatchDriver 2
74935>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llResourcePath
74936>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llIniFileName
74937>>>>>>        Get InvokeComMethod of hDispatchDriver 2 OLE_VT_BOOL to retVal
74938>>>>>>        Function_Return retVal
74939>>>>>>    End_Function
74940>>>>>>
74940>>>>>>    Procedure ComApplyWindow OLE_HANDLE llhWnd
74942>>>>>>        Handle hDispatchDriver
74942>>>>>>        Get phDispatchDriver to hDispatchDriver
74943>>>>>>        Send PrepareParams to hDispatchDriver 1
74944>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
74945>>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
74946>>>>>>    End_Procedure
74947>>>>>>
74947>>>>>>    Procedure ComEnableThemeDialogTexture OLE_HANDLE llhWnd Integer llFlags
74949>>>>>>        Handle hDispatchDriver
74949>>>>>>        Get phDispatchDriver to hDispatchDriver
74950>>>>>>        Send PrepareParams to hDispatchDriver 2
74951>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
74952>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llFlags
74953>>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
74954>>>>>>    End_Procedure
74955>>>>>>
74955>>>>>>    Procedure ComRemoveWindow OLE_HANDLE llhWnd
74957>>>>>>        Handle hDispatchDriver
74957>>>>>>        Get phDispatchDriver to hDispatchDriver
74958>>>>>>        Send PrepareParams to hDispatchDriver 1
74959>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
74960>>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
74961>>>>>>    End_Procedure
74962>>>>>>
74962>>>>>>    Procedure ComRemoveAllWindows
74964>>>>>>        Handle hDispatchDriver
74964>>>>>>        Get phDispatchDriver to hDispatchDriver
74965>>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
74966>>>>>>    End_Procedure
74967>>>>>>
74967>>>>>>    Procedure ComAddWindowClass String llClassName String llBaseClassName
74969>>>>>>        Handle hDispatchDriver
74969>>>>>>        Get phDispatchDriver to hDispatchDriver
74970>>>>>>        Send PrepareParams to hDispatchDriver 2
74971>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
74972>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llBaseClassName
74973>>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
74974>>>>>>    End_Procedure
74975>>>>>>
74975>>>>>>    Procedure ComRemoveWindowClass String llClassName
74977>>>>>>        Handle hDispatchDriver
74977>>>>>>        Get phDispatchDriver to hDispatchDriver
74978>>>>>>        Send PrepareParams to hDispatchDriver 1
74979>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llClassName
74980>>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
74981>>>>>>    End_Procedure
74982>>>>>>
74982>>>>>>    Function ComEnumerateSkinDirectory String llPath Boolean llRecursive Returns Variant
74984>>>>>>        Handle hDispatchDriver
74984>>>>>>        Variant retVal
74984>>>>>>        Get phDispatchDriver to hDispatchDriver
74985>>>>>>        Send PrepareParams to hDispatchDriver 2
74986>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
74987>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llRecursive
74988>>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_DISPATCH to retVal
74989>>>>>>        Function_Return retVal
74990>>>>>>    End_Function
74991>>>>>>
74991>>>>>>    Function ComEnumerateSkinFile String llPath Returns Variant
74993>>>>>>        Handle hDispatchDriver
74993>>>>>>        Variant retVal
74993>>>>>>        Get phDispatchDriver to hDispatchDriver
74994>>>>>>        Send PrepareParams to hDispatchDriver 1
74995>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llPath
74996>>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_DISPATCH to retVal
74997>>>>>>        Function_Return retVal
74998>>>>>>    End_Function
74999>>>>>>
74999>>>>>>    Function ComGetColor XTPColorManagerColor llIndex Returns OLE_COLOR
75001>>>>>>        Handle hDispatchDriver
75001>>>>>>        OLE_COLOR retVal
75001>>>>>>        Get phDispatchDriver to hDispatchDriver
75002>>>>>>        Send PrepareParams to hDispatchDriver 1
75003>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
75004>>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_I4 to retVal
75005>>>>>>        Function_Return retVal
75006>>>>>>    End_Function
75007>>>>>>
75007>>>>>>    Procedure ComExcludeModule String llModuleName
75009>>>>>>        Handle hDispatchDriver
75009>>>>>>        Get phDispatchDriver to hDispatchDriver
75010>>>>>>        Send PrepareParams to hDispatchDriver 1
75011>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llModuleName
75012>>>>>>        Send InvokeComMethod to hDispatchDriver 15 OLE_VT_VOID
75013>>>>>>    End_Procedure
75014>>>>>>
75014>>>>>>    Function ComCreateSchema String llResourcePath String llIniFileName Returns Variant
75016>>>>>>        Handle hDispatchDriver
75016>>>>>>        Variant retVal
75016>>>>>>        Get phDispatchDriver to hDispatchDriver
75017>>>>>>        Send PrepareParams to hDispatchDriver 2
75018>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llResourcePath
75019>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llIniFileName
75020>>>>>>        Get InvokeComMethod of hDispatchDriver 16 OLE_VT_DISPATCH to retVal
75021>>>>>>        Function_Return retVal
75022>>>>>>    End_Function
75023>>>>>>
75023>>>>>>    Procedure ComSetWindowTheme OLE_HANDLE llhWnd Variant llSchema
75025>>>>>>        Handle hDispatchDriver
75025>>>>>>        Get phDispatchDriver to hDispatchDriver
75026>>>>>>        Send PrepareParams to hDispatchDriver 2
75027>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llhWnd
75028>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_DISPATCH llSchema
75029>>>>>>        Send InvokeComMethod to hDispatchDriver 17 OLE_VT_VOID
75030>>>>>>    End_Procedure
75031>>>>>>
75031>>>>>>    Procedure ComAboutBox
75033>>>>>>        Handle hDispatchDriver
75033>>>>>>        Get phDispatchDriver to hDispatchDriver
75034>>>>>>        Send InvokeComMethod to hDispatchDriver -552 OLE_VT_VOID
75035>>>>>>    End_Procedure
75036>>>>>>End_Class
75037>>>>>>
75037>>>>>>// CLSID: {40217CB8-4463-4030-B324-AC6A8075FEC8}
75037>>>>>>// Event interface for SkinFramework Control
75037>>>>>>Class cCJ_DSkinFrameworkEvents is a Mixin
75038>>>>>>
75038>>>>>>    Procedure RegisterComEvents
75040>>>>>>    End_Procedure
75041>>>>>>End_Class
75042>>>>>>
75042>>>>>>// CoClass
75042>>>>>>// ProgID: Codejock.SkinFramework.16.3.1
75042>>>>>>// CLSID: {99467B6D-0B79-42CF-8E5A-72A16F213699}
75042>>>>>>// SkinFramework Control
75042>>>>>>Class cCJComSkinFramework is a cComActiveXControl
75043>>>>>>    Import_Class_Protocol cCJ_DSkinFramework
75044>>>>>>    Import_Class_Protocol cCJ_DSkinFrameworkEvents
75045>>>>>>
75045>>>>>>    Procedure Construct_Object
75047>>>>>>        Forward Send Construct_Object
75049>>>>>>        Set psProgID to "{99467B6D-0B79-42CF-8E5A-72A16F213699}"
75050>>>>>>        Set psEventId to "{40217CB8-4463-4030-B324-AC6A8075FEC8}"
75051>>>>>>        Set psLicenseKey to ("Skin Framework Control Copyright (c) 2003-2013 Codejock Software"+ Character(13)+ Character(10)+;                             "PRODUCT-ID: Codejock.SkinFramework.ActiveX.v16.3"+ Character(13)+ Character(10)+;                             "VALIDATE-CODE: GGE-OLD-QQR-EJS")
75052>>>>>>        Set peAutoCreate to acAutoCreate
75053>>>>>>    End_Procedure
75054>>>>>>End_Class
75055>>>>>>
75055>>>>>>// CLSID: {F8E7ABC2-EFCB-4312-91F8-237F3FE07407}
75055>>>>>>// SkinFramework Global Settings
75055>>>>>>Class cCJISkinFrameworkGlobalSettings is a Mixin
75056>>>>>>
75056>>>>>>    Function ComLicense Returns String
75058>>>>>>        String retVal
75058>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BSTR to retVal
75059>>>>>>        Function_Return retVal
75060>>>>>>    End_Function
75061>>>>>>
75061>>>>>>    Procedure Set ComLicense String value
75063>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 101 OLE_VT_BSTR to value
75064>>>>>>    End_Procedure
75065>>>>>>
75065>>>>>>    Function ComTitle Returns String
75067>>>>>>        String retVal
75067>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 102 OLE_VT_BSTR to retVal
75068>>>>>>        Function_Return retVal
75069>>>>>>    End_Function
75070>>>>>>
75070>>>>>>    Procedure Set ComTitle String value
75072>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 102 OLE_VT_BSTR to value
75073>>>>>>    End_Procedure
75074>>>>>>
75074>>>>>>    Function ComVersion Returns String
75076>>>>>>        Handle hDispatchDriver
75076>>>>>>        String retVal
75076>>>>>>        Get phDispatchDriver to hDispatchDriver
75077>>>>>>        Get InvokeComMethod of hDispatchDriver 104 OLE_VT_BSTR to retVal
75078>>>>>>        Function_Return retVal
75079>>>>>>    End_Function
75080>>>>>>
75080>>>>>>    Function ComUnicode Returns Boolean
75082>>>>>>        Handle hDispatchDriver
75082>>>>>>        Boolean retVal
75082>>>>>>        Get phDispatchDriver to hDispatchDriver
75083>>>>>>        Get InvokeComMethod of hDispatchDriver 105 OLE_VT_BOOL to retVal
75084>>>>>>        Function_Return retVal
75085>>>>>>    End_Function
75086>>>>>>
75086>>>>>>    Function ComOcxPath Returns String
75088>>>>>>        Handle hDispatchDriver
75088>>>>>>        String retVal
75088>>>>>>        Get phDispatchDriver to hDispatchDriver
75089>>>>>>        Get InvokeComMethod of hDispatchDriver 106 OLE_VT_BSTR to retVal
75090>>>>>>        Function_Return retVal
75091>>>>>>    End_Function
75092>>>>>>End_Class
75093>>>>>>
75093>>>>>>// CoClass
75093>>>>>>// ProgID: Codejock.SkinFrameworkGlobalSettings.16.3.1
75093>>>>>>// CLSID: {74186E88-5551-4C00-8600-B617D22CF621}
75093>>>>>>// SkinFramework Global Settings
75093>>>>>>Class cCJComSkinFrameworkGlobalSettings is a cComAutomationObject
75094>>>>>>    Import_Class_Protocol cCJISkinFrameworkGlobalSettings
75095>>>>>>
75095>>>>>>    Procedure Construct_Object
75097>>>>>>        Forward Send Construct_Object
75099>>>>>>        Set psProgID to "{74186E88-5551-4C00-8600-B617D22CF621}"
75100>>>>>>        Set peAutoCreate to acNoAutoCreate
75101>>>>>>    End_Procedure
75102>>>>>>End_Class
75103>>>>>>
75103>>>>>>// CLSID: {FA81EAF9-70A3-49DA-8DC1-1EA0CD13DEC0}
75103>>>>>>Class cCJSkinIniFile is a cComAutomationObject
75104>>>>>>
75104>>>>>>    Function ComColorScheme Returns String
75106>>>>>>        String retVal
75106>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
75107>>>>>>        Function_Return retVal
75108>>>>>>    End_Function
75109>>>>>>
75109>>>>>>    Procedure Set ComColorScheme String value
75111>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
75112>>>>>>    End_Procedure
75113>>>>>>
75113>>>>>>    Function ComFontSize Returns String
75115>>>>>>        String retVal
75115>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
75116>>>>>>        Function_Return retVal
75117>>>>>>    End_Function
75118>>>>>>
75118>>>>>>    Procedure Set ComFontSize String value
75120>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
75121>>>>>>    End_Procedure
75122>>>>>>
75122>>>>>>    Function ComIniFileName Returns String
75124>>>>>>        String retVal
75124>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to retVal
75125>>>>>>        Function_Return retVal
75126>>>>>>    End_Function
75127>>>>>>
75127>>>>>>    Procedure Set ComIniFileName String value
75129>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 3 OLE_VT_BSTR to value
75130>>>>>>    End_Procedure
75131>>>>>>End_Class
75132>>>>>>
75132>>>>>>// CLSID: {C20D5120-CC53-491E-91BC-96A65FA21EED}
75132>>>>>>Class cCJSkinDescription is a cComAutomationObject
75133>>>>>>
75133>>>>>>    Function ComName Returns String
75135>>>>>>        String retVal
75135>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to retVal
75136>>>>>>        Function_Return retVal
75137>>>>>>    End_Function
75138>>>>>>
75138>>>>>>    Procedure Set ComName String value
75140>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 1 OLE_VT_BSTR to value
75141>>>>>>    End_Procedure
75142>>>>>>
75142>>>>>>    Function ComPath Returns String
75144>>>>>>        String retVal
75144>>>>>>        Get ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to retVal
75145>>>>>>        Function_Return retVal
75146>>>>>>    End_Function
75147>>>>>>
75147>>>>>>    Procedure Set ComPath String value
75149>>>>>>        Set ComProperty of (phDispatchDriver(Self)) 2 OLE_VT_BSTR to value
75150>>>>>>    End_Procedure
75151>>>>>>
75151>>>>>>    Function ComCount Returns Integer
75153>>>>>>        Handle hDispatchDriver
75153>>>>>>        Integer retVal
75153>>>>>>        Get phDispatchDriver to hDispatchDriver
75154>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
75155>>>>>>        Function_Return retVal
75156>>>>>>    End_Function
75157>>>>>>
75157>>>>>>    Function ComIniFile Integer llIndex Returns Variant
75159>>>>>>        Handle hDispatchDriver
75159>>>>>>        Variant retVal
75159>>>>>>        Get phDispatchDriver to hDispatchDriver
75160>>>>>>        Send PrepareParams to hDispatchDriver 1
75161>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
75162>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
75163>>>>>>        Function_Return retVal
75164>>>>>>    End_Function
75165>>>>>>
75165>>>>>>    Function Com_NewEnum Returns Variant
75167>>>>>>        Handle hDispatchDriver
75167>>>>>>        Variant retVal
75167>>>>>>        Get phDispatchDriver to hDispatchDriver
75168>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
75169>>>>>>        Function_Return retVal
75170>>>>>>    End_Function
75171>>>>>>End_Class
75172>>>>>>
75172>>>>>>// CLSID: {40AC7EEB-44CD-47D9-ADEC-6822A8C731F1}
75172>>>>>>Class cCJSkinDescriptions is a cComAutomationObject
75173>>>>>>
75173>>>>>>    Function ComCount Returns Integer
75175>>>>>>        Handle hDispatchDriver
75175>>>>>>        Integer retVal
75175>>>>>>        Get phDispatchDriver to hDispatchDriver
75176>>>>>>        Get InvokeComMethod of hDispatchDriver 3 OLE_VT_I4 to retVal
75177>>>>>>        Function_Return retVal
75178>>>>>>    End_Function
75179>>>>>>
75179>>>>>>    Function ComSkin Integer llIndex Returns Variant
75181>>>>>>        Handle hDispatchDriver
75181>>>>>>        Variant retVal
75181>>>>>>        Get phDispatchDriver to hDispatchDriver
75182>>>>>>        Send PrepareParams to hDispatchDriver 1
75183>>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llIndex
75184>>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
75185>>>>>>        Function_Return retVal
75186>>>>>>    End_Function
75187>>>>>>
75187>>>>>>    Function Com_NewEnum Returns Variant
75189>>>>>>        Handle hDispatchDriver
75189>>>>>>        Variant retVal
75189>>>>>>        Get phDispatchDriver to hDispatchDriver
75190>>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
75191>>>>>>        Function_Return retVal
75192>>>>>>    End_Function
75193>>>>>>End_Class
75194>>>>>>
75194>>>>>>// CLSID: {128507E0-C56F-43C0-BCF1-8193B35FE4C4}
75194>>>>>>Class cCJSkinSchema is a cComAutomationObject
75195>>>>>>End_Class
75196>>>>Use cApplication.pkg
75196>>>>
75196>>>>Struct tSkinInformation
75196>>>>    String sName     // description of the skin
75196>>>>    String sSkinfile // file path. Can be relative or full
75196>>>>    String sSkinIni  // section name
75196>>>>End_Struct
75196>>>>
75196>>>>
75196>>>>Class cCJSkinFramework is a cCJComSkinFramework
75197>>>>    
75197>>>>    Procedure Construct_Object
75199>>>>        Forward Send Construct_Object
75201>>>>        
75201>>>>        Property String psSkinFile ""
75202>>>>        Property String psSkinIni ""
75203>>>>        Property Boolean pbLoadPreference False
75204>>>>        
75204>>>>        Set peAutoCreate to acAutoCreate
75205>>>>        
75205>>>>        Move Self to ghoSkinFramework
75206>>>>    End_Procedure
75207>>>>    
75207>>>>    // return the default skin path, which is the programs directory.
75207>>>>    // This requires an application object.
75207>>>>    // If you want to different skin path, override this.
75207>>>>    Function SkinPath Returns String
75209>>>>        String sPath sPaths
75209>>>>        Handle hoWorkspace
75209>>>>        If ghoApplication Begin
75211>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
75212>>>>            Get psProgramPath of hoWorkspace to sPaths
75213>>>>            Get PathAtIndex of hoWorkspace sPaths 1 to sPath
75214>>>>        End
75214>>>>>
75214>>>>        Else Begin
75215>>>>            Error DFERR_PROGRAM C_$ApplicationObjectNotCreated
75216>>>>>
75216>>>>        End
75216>>>>>
75216>>>>        Function_Return sPath
75217>>>>    End_Function
75218>>>>    
75218>>>>    // Returns the Qualified name of psSkinFile. If the file is already qualified it just
75218>>>>    // returns itself. If it is not, it uses SkinPath to get the path.
75218>>>>    Function SkinQFile Returns String
75220>>>>        String sFile sPath sSep
75220>>>>        Boolean bQualified
75220>>>>        Get psSkinFile to sFile
75221>>>>        If not (IsFileNameQualified(sFile)) Begin
75223>>>>            Get SkinPath to sPath
75224>>>>            Move (SysConf(SYSCONF_DIR_SEPARATOR)) to sSep
75225>>>>            Move (sPath - sSep - sFile) to sFile
75226>>>>        End
75226>>>>>
75226>>>>        Function_Return sFile
75227>>>>    End_Function
75228>>>>        
75228>>>>    // defines the default VDF window class mapping.    
75228>>>>    Procedure OnAddVDFWindowClasses
75230>>>>        Send ComAddWindowClass "DFlistbox"               "ListBox"
75231>>>>        Send ComAddWindowClass "DFentry"                 "Edit"
75232>>>>        Send ComAddWindowClass "DFtextbox"               "Edit"
75233>>>>        Send ComAddWindowClass "DFRichEditCtrl"          "Edit"
75234>>>>        Send ComAddWindowClass "DFcombobox"              "ComboBox"
75235>>>>        Send ComAddWindowClass "DFformlist"              "Edit"
75236>>>>        Send ComAddWindowClass "DFFormListHeader"        "SysHeader32"
75237>>>>        Send ComAddWindowClass "DFbutton"                "Button"
75238>>>>        Send ComAddWindowClass "HPromptBtn"              "Button"
75239>>>>        Send ComAddWindowClass "Hspinbtn"                "msctls_updown32"
75240>>>>        Send ComAddWindowClass "DFSysTabControl32"       "SysTabControl32"
75241>>>>        Send ComAddWindowClass "DFMDIClient"             "MDIClient" 
75242>>>>        Send ComAddWindowClass "DFedit"                  "edit"
75243>>>>        Send ComAddWindowClass "DFlistedit"              "edit"
75244>>>>        Send ComAddWindowClass "DFscrollbar"             "scrollbar"
75245>>>>        Send ComAddWindowClass "DFgroup"                 "Button"
75246>>>>        Send ComAddWindowClass "DFComboGrid"             "ComboBox"
75247>>>>        // External class
75247>>>>        Send ComAddWindowClass "cVdfAnimation"           "SysAnimate32"
75248>>>>        Send ComAddWindowClass "cVdfProgressBar"         "msctls_progress32"
75249>>>>        Send ComAddWindowClass "cVdfStatusBar"           "msctls_statusbar32"
75250>>>>        Send ComAddWindowClass "cVdfToolbar"             "ToolbarWindow32"
75251>>>>        Send ComAddWindowClass "cObsoleteVdfProgressBar" "msctls_progress32"
75252>>>>        Send ComAddWindowClass "cVdfTrackBar"            "msctls_trackbar32"
75253>>>>        Send ComAddWindowClass "cObsoleteBasicStatusBar" "msctls_statusbar32"
75254>>>>        Send ComAddWindowClass "cVdfTreeView"            "SysTreeView32"
75255>>>>    End_Procedure
75256>>>>    
75256>>>>    // Used to support developer designed class mappings (e.g. COM controls)
75256>>>>    Procedure OnAddCustomWindowClasses
75258>>>>    End_Procedure
75259>>>>
75259>>>>    // called when object is created during end_construct_object.
75259>>>>    Procedure OnCreate
75261>>>>        Integer iOpts
75261>>>>        Boolean bUseWindowsFont
75261>>>>        Forward Send OnCreate
75263>>>>        
75263>>>>        // if we are using the windows fonts we will disable the apply metrics which
75263>>>>        // never really looked good anyway. This test only exists or legacy purposes
75263>>>>        Get pbUseWindowsFont of Desktop to bUseWindowsFont
75264>>>>        If bUseWindowsFont Begin
75266>>>>            Get ComApplyOptions to iOpts
75267>>>>            Set ComApplyOptions to (RemoveBitValue(xtpSkinApplyMetrics, iOpts))
75268>>>>        End
75268>>>>>
75268>>>>
75268>>>>        // this works around a CJ issue where skins applied to other threads causes an exception upon close down. 
75268>>>>        // We saw this with our mssql driver but it could occur elsewhere. This has been reported in the CJ newsgroup
75268>>>>        // and this was the suggested workaround.
75268>>>>        Set ComAutoApplyNewThreads to False
75269>>>>
75269>>>>        Send OnAddVDFWindowClasses
75270>>>>        Send OnAddCustomWindowClasses
75271>>>>        
75271>>>>        // if preferences are used, it will set psSkinFile and psSkinIni
75271>>>>        If (pbLoadPreference(Self)) Begin
75273>>>>            Send LoadSkinPreference
75274>>>>        End
75274>>>>>
75274>>>>        // if a skin file name exists, we apply the skin.    
75274>>>>        If (psSkinFile(Self)<>"") Begin
75276>>>>            Send ApplySkin
75277>>>>        End        
75277>>>>>
75277>>>>    End_Procedure
75278>>>>    
75278>>>>    // called by framework as part of application exit.
75278>>>>    Procedure Broadcast_Notify_Exit_Application
75280>>>>        Send Notify_Exit_Application
75281>>>>    End_Procedure // Notify_Exit_Application
75282>>>>
75282>>>>    Procedure Notify_Exit_Application
75284>>>>        If (pbLoadPreference(Self)) Begin
75286>>>>            Send SaveSkinPreference
75287>>>>        End
75287>>>>>
75287>>>>    End_Procedure
75288>>>>
75288>>>>    Procedure NotifyPreApplySkin
75290>>>>        Broadcast Send OnPreApplySkin of Desktop True       
75292>>>>    End_Procedure
75293>>>>
75293>>>>    Procedure NotifyPostApplySkin
75295>>>>        Broadcast Send OnPostApplySkin of Desktop True       
75297>>>>    End_Procedure
75298>>>>    
75298>>>>    // returns an array of all skins in the path. If path is "", use the default path.
75298>>>>    // If the default path is used, returns the file names as relative names, else use full path.
75298>>>>    Function EnumerateSkins String sPath Boolean bRecursive Returns tSkinInformation[]
75300>>>>        tSkinInformation[] Skins
75300>>>>        tSkinInformation[] Skins
75301>>>>        String sSkinName sSkinFile sDefaultPath sSep
75301>>>>        Variant vSkinDescriptions vSkinDescription vSkinIniFile
75301>>>>        Handle hSkinDescriptions hSkinDescription hSkinIniFile
75301>>>>        Integer iSkinsCount iSkinFilesCount iNumSkins iNumSkinFiles iArrayItem
75301>>>>        Integer iPos iDfltLen
75301>>>>        Boolean bUseRelativePath
75301>>>>        
75301>>>>        Move (SysConf(SYSCONF_DIR_SEPARATOR)) to sSep
75302>>>>        
75302>>>>        Get SkinPath to sDefaultPath
75303>>>>        If (sPath="") Begin
75305>>>>            Move sDefaultPath to sPath
75306>>>>        End
75306>>>>>
75306>>>>        Move (Uppercase(sDefaultPath)) to sDefaultPath
75307>>>>        Move (Length(sDefaultPath)) to iDfltLen
75308>>>>        Move (sDefaultPath=Uppercase(sPath)) to bUseRelativePath
75309>>>>
75309>>>>        Get ComEnumerateSkinDirectory sPath bRecursive to vSkinDescriptions
75310>>>>        If (not(IsNullComObject(vSkinDescriptions))) Begin
75312>>>>
75312>>>>            Get Create U_cCJSkinDescriptions to hSkinDescriptions
75313>>>>            Get Create U_cCJSkinDescription to hSkinDescription
75314>>>>            Get Create U_cCJSkinIniFile to hSkinIniFile
75315>>>>            
75315>>>>            Set pvComObject of hSkinDescriptions to vSkinDescriptions
75316>>>>            Get ComCount of hSkinDescriptions to iNumSkinFiles
75317>>>>            
75317>>>>            For iSkinFilesCount from 0 to (iNumSkinFiles-1)
75323>>>>>
75323>>>>                Get ComSkin of hSkinDescriptions iSkinFilesCount to vSkinDescription
75324>>>>                Set pvComObject of hSkinDescription to vSkinDescription
75325>>>>
75325>>>>                Get ComCount of hSkinDescription to iNumSkins
75326>>>>                    
75326>>>>                For iSkinsCount from 0 to (iNumSkins-1)
75332>>>>>
75332>>>>                    Get ComIniFile of hSkinDescription iSkinsCount to vSkinIniFile
75333>>>>                    Set pvComObject of hSkinIniFile to vSkinIniFile
75334>>>>
75334>>>>                    Get ComName of hSkinDescription to Skins[iArrayItem].sName
75335>>>>                    Get ComPath of hSkinDescription to sSkinFile
75336>>>>                    If bUseRelativePath Begin
75338>>>>                        Move (pos(sDefaultPath,uppercase(sSkinFile))) to iPos
75339>>>>                        If iPos Begin
75341>>>>                            Move (Remove(sSkinFile,iPos,iDfltLen)) to sSkinFile   
75342>>>>                            While (Left(sSkinFile,1)=sSep)
75346>>>>                                Move (Remove(sSkinFile,1,1)) to sSkinFile   
75347>>>>                            Loop                         
75348>>>>>
75348>>>>                        End
75348>>>>>
75348>>>>                    End
75348>>>>>
75348>>>>                    Move sSkinFile to Skins[iArrayItem].sSkinfile
75349>>>>                    Get ComIniFileName of hSkinIniFile to Skins[iArrayItem].sSkinIni
75350>>>>
75350>>>>                    Increment iArrayItem
75351>>>>                Loop
75352>>>>>
75352>>>>            Loop
75353>>>>>
75353>>>>                            
75353>>>>            Send Destroy of hSkinDescriptions
75354>>>>            Send Destroy of hSkinDescription
75355>>>>            Send Destroy of hSkinIniFile
75356>>>>                
75356>>>>        End
75356>>>>>
75356>>>>        Function_Return Skins
75357>>>>    End_Function 
75358>>>>    
75358>>>>    // Save the skin preference. This requires an application object.
75358>>>>    // Only do this if the application object allows it. 
75358>>>>    // This is called during startup if pbLoadPreference is True
75358>>>>    // Suitable for override
75358>>>>    Procedure SaveSkinPreference 
75360>>>>        String sSkin sIni
75360>>>>        If ghoApplication Begin
75362>>>>            If (pbPreserveEnvironment(ghoApplication)) Begin
75364>>>>                Get psSkinFile to sSkin
75365>>>>                Get psSkinIni to sIni
75366>>>>                Send WriteString of ghoApplication "Preferences" "SkinFile" sSkin
75367>>>>                Send WriteString of ghoApplication "Preferences" "SkinIni" sIni
75368>>>>            End
75368>>>>>
75368>>>>        End
75368>>>>>
75368>>>>        Else Begin
75369>>>>            Error DFERR_PROGRAM C_$ApplicationObjectNotCreated
75370>>>>>
75370>>>>        End
75370>>>>>
75370>>>>    End_Procedure
75371>>>>
75371>>>>    // Load the skin preference. This requires an application object.
75371>>>>    // Only do this if the application object allows it. 
75371>>>>    // This is called during startup if pbLoadPreference is True
75371>>>>    // Suitable for override
75371>>>>    Procedure LoadSkinPreference 
75373>>>>        String sSkin sIni
75373>>>>        Boolean bExists
75373>>>>        If ghoApplication Begin
75375>>>>            If (pbPreserveEnvironment(ghoApplication)) Begin
75377>>>>                Get ValueExists of ghoApplication "Preferences" "SkinFile" to bExists
75378>>>>                If bExists Begin
75380>>>>                    Get ReadString of ghoApplication "Preferences" "SkinFile" "" to sSkin
75381>>>>                    Get ReadString of ghoApplication "Preferences" "SkinIni" "" to sIni
75382>>>>                    Set psSkinFile to sSkin
75383>>>>                    Set psSkinIni to sIni
75384>>>>                End
75384>>>>>
75384>>>>            End
75384>>>>>
75384>>>>        End
75384>>>>>
75384>>>>        Else Begin
75385>>>>            Error DFERR_PROGRAM C_$ApplicationObjectNotCreated
75386>>>>>
75386>>>>        End
75386>>>>>
75386>>>>    End_Procedure
75387>>>>
75387>>>>    // Can be called to apply the current skin.
75387>>>>    Procedure ApplySkin
75389>>>>        Boolean bOk
75389>>>>        String sSkin sIni
75389>>>>        If (IsComObjectCreated(Self)) Begin
75391>>>>            Get SkinQFile to sSkin
75392>>>>            Get psSkinIni to sIni
75393>>>>            
75393>>>>            Send NotifyPreApplySkin
75394>>>>            // when skins are used we don't want to use built in Visual Styles
75394>>>>            Send EnableVisualStyles of Desktop (sSkin="")
75395>>>>            Get ComLoadSkin sSkin sIni to bOK
75396>>>>            If (sSkin<>"" and not(bOk)) Begin
75398>>>>                // if not ok, no skin was appied. Enable visual styles
75398>>>>                Send EnableVisualStyles of Desktop True
75399>>>>            End
75399>>>>>
75399>>>>            Send NotifyPostApplySkin
75400>>>>        End
75400>>>>>
75400>>>>    End_Procedure
75401>>>>
75401>>>>
75401>>>>End_Class
75402>>Use oEditContextMenu.pkg
Including file: oEditContextMenu.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\oEditContextMenu.pkg)
75402>>>>Use cCJStandardMenuItemClasses.pkg
Including file: cCJStandardMenuItemClasses.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cCJStandardMenuItemClasses.pkg)
75402>>>>>>Use Dfpanel.pkg
75402>>>>>>Use cCJCommandBarSystem.pkg
75402>>>>>>Use LanguageText.pkg
75402>>>>>>
75402>>>>>>
75402>>>>>>Class cCJUndoMenuItem is a cCJMenuItem
75403>>>>>>    
75403>>>>>>    Procedure Construct_Object
75405>>>>>>        Forward Send Construct_Object
75407>>>>>>        Set psCaption   to C_$CaptionUndo
75408>>>>>>        Set psToolTip to C_$ToolTipUndo
75409>>>>>>        Set psDescription to C_$DescUndo
75410>>>>>>        Set psImage to "ActionUndo.ico"
75411>>>>>>        Set pbActiveUpdate to True
75412>>>>>>        Set psCategory to C_$CategoryEdit
75413>>>>>>        Set psShortcut to C_$Key_Ctrl_Z
75414>>>>>>    End_Procedure
75415>>>>>>
75415>>>>>>    Procedure OnExecute Variant vCommandBarControl
75417>>>>>>        Send Undo of (focus(Self))
75418>>>>>>    End_Procedure
75419>>>>>>    
75419>>>>>>    Function IsEnabled Returns Boolean
75421>>>>>>        Boolean bEnabled
75421>>>>>>        Get CanUndo of (Focus(Self)) to bEnabled
75422>>>>>>        Function_Return bEnabled
75423>>>>>>    End_Function
75424>>>>>>         
75424>>>>>>End_Class
75425>>>>>>
75425>>>>>>
75425>>>>>>Class cCJDeleteEditMenuItem is a cCJMenuItem
75426>>>>>>    
75426>>>>>>    Procedure Construct_Object
75428>>>>>>        Forward Send Construct_Object
75430>>>>>>        Set psCaption   to C_$CaptionDelete
75431>>>>>>        Set psToolTip to C_$ToolTipDelete
75432>>>>>>        Set psDescription to C_$DescDelete
75433>>>>>>        Set psImage to "actionDelete.ico"
75434>>>>>>        Set psShortcut to C_$Key_Delete
75435>>>>>>        Set pbActiveUpdate to True
75436>>>>>>        Set psCategory to C_$CategoryEdit
75437>>>>>>    End_Procedure
75438>>>>>>
75438>>>>>>
75438>>>>>>    Procedure OnExecute Variant vCommandBarControl
75440>>>>>>        Send Delete of (focus(Self))
75441>>>>>>    End_Procedure
75442>>>>>>    
75442>>>>>>    Function IsEnabled Returns Boolean
75444>>>>>>        Boolean bEnabled
75444>>>>>>        Get CanDelete of (Focus(Self)) to bEnabled
75445>>>>>>        Function_Return bEnabled
75446>>>>>>    End_Function
75447>>>>>>         
75447>>>>>>End_Class
75448>>>>>>
75448>>>>>>
75448>>>>>>Class cCJCutMenuItem is a cCJMenuItem
75449>>>>>>    
75449>>>>>>    Procedure Construct_Object
75451>>>>>>        Forward Send Construct_Object
75453>>>>>>        Set psCaption   to C_$CaptionCut
75454>>>>>>        Set psToolTip to C_$TooltipCut
75455>>>>>>        Set psDescription to C_$DescCut
75456>>>>>>        Set psImage to "actionCut.ico"
75457>>>>>>        Set psShortcut to C_$Key_Ctrl_X
75458>>>>>>        Set pbActiveUpdate to True
75459>>>>>>        Set psCategory to C_$CategoryEdit
75460>>>>>>    End_Procedure
75461>>>>>>
75461>>>>>>
75461>>>>>>    Procedure OnExecute Variant vCommandBarControl
75463>>>>>>        Send Cut of (focus(Self))
75464>>>>>>    End_Procedure
75465>>>>>>    
75465>>>>>>    Function IsEnabled Returns Boolean
75467>>>>>>        Boolean bEnabled
75467>>>>>>        Get CanCut of (Focus(Self)) to bEnabled
75468>>>>>>        Function_Return bEnabled
75469>>>>>>    End_Function
75470>>>>>>         
75470>>>>>>End_Class
75471>>>>>>
75471>>>>>>
75471>>>>>>Class cCJCopyMenuItem is a cCJMenuItem
75472>>>>>>    
75472>>>>>>    Procedure Construct_Object
75474>>>>>>        Forward Send Construct_Object
75476>>>>>>        Set psCaption   to C_$CaptionCopy
75477>>>>>>        Set psToolTip to C_$ToolTipCopy
75478>>>>>>        Set psDescription to C_$DescCopy
75479>>>>>>        Set psImage to "actionCopy.ico"
75480>>>>>>        Set psShortcut to C_$Key_Ctrl_C
75481>>>>>>        Set pbActiveUpdate to True
75482>>>>>>        Set psCategory to C_$CategoryEdit
75483>>>>>>    End_Procedure
75484>>>>>>
75484>>>>>>
75484>>>>>>    Procedure OnExecute Variant vCommandBarControl
75486>>>>>>        Send Copy of (focus(Self))
75487>>>>>>    End_Procedure
75488>>>>>>    
75488>>>>>>    Function IsEnabled Returns Boolean
75490>>>>>>        Boolean bEnabled
75490>>>>>>        Get CanCopy of (Focus(Self)) to bEnabled
75491>>>>>>        Function_Return bEnabled
75492>>>>>>    End_Function
75493>>>>>>         
75493>>>>>>End_Class
75494>>>>>>
75494>>>>>>
75494>>>>>>Class cCJPasteMenuItem is a cCJMenuItem
75495>>>>>>    
75495>>>>>>    Procedure Construct_Object
75497>>>>>>        Forward Send Construct_Object
75499>>>>>>        Set psCaption   to C_$CaptionPaste
75500>>>>>>        Set psToolTip to C_$ToolTipPaste
75501>>>>>>        Set psDescription to C_$DescPaste
75502>>>>>>        Set psImage to "actionPaste.ico"
75503>>>>>>        Set pbActiveUpdate to True
75504>>>>>>        Set psShortcut to C_$Key_Ctrl_V
75505>>>>>>        Set psCategory to C_$CategoryEdit
75506>>>>>>    End_Procedure
75507>>>>>>
75507>>>>>>
75507>>>>>>    Procedure OnExecute Variant vCommandBarControl
75509>>>>>>        Send Paste of (focus(Self))
75510>>>>>>    End_Procedure
75511>>>>>>    
75511>>>>>>    Function IsEnabled Returns Boolean
75513>>>>>>        Boolean bEnabled
75513>>>>>>        Get CanPaste of (Focus(Self)) to bEnabled
75514>>>>>>        Function_Return bEnabled
75515>>>>>>    End_Function
75516>>>>>>         
75516>>>>>>End_Class
75517>>>>>>
75517>>>>>>Class cCJSelectAllMenuItem is a cCJMenuItem
75518>>>>>>    
75518>>>>>>    Procedure Construct_Object
75520>>>>>>        Forward Send Construct_Object
75522>>>>>>        Set psCaption   to C_$CaptionSelectAll
75523>>>>>>        Set psToolTip to C_$ToolTipSelectAll
75524>>>>>>        Set psDescription to C_$DescSelectAll
75525>>>>>>        Set pbActiveUpdate to True
75526>>>>>>        Set psShortcut to C_$Key_Ctrl_A
75527>>>>>>        Set psCategory to C_$CategoryEdit
75528>>>>>>    End_Procedure
75529>>>>>>
75529>>>>>>
75529>>>>>>    Procedure OnExecute Variant vCommandBarControl
75531>>>>>>        Send Select_All of (focus(Self))
75532>>>>>>    End_Procedure
75533>>>>>>    
75533>>>>>>    Function IsEnabled Returns Boolean
75535>>>>>>        Boolean bEnabled
75535>>>>>>        Get CanSelect of (Focus(Self)) to bEnabled
75536>>>>>>        Function_Return bEnabled
75537>>>>>>    End_Function
75538>>>>>>         
75538>>>>>>End_Class
75539>>>>>>
75539>>>>>> 
75539>>>>>>Class cCJExitMenuItem is a cCJMenuItem
75540>>>>>>
75540>>>>>>    Procedure Construct_Object
75542>>>>>>        Forward Send Construct_Object
75544>>>>>>        Set psCaption to C_$CaptionExit
75545>>>>>>        Set psToolTip to C_$ToolTipExit
75546>>>>>>        Set psDescription to C_$ToolTipExit
75547>>>>>>        Set psShortcut to C_$Key_Alt_F4
75548>>>>>>        Set psCategory to C_$CategoryFile
75549>>>>>>    End_Procedure
75550>>>>>>
75550>>>>>>    Procedure OnExecute Variant vCommandBarControl
75552>>>>>>        Send Exit_Application of Desktop
75553>>>>>>    End_Procedure
75554>>>>>>
75554>>>>>>End_Class           
75555>>>>>>
75555>>>>>>Class cCJHelpMenuItem is a cCJMenuItem    
75556>>>>>>
75556>>>>>>    Procedure Construct_Object
75558>>>>>>        Forward Send Construct_Object
75560>>>>>>        Set psCaption to C_$CaptionHelp
75561>>>>>>        Set psDescription to C_$ToolTipHelp
75562>>>>>>        Set psToolTip to C_$DescHelp
75563>>>>>>        Set psImage to "ActionHelp.ico"
75564>>>>>>        Set psShortcut to "F1"
75565>>>>>>        Set psCategory to C_$CategoryHelp
75566>>>>>>    End_Procedure
75567>>>>>>    
75567>>>>>>    Procedure OnExecute Variant vCommandBarControl
75569>>>>>>        Send Help of (Focus(Self))
75570>>>>>>    End_Procedure
75571>>>>>>
75571>>>>>>End_Class
75572>>>>>>
75572>>>>>>Class cCJStatusbarMenuItem is a cCJMenuItem
75573>>>>>>
75573>>>>>>    Procedure Construct_Object
75575>>>>>>        Forward Send Construct_Object
75577>>>>>>        Set psCaption to C_$CaptionAddStatusbar
75578>>>>>>        Set psToolTip to C_$ToolTipAddStatusbar
75579>>>>>>        Set psDescription to  C_$DescAddStatusbar
75580>>>>>>        Set psCategory to C_$CategoryWindow
75581>>>>>>    End_Procedure
75582>>>>>>
75582>>>>>>    Procedure OnExecute Variant vCommandBarControl
75584>>>>>>        Handle hoCommandBars hoClientArea
75584>>>>>>        Get CommandBarSystemObject to hoCommandBars
75585>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75586>>>>>>        If hoClientArea Begin
75588>>>>>>            // the clientarea's parent panel has message
75588>>>>>>            Send Toggle_StatusBar of (Parent(hoClientArea))
75589>>>>>>        End
75589>>>>>>>
75589>>>>>>    End_Procedure
75590>>>>>>
75590>>>>>>     Function IsChecked Returns Boolean
75592>>>>>>        Boolean bOn
75592>>>>>>        Handle hoCommandBars hoClientArea
75592>>>>>>        Get CommandBarSystemObject to hoCommandBars
75593>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75594>>>>>>        If hoClientArea Begin
75596>>>>>>            // the clientarea's parent panel has message
75596>>>>>>            Get StatusBar_State of (Parent(hoClientArea)) to bOn
75597>>>>>>        End
75597>>>>>>>
75597>>>>>>        Function_Return bOn
75598>>>>>>     End_Function
75599>>>>>>End_Class
75600>>>>>>
75600>>>>>>Class cCJAutoArrangeIconsMenuItem is a cCJMenuItem
75601>>>>>>
75601>>>>>>    Procedure Construct_Object
75603>>>>>>        Forward Send Construct_Object
75605>>>>>>        Set psCaption to C_$CaptionAutoArrangeIcons
75606>>>>>>        Set psToolTip to C_$ToolTipAutoArrangeIcons
75607>>>>>>        Set psDescription to C_$DescAutoArrangeIcons
75608>>>>>>        Set psCategory to C_$CategoryWindow
75609>>>>>>    End_Procedure
75610>>>>>>
75610>>>>>>    Procedure OnExecute Variant vCommandBarControl
75612>>>>>>        Handle hoCommandBars hoClientArea
75612>>>>>>        Get CommandBarSystemObject to hoCommandBars
75613>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75614>>>>>>        If hoClientArea Begin
75616>>>>>>            // the clientarea's parent panel has message
75616>>>>>>            Send Toggle_Auto_Arrange_Icons of (Parent(hoClientArea))
75617>>>>>>        End
75617>>>>>>>
75617>>>>>>    End_Procedure
75618>>>>>>    
75618>>>>>>     Function IsChecked Returns Boolean
75620>>>>>>        Boolean bOn
75620>>>>>>        Handle hoCommandBars hoClientArea
75620>>>>>>        Get CommandBarSystemObject to hoCommandBars
75621>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75622>>>>>>        If hoClientArea Begin
75624>>>>>>            // the clientarea's parent panel has message
75624>>>>>>            Get Auto_Arrange_Icons_State of (Parent(hoClientArea)) to bOn
75625>>>>>>        End
75625>>>>>>>
75625>>>>>>        Function_Return bOn
75626>>>>>>     End_Function
75627>>>>>>End_Class
75628>>>>>>
75628>>>>>>Class cCJRestoreMenusMenuItem is a cCJMenuItem
75629>>>>>>
75629>>>>>>    Procedure Construct_Object
75631>>>>>>        Forward Send Construct_Object
75633>>>>>>        Set psCaption to C_$CaptionRestoreMenus
75634>>>>>>        Set psToolTip to C_$ToolTipRestoreMenus
75635>>>>>>        Set psDescription to C_$DescRestoreMenus
75636>>>>>>        Set psCategory to C_$CategoryWindow
75637>>>>>>    End_Procedure
75638>>>>>>
75638>>>>>>    Procedure OnExecute Variant vCommandBarControl
75640>>>>>>        Handle hoCommandBars
75640>>>>>>        Get CommandBarSystemObject to hoCommandBars
75641>>>>>>        Send RestoreLayout of hoCommandBars
75642>>>>>>    End_Procedure
75643>>>>>>    
75643>>>>>>End_Class
75644>>>>>>
75644>>>>>>Class cCJCascadeMenuItem is a cCJMenuItem
75645>>>>>>
75645>>>>>>    Procedure Construct_Object
75647>>>>>>        Forward Send Construct_Object
75649>>>>>>        Set psCaption to C_$CaptionCascade
75650>>>>>>        Set psToolTip to C_$ToolTipCascade
75651>>>>>>        Set psDescription to  C_$DescCascade
75652>>>>>>        Set psImage to "ActionCascade.ico"
75653>>>>>>        Set psCategory to C_$CategoryWindow
75654>>>>>>    End_Procedure
75655>>>>>>    
75655>>>>>>    Procedure OnExecute Variant vCommandBarControl
75657>>>>>>        Handle hoCommandBars hoClientArea
75657>>>>>>        Get CommandBarSystemObject to hoCommandBars
75658>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75659>>>>>>        If hoClientArea Begin
75661>>>>>>            Send Cascade_Windows of hoClientArea
75662>>>>>>        End
75662>>>>>>>
75662>>>>>>    End_Procedure
75663>>>>>>End_Class
75664>>>>>>
75664>>>>>>Class cCJTileHorizontally is a cCJMenuItem
75665>>>>>>
75665>>>>>>    Procedure Construct_Object
75667>>>>>>        Forward Send Construct_Object
75669>>>>>>        Set psCaption to C_$CaptionTileHorizontally 
75670>>>>>>        Set psToolTip to C_$ToolTipTileHorizontally  
75671>>>>>>        Set psDescription to  C_$DescTileHorizontally
75672>>>>>>        Set psImage to "ActionTileHorizontally.ico"
75673>>>>>>        Set psCategory to C_$CategoryWindow
75674>>>>>>    End_Procedure
75675>>>>>>
75675>>>>>>    Procedure OnExecute Variant vCommandBarControl
75677>>>>>>        Handle hoCommandBars hoClientArea
75677>>>>>>        Get CommandBarSystemObject to hoCommandBars
75678>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75679>>>>>>        If hoClientArea Begin
75681>>>>>>            Send Tile_Windows_Horizontal of hoClientArea
75682>>>>>>        End
75682>>>>>>>
75682>>>>>>    End_Procedure
75683>>>>>>End_Class
75684>>>>>>
75684>>>>>>Class cCJTileVertically is a cCJMenuItem
75685>>>>>>
75685>>>>>>    Procedure Construct_Object
75687>>>>>>        Forward Send Construct_Object
75689>>>>>>        Set psCaption to C_$CaptionTileVertically  
75690>>>>>>        Set psToolTip to C_$ToolTipTileVertically
75691>>>>>>        Set psDescription to  C_$DescTileVertically
75692>>>>>>        Set psImage to "ActionTileVertically.ico"
75693>>>>>>        Set psCategory to C_$CategoryWindow
75694>>>>>>    End_Procedure
75695>>>>>>
75695>>>>>>    Procedure OnExecute Variant vCommandBarControl
75697>>>>>>        Handle hoCommandBars hoClientArea
75697>>>>>>        Get CommandBarSystemObject to hoCommandBars
75698>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75699>>>>>>        If hoClientArea Begin
75701>>>>>>            Send Tile_Windows_Vertical of hoClientArea
75702>>>>>>        End
75702>>>>>>>
75702>>>>>>    End_Procedure
75703>>>>>>End_Class
75704>>>>>>
75704>>>>>>Class cCJMinimizeWindowsMenuItem is a cCJMenuItem
75705>>>>>>
75705>>>>>>    Procedure Construct_Object
75707>>>>>>        Forward Send Construct_Object
75709>>>>>>        Set psCaption to C_$CaptionMinimizeWindows 
75710>>>>>>        Set psToolTip to C_$ToolTipMinimizeWindows
75711>>>>>>        Set psDescription to  C_$DescMinimizeWindows
75712>>>>>>        Set psCategory to C_$CategoryWindow
75713>>>>>>    End_Procedure
75714>>>>>>
75714>>>>>>    Procedure OnExecute Variant vCommandBarControl
75716>>>>>>        Handle hoCommandBars hoClientArea
75716>>>>>>        Get CommandBarSystemObject to hoCommandBars
75717>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75718>>>>>>        If hoClientArea Begin
75720>>>>>>            // the clientarea's parent panel has message
75720>>>>>>            Send Minimize_all_Windows of (Parent(hoClientArea))
75721>>>>>>        End
75721>>>>>>>
75721>>>>>>    End_Procedure
75722>>>>>>End_Class
75723>>>>>>
75723>>>>>>
75723>>>>>>Class cCJRestoreWindowsMenuItem is a cCJMenuItem
75724>>>>>>
75724>>>>>>    Procedure Construct_Object
75726>>>>>>        Forward Send Construct_Object
75728>>>>>>        Set psCaption to C_$CaptionRestoreWindows
75729>>>>>>        Set psToolTip to C_$ToolTipRestoreWindows
75730>>>>>>        Set psDescription to  C_$DescRestoreWindows
75731>>>>>>        Set psCategory to C_$CategoryWindow
75732>>>>>>    End_Procedure
75733>>>>>>
75733>>>>>>    Procedure OnExecute Variant vCommandBarControl
75735>>>>>>        Handle hoCommandBars hoClientArea
75735>>>>>>        Get CommandBarSystemObject to hoCommandBars
75736>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75737>>>>>>        If hoClientArea Begin
75739>>>>>>            // the clientarea's parent panel has message
75739>>>>>>            Send Restore_all_Windows of (Parent(hoClientArea))
75740>>>>>>        End
75740>>>>>>>
75740>>>>>>    End_Procedure
75741>>>>>>End_Class
75742>>>>>>
75742>>>>>>Class cCJArrangeIconsMenuItem is a cCJMenuItem
75743>>>>>>
75743>>>>>>    Procedure Construct_Object
75745>>>>>>        Forward Send Construct_Object
75747>>>>>>        Set psCaption to C_$CaptionArrangeIcons  
75748>>>>>>        Set psToolTip to C_$ToolTipArrangeIcons
75749>>>>>>        Set psDescription to  C_$DescArrangeIcons
75750>>>>>>        Set psCategory to C_$CategoryWindow
75751>>>>>>    End_Procedure
75752>>>>>>
75752>>>>>>    Procedure OnExecute Variant vCommandBarControl
75754>>>>>>        Handle hoCommandBars hoClientArea
75754>>>>>>        Get CommandBarSystemObject to hoCommandBars
75755>>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
75756>>>>>>        If hoClientArea Begin
75758>>>>>>            Send Arrange_Icons of hoClientArea
75759>>>>>>        End
75759>>>>>>>
75759>>>>>>    End_Procedure
75760>>>>>>
75760>>>>>>End_Class
75761>>>>>>    
75761>>>>
75761>>>>Object oEditContextMenu is a cCJContextMenu
75763>>>>    
75763>>>>    Move Self to Default_Form_Floating_Menu_ID
75764>>>>    
75764>>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75766>>>>    End_Object
75767>>>>    
75767>>>>    Object oCutMenuItem is a cCJCutMenuItem
75769>>>>        Set pbControlBeginGroup to True
75770>>>>    End_Object
75771>>>>    
75771>>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75773>>>>    End_Object
75774>>>>
75774>>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75776>>>>    End_Object
75777>>>>
75777>>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75779>>>>    End_Object
75780>>>>
75780>>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75782>>>>        Set pbControlBeginGroup to True
75783>>>>    End_Object
75784>>>>
75784>>>>End_Object
75785>>>>
75785>>Use oDEOEditContextMenu17.pkg
Including file: oDEOEditContextMenu17.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\oDEOEditContextMenu17.pkg)
75785>>>>Use Windows.pkg
75785>>>>Use cCJStandardMenuItemClasses.pkg
75785>>>>Use cCJDeoMenuItemClasses.pkg
75785>>>>
75785>>>>
75785>>>>Object oDEOEditContextMenu17 is a cCJContextMenu
75787>>>>    
75787>>>>    Move Self to Default_dbFloating_Menu_ID
75788>>>>    
75788>>>>    Object oUndoMenuItem is a cCJUndoMenuItem
75790>>>>    End_Object
75791>>>>    
75791>>>>    Object oCutMenuItem is a cCJCutMenuItem
75793>>>>        Set pbControlBeginGroup to True
75794>>>>    End_Object
75795>>>>    
75795>>>>    Object oCopyMenuItem is a cCJCopyMenuItem
75797>>>>    End_Object
75798>>>>
75798>>>>    Object oPasteMenuItem is a cCJPasteMenuItem
75800>>>>    End_Object
75801>>>>
75801>>>>    Object oDeleteItem is a cCJDeleteEditMenuItem
75803>>>>    End_Object
75804>>>>
75804>>>>    Object oSelectAllMenuItem is a cCJSelectAllMenuItem
75806>>>>        Set pbControlBeginGroup to True
75807>>>>    End_Object
75808>>>>
75808>>>>    Object oPromptMenuItem is a cCJPromptMenuItem
75810>>>>        Set pbControlBeginGroup to True
75811>>>>    End_Object
75812>>>>
75812>>>>    Object oFindNextMenu is a cCJFindNextMenuItem
75814>>>>        Set pbControlBeginGroup to True
75815>>>>    End_Object
75816>>>>
75816>>>>    Object oFindPreviousMenu is a cCJFindPreviousMenuItem
75818>>>>    End_Object
75819>>>>
75819>>>>    Object oClearMenuItem is a cCJClearMenuItem
75821>>>>        Set pbControlBeginGroup to True
75822>>>>    End_Object
75823>>>>
75823>>>>    Object oClearAllMenu is a cCJClearAllMenuItem
75825>>>>    End_Object
75826>>>>
75826>>>>    Object oSaveMenu is a cCJSaveMenuItem
75828>>>>    End_Object
75829>>>>    
75829>>>>    Object oDeleteMenu is a cCJDeleteMenuItem
75831>>>>    End_Object
75832>>>>
75832>>>>    Object oRememberitem is a cCJRememberFieldMenuItem
75834>>>>        Set pbControlBeginGroup to True
75835>>>>    End_Object
75836>>>>
75836>>>>    Object oRetainItem is a cCJRememberLastFieldMenuItem
75838>>>>    End_Object
75839>>>>
75839>>>>    Object oUnRememberitem is a cCJUnRememberFieldMenuItem
75841>>>>    End_Object
75842>>>>
75842>>>>    Object oCJClearAllDynamicDefaults is a cCJUnRememberFieldAllMenuItem
75844>>>>    End_Object
75845>>>>
75845>>>>End_Object
75846>>
75846>>// Outras
75846>>//Use WindowsProcesses.pkg
75846>>
75846>>// Atributos dos elementos da janela principal
75846>>Define C_Bar_Menu          for 1
75846>>Define C_Bar_Favoritos for 2
75846>>Define C_Bar_Recentes  for 3
75846>>
75846>>Define C_Pane_Short_Cut_Bar for 1
75846>>Define C_Pane_Error_Log_Bar for 2
75846>>Define C_Pane_Notify_Bar for 3
75846>>Define C_Pane_Search_Bar for 4
75846>>
75846>>Define C_Theme_DLL for "Office2010.dll"
75846>>Define C_Theme_Color for "Office2010Silver.ini"
75846>>Define C_Language_File for "SuitePro.ResourcePtBr.dll"
75846>>
75846>>// Formatacao da data para 4 digitos e ano inicial
75846>>Set_Date_Attribute SysDate4_State to True
75847>>Set_Date_Attribute Date4_State    to True
75848>>Set_Date_Attribute Epoch_Value    to 30
75849>>
Including file: VarGlobais.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\VarGlobais.pkg)
75849>>// Processo ativo
75849>>//#IFNDEF ghoActiveProcess
75849>>//    Handle ghoActiveProcess
75849>>//#ENDIF
75849>>
75849>>String gsCompany
75849>>String gsProduct
75849>>String gsVersaoSys          // Guarda a versao do PSGA
75849>>String gsCodUser            // Codigo do usuario do sistema passado por parametro
75849>>String  gsPath              // Path para verificar proteÎ’o somente leitura
75849>>Boolean gbExist             // Verifica que arquivo existe, para verificar proteÎ’o somente leitura
75849>>Boolean gbTeste             //Variavel para indicar que ‚ ambiente de teste
75849>>Handle ghoDDSeq
75849>>Handle ghoVersionInfo
75849>>
75849>>Integer giArrayQuery   
75849>>
75849>>Boolean gbLoginCfg
75849>>
75849>>Object oArrayQueryResult is an array
75851>>    Move Self to giArrayQuery
75852>>End_Object
75853>>
75853>>Struct tDadosField    // declares a new struct type
75853>>    String sNome
75853>>    Integer iTipo
75853>>    Integer iSeq
75853>>    Integer iSize
75853>>    Integer iPrecision
75853>>End_Struct
75853>>
75853>>Struct tFilterComponents
75853>>    Handle hObject
75853>>    Integer iGroupFilter
75853>>    Integer iObjectType //C_VISUALCONTROL_FORM; C_VISUALCONTROL_COMBO; C_VISUALCONTROL_CHECK
75853>>    Integer iFilterType //>= = <=
75853>>    Integer iDataType   //DF_ASCII, DF_BCD, DF_DATE, DF_DATETIME, DF_OVERLAP, DF_TEXT, DF_BINARY
75853>>End_Struct
75853>>
75853>>
75853>>//Constantes tipo de dados Form
75853>>Define C_FORMTYPE_CHAR for 0
75853>>Define C_FORMTYPE_NUMBER for 1
75853>>Define C_FORMTYPE_DATE for 2
75853>>
75853>>//Contantes tipo GFILTREL
75853>>Define C_TIPOFILT_IGUAL for 0
75853>>Define C_TIPOFILT_INI_FIN for 1
75853>>
75853>>//Constantes tipo de objeto
75853>>Define C_VISUALCONTROL_FORM for 0
75853>>Define C_VISUALCONTROL_COMBO for 1
75853>>Define C_VISUALCONTROL_CHECK for 2
75853>>
75853>>//Constantes Tipo Retorno Get_Description
75853>>Define C_GETDESC_LABEL_LONG for 0
75853>>Define C_GETDESC_LABEL_SHORT for 1
75853>>Define C_GETDESC_STATUS_HELP FOR 2
75853>>
75853>>//Constantes Tipo Retorno Get_Names
75853>>Define C_GETNAME_FILE for 0
75853>>Define C_GETNAME_FIELD for 1
75853>>Define C_GETNAME_BOTH for 2
75853>>Define C_GETNAME_FIELDNUMBER for 3
75853>>
75853>>//Constantes Tipo de Filtro
75853>>Define C_FILTERTYPE_EQ for 0    // =
75853>>Define C_FILTERTYPE_GE for 1    // >=
75853>>Define C_FILTERTYPE_LE for 2    // <=
75853>>
75853>>//Constantes Tipo Pesquisa Get_Description_itens
75853>>Define C_FINDTYPE_DESCRIPTIONITENS_SEQ for 0
75853>>Define C_FINDTYPE_DESCRIPTIONITENS_LABEL for 1
75853>>Define C_FINDTYPE_DESCRIPTIONITENS_BOTH for 2
75853>>
75853>>//Constantes Tipo de Retorno Get_Description_Itens
75853>>Define C_RETURNTYPE_DESCRIPTIONITENS_SEQ for 0
75853>>Define C_RETURNTYPE_DESCRIPTIONITENS_LABEL for 1
75853>>Define C_RETURNTYPE_DESCRIPTIONITENS_BOTH for 2
75853>>
75853>
75853>Use ConBDDll.pkg // Cria conexao
Including file: ConBDDll.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\ConBDDll.pkg)
75853>>>//
75853>>>//Faz a conexÆo ao BD de informa‡äes do servidor e preenche as String globais
75853>>>//
75853>>>
75853>>>Use sql.pkg
Including file: sql.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\sql.pkg)
75853>>>>>//*****************************************************************************
75853>>>>>//*** SQL.pkg                                                               ***
75853>>>>>//***                                                                       ***
75853>>>>>//*** Author: Ben Weijers                                                   ***
75853>>>>>//***         Data Access Wordwide                                          ***
75853>>>>>//***         14 February 2000                                              ***
75853>>>>>//***                                                                       ***
75853>>>>>//*** Purpose:                                                              ***
75853>>>>>//***       Embedded SQL classes for use with Data Access Worldwide CLI     ***
75853>>>>>//***       Connectivty Kits.                                               ***
75853>>>>>//***                                                                       ***
75853>>>>>//*** Last update:                                                          ***
75853>>>>>//***       February 2014. Current CLI Connectivity Kit 6.0.0.28            ***
75853>>>>>//***                                                                       ***
75853>>>>>//*** !! Please Note !!                                                     ***
75853>>>>>//***       -This version of sql.pkg will only work with CLI Connectivity   ***
75853>>>>>//***        Kits 6.0.0.28 or later.                                        ***
75853>>>>>//***       -This version of sql.pkg will no longer function with DataFlex  ***
75853>>>>>//***        character mode (DataFlex 3.2). To use embedded SQL with        ***
75853>>>>>//**         DataFlex character mode, use sqlold.pkg.                       ***
75853>>>>>//***       -This version of sql.pkg no longer contains the embedded SQL    ***
75853>>>>>//***        command interface. The command interface is still available    ***
75853>>>>>//***        in sqlold.pkg                                                  ***
75853>>>>>//***                                                                       ***
75853>>>>>//*** Changes:                                                              ***
75853>>>>>//***       February 2014. CLI Connectivity Kit 6.0.0.28                    ***
75853>>>>>//***                                                                       ***
75853>>>>>//***       Several performances improvements to speed up SQLColumnValue    ***
75853>>>>>//***       and SQLGetData                                                  ***
75853>>>>>//***                                                                       ***
75853>>>>>//***       New functions:                                                  ***
75853>>>>>//***           Function SQLFetchRowValues Returns String[]                 ***
75853>>>>>//***               Fetches a row and returns all columns in an array.      ***
75853>>>>>//***                                                                       ***
75853>>>>>//***           Function SQLFetchResultsetValues Returns String[][]         ***
75853>>>>>//***               Fetches all rows of a result set and returns the        ***
75853>>>>>//***               result set as a 2-dimensial array.                      ***
75853>>>>>//***                                                                       ***
75853>>>>>//*****************************************************************************
75853>>>>>
75853>>>>>Use CLI.pkg
Including file: cli.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cli.pkg)
75853>>>>>>>//*****************************************************************************
75853>>>>>>>//*** CLI.PKG                                                               ***
75853>>>>>>>//***                                                                       ***
75853>>>>>>>//*** Author: Ben Weijers                                                   ***
75853>>>>>>>//***         Data Access Nederland                                         ***
75853>>>>>>>//***         10 September 1998                                             ***
75853>>>>>>>//***                                                                       ***
75853>>>>>>>//*** Purpose:                                                              ***
75853>>>>>>>//***   CLI specific functionality. There are several connectivity kits     ***
75853>>>>>>>//***   based on  SQL/92 CLI. Those are:                                    ***
75853>>>>>>>//***    - ODBC_DRV  The Data Access CK for ODBC                            ***
75853>>>>>>>//***    - DB2_DRV   The Data Access CK for DB2                             ***
75853>>>>>>>//***    - MSSQLDRV  The Data Access CK for Microsoft SQL Server            ***
75853>>>>>>>//***                                                                       ***
75853>>>>>>>//***   This package defines the common functionality for all CLI based     ***
75853>>>>>>>//***   drivers.                                                            ***
75853>>>>>>>//***                                                                       ***
75853>>>>>>>//***   Updated:  May 23rd 2008 (Current CK build: 5.0.0.53 )               ***
75853>>>>>>>//***             Added NULLABLE and DEFAULT attributes for DATETIME type   ***
75853>>>>>>>//***   Updated:  Apr  6th 2009 (Current CK build: 5.0.0.61 )               ***
75853>>>>>>>//***             Added DF_DRIVER_MATCH_CLIENT_SERVER_VERSION attribute     ***
75853>>>>>>>//***                   DF_DRIVER_SQLSERVER_CLIENT_VERSION    attribute     ***
75853>>>>>>>//***   Updated:  Mar 30th 2012 (Current CK build: 5.1.0.93 )               ***
75853>>>>>>>//***             Added SQLSERVER2012CLIENT return value for                ***
75853>>>>>>>//***             DF_DRIVER_SQLSERVER_CLIENT_VERSION attribute              ***
75853>>>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
75853>>>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
75853>>>>>>>//***             mssqldrv.pkg                                              ***
75853>>>>>>>//***   Updated:  april 23, 2013 (Current CK build: 6.0.0.4)                ***
75853>>>>>>>//***             Added type mappings attributes                            ***
75853>>>>>>>//***   Updated:  october 11, 2013 (Current CK build: 6.0.0.18)             ***
75853>>>>>>>//***             Added DF_FILE_SQL_FILTER_EQ attribute                     ***
75853>>>>>>>//*****************************************************************************
75853>>>>>>>
75853>>>>>>>//*** We are not using ifndef below because that is not supported in Character Mode
75853>>>>>>>//*** Driver attributes
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//------------------------------------------------------------
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//-------------------------------------
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*** Replacement for logical column number that indicates all columns
75853>>>>>>>
75853>>>>>>>//*** Possible DF_FILE_GENERATE_RECORD_ID_METHOD values
75853>>>>>>>
75853>>>>>>>//*** Possible DF_FIELD_READ_ONLY values
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*** Possible DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA values
75853>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK5        1       
75853>>>>>>>// #Replace MAP_DF_TO_SQL_TYPE_CK6        2   
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>// Moved to Mssqldrv.pkg
75853>>>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
75853>>>>>>>//#REPLACE SQLSERVERUNKNOWNCLIENT  0
75853>>>>>>>//#REPLACE SQLSERVER2000CLIENT     8          //   "SQL Server"
75853>>>>>>>//#REPLACE SQLSERVER2005CLIENT     9          //   "SQL Native Client"
75853>>>>>>>//#REPLACE SQLSERVER2008CLIENT    10          //   "SQL Server Native Client 10.0"
75853>>>>>>>//#Replace SQLSERVER2012CLIENT    11          //   "SQL Server Native Client 11.0"
75853>>>>>>>
75853>>>>>>>//*** Possible SQL Column type values
75853>>>>>>>Define SQL_UNKNOWN_TYPE   For    0
75853>>>>>>>Define SQL_CHAR           For    1
75853>>>>>>>Define SQL_NUMERIC        For    2
75853>>>>>>>Define SQL_DECIMAL        For    3
75853>>>>>>>Define SQL_INTEGER        For    4
75853>>>>>>>Define SQL_SMALLINT       For    5
75853>>>>>>>Define SQL_FLOAT          For    6
75853>>>>>>>Define SQL_REAL           For    7
75853>>>>>>>Define SQL_DOUBLE         For    8
75853>>>>>>>Define SQL_DATETIME       For    9
75853>>>>>>>Define SQL_VARCHAR        For   12
75853>>>>>>>Define SQL_TYPE_DATE      For   91
75853>>>>>>>Define SQL_TYPE_TIME      For   92
75853>>>>>>>Define SQL_TYPE_TIMESTAMP for   93
75853>>>>>>>// Moved to mssqldrv.pkg
75853>>>>>>>//Define SQL_TYPE_TIMESTAMP2 for   (-200) //SQL server datetime2 type */
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>Define SQL_DATE           For    9
75853>>>>>>>Define SQL_INTERVAL       For   10
75853>>>>>>>Define SQL_TIME           For   10
75853>>>>>>>Define SQL_TIMESTAMP      For   11
75853>>>>>>>Define SQL_LONGVARCHAR    For  (-1)
75853>>>>>>>Define SQL_BINARY         For  (-2)
75853>>>>>>>Define SQL_VARBINARY      For  (-3)
75853>>>>>>>Define SQL_LONGVARBINARY  For  (-4)
75853>>>>>>>Define SQL_BIGINT         For  (-5)
75853>>>>>>>Define SQL_TINYINT        For  (-6)
75853>>>>>>>Define SQL_BIT            For  (-7)
75853>>>>>>>Define SQL_WCHAR          For  (-8)
75853>>>>>>>Define SQL_WVARCHAR       For  (-9)
75853>>>>>>>Define SQL_WLONGVARCHAR   For (-10)
75853>>>>>>>Define SQL_GUID           For (-11)
75853>>>>>>>
75853>>>>>>>//*** Driver level attributes
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*** Error number constants
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*** Call driver function identifiers
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*** Init data source types
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*** Dummy strings used in the commands
75853>>>>>>>    String  CLI$StrDummy 255
75853>>>>>>>    Integer CLI$IntDummy
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*****************************************************************************
75853>>>>>>>//*** CLI_SetConstraint <FileNum> <NewState>                                ***
75853>>>>>>>//***                                                                       ***
75853>>>>>>>//***   Setup a constraint for a file.                                      ***
75853>>>>>>>//*****************************************************************************
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*****************************************************************************
75853>>>>>>>//*** CLI_Set_Driver_Atrtribute / CLI_Get_Driver_Attribute                  ***
75853>>>>>>>//***                                                                       ***
75853>>>>>>>//*** Set or get an attribute at driver level. These attributes, when set,  ***
75853>>>>>>>//*** will be set for the remainder of the session or until set again. To   ***
75853>>>>>>>//*** permanently set driver level attributes change the driver             ***
75853>>>>>>>//*** configuration file.                                                   ***
75853>>>>>>>//*****************************************************************************
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>
75853>>>>>>>//*****************************************************************************
75853>>>>>>>//*** Class  : cCLIHandler                                                  ***
75853>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
75853>>>>>>>//***          call several CLI releated methods.                           ***
75853>>>>>>>//*****************************************************************************
75853>>>>>>>
75853>>>>>>>Class cCLIHandler Is An Array
75854>>>>>>>
75854>>>>>>>    Procedure Construct_Object Integer iImage
75856>>>>>>>        Forward Send Construct_object iImage
75858>>>>>>>
75858>>>>>>>        Property String  psDriverID       Public ""
75859>>>>>>>    End_Procedure // Construct_Object
75860>>>>>>>
75860>>>>>>>
75860>>>>>>>
75860>>>>>>>    //***
75860>>>>>>>    //*** Fucntion: CKRevsion
75860>>>>>>>    //*** Purpose : The revsion of a CLI Connectivity Kit
75860>>>>>>>    //***
75860>>>>>>>
75860>>>>>>>    Function CKRevision Returns String
75862>>>>>>>        Local String  sDriverID
75862>>>>>>>        Local String  sRevision
75862>>>>>>>        Local String  sVoid
75862>>>>>>>        Local Integer iRetval
75862>>>>>>>
75862>>>>>>>        Get psDriverID To sDriverID
75863>>>>>>>        If (sDRiverID <> "") Begin
75865>>>>>>>            Move (Repeat(" ", 255)) To sRevision
75866>>>>>>>            Call_Driver 0 sDRiverID Function CLI_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
75871>>>>>>>        End
75871>>>>>>>>
75871>>>>>>>
75871>>>>>>>        Function_Return sRevision
75872>>>>>>>    End_Function // CKRevision
75873>>>>>>>
75873>>>>>>>
75873>>>>>>>
75873>>>>>>>    //***
75873>>>>>>>    //*** Function: ExtractPartFromRevision
75873>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
75873>>>>>>>    //***
75873>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
75873>>>>>>>    //***
75873>>>>>>>
75873>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
75875>>>>>>>        Local Integer iPartRev
75875>>>>>>>        Local Integer iCurrentPart
75875>>>>>>>        Local Integer iSeparatorPos
75875>>>>>>>
75875>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
75878>>>>>>>
75878>>>>>>>        Move 0 To iCurrentPart
75879>>>>>>>        Repeat
75879>>>>>>>>
75879>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
75880>>>>>>>            If (iSeparatorPos > 0) Begin
75882>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
75883>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
75884>>>>>>>                Increment iCurrentPart
75885>>>>>>>            End
75885>>>>>>>>
75885>>>>>>>            Else If (sRevision <> "") Begin
75888>>>>>>>                Move sRevision To iPartRev
75889>>>>>>>                Move "" To sRevision
75890>>>>>>>                Increment iCurrentPart
75891>>>>>>>            End
75891>>>>>>>>
75891>>>>>>>            Else ;                Move -1 To iPartRev
75893>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
75895>>>>>>>
75895>>>>>>>        Function_Return iPartRev
75896>>>>>>>    End_Function // EcxtractPartFromRevision
75897>>>>>>>
75897>>>>>>>
75897>>>>>>>
75897>>>>>>>    //***
75897>>>>>>>    //*** Function: CKMajorRevision
75897>>>>>>>    //*** Purpose : Returns the major revision of the CK
75897>>>>>>>    //***
75897>>>>>>>
75897>>>>>>>    Function CKMajorRevision Returns Integer
75899>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
75900>>>>>>>    End_Function // CKMajorRevision
75901>>>>>>>
75901>>>>>>>
75901>>>>>>>
75901>>>>>>>    //***
75901>>>>>>>    //*** Function: CKMinorRevision
75901>>>>>>>    //*** Purpose : Returns the minor revision of the CK
75901>>>>>>>    //***
75901>>>>>>>
75901>>>>>>>    Function CKMinorRevision Returns Integer
75903>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
75904>>>>>>>    End_Function // CKMinorRevision
75905>>>>>>>
75905>>>>>>>
75905>>>>>>>
75905>>>>>>>    //***
75905>>>>>>>    //*** Function: CKReleaseRevision
75905>>>>>>>    //*** Purpose : Returns the release revision of the CK
75905>>>>>>>    //***
75905>>>>>>>
75905>>>>>>>    Function CKReleaseRevision Returns Integer
75907>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
75908>>>>>>>    End_Function // CKReleaseRevision
75909>>>>>>>
75909>>>>>>>
75909>>>>>>>
75909>>>>>>>    //***
75909>>>>>>>    //*** Function: CKBuildRevision
75909>>>>>>>    //*** Purpose : Returns the major revision of the CK
75909>>>>>>>    //***
75909>>>>>>>
75909>>>>>>>    Function CKBuildRevision Returns Integer
75911>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
75912>>>>>>>    End_Function // CKBuildRevision
75913>>>>>>>
75913>>>>>>>
75913>>>>>>>
75913>>>>>>>    //***
75913>>>>>>>    //*** Function: IsMinimalRevision
75913>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
75913>>>>>>>    //***
75913>>>>>>>
75913>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
75915>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
75918>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
75921>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
75924>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
75927>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
75930>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
75934>>>>>>>            End
75934>>>>>>>>
75934>>>>>>>        End
75934>>>>>>>>
75934>>>>>>>
75934>>>>>>>        Function_Return (FALSE)
75935>>>>>>>    End_Function // IsMinimalRevision
75936>>>>>>>
75936>>>>>>>
75936>>>>>>>
75936>>>>>>>    //***
75936>>>>>>>    //*** Function: RegistrationName
75936>>>>>>>    //*** Purpose : Returns the Connectiivty Kit registration name.
75936>>>>>>>    //***
75936>>>>>>>
75936>>>>>>>    Function RegistrationName Returns String
75938>>>>>>>        Local String  sRegistration
75938>>>>>>>        Local String  sDRiverId
75938>>>>>>>        Local String  sVoid
75938>>>>>>>        Local Integer iRetval
75938>>>>>>>
75938>>>>>>>        Get psDriverID To sDriverID
75939>>>>>>>        If (sDRiverID <> "") Begin
75941>>>>>>>            Move (Repeat(" ", 255)) To sRegistration
75942>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETREGNAME Callback 0 Passing sRegistration sVoid 0 Result iRetval
75947>>>>>>>        End
75947>>>>>>>>
75947>>>>>>>
75947>>>>>>>        Function_Return sRegistration
75948>>>>>>>    End_Function // RegistrationName
75949>>>>>>>
75949>>>>>>>
75949>>>>>>>
75949>>>>>>>    //***
75949>>>>>>>    //*** Function: SerialNumber
75949>>>>>>>    //*** Purpose : Returns the Connectiivty Kit serial number.
75949>>>>>>>    //***
75949>>>>>>>
75949>>>>>>>    Function SerialNumber Returns Integer
75951>>>>>>>        Local String  sDRiverId
75951>>>>>>>        Local String  sVoid
75951>>>>>>>        Local Integer iRetval
75951>>>>>>>
75951>>>>>>>        Get psDriverID To sDriverID
75952>>>>>>>        If (sDRiverID <> "") Begin
75954>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETSERIALNUM Callback 0 Passing sVoid sVoid 0 Result iRetval
75959>>>>>>>        End
75959>>>>>>>>
75959>>>>>>>
75959>>>>>>>        Function_Return iRetval
75960>>>>>>>    End_Function // SerialNumber
75961>>>>>>>
75961>>>>>>>
75961>>>>>>>
75961>>>>>>>    //***
75961>>>>>>>    //*** Function: MaxUsers
75961>>>>>>>    //*** Purpose : Returns the Connectiivty Kit maximum number of users.
75961>>>>>>>    //***
75961>>>>>>>
75961>>>>>>>    Function MaxUsers Returns Integer
75963>>>>>>>        Local String  sDRiverId
75963>>>>>>>        Local String  sVoid
75963>>>>>>>        Local Integer iRetval
75963>>>>>>>
75963>>>>>>>        Get psDriverID To sDriverID
75964>>>>>>>        If (sDRiverID <> "") Begin
75966>>>>>>>            Call_Driver 0 sDRiverID Function CLI_GETMAXUSERS Callback 0 Passing sVoid sVoid 0 Result iRetval
75971>>>>>>>        End
75971>>>>>>>>
75971>>>>>>>
75971>>>>>>>        Function_Return iRetval
75972>>>>>>>    End_Function // MaxUsers
75973>>>>>>>
75973>>>>>>>
75973>>>>>>>
75973>>>>>>>    //***
75973>>>>>>>    //*** Procedure: DumpStatus
75973>>>>>>>    //*** Purpose  : Dump the current status of the drver in the passed disk file.
75973>>>>>>>    //***
75973>>>>>>>
75973>>>>>>>    Procedure DumpStatus String sFileName
75975>>>>>>>        Local String  sVoid
75975>>>>>>>        Local String  sDriverID
75975>>>>>>>        Local Integer iVoid
75975>>>>>>>
75975>>>>>>>        Get psDriverID To sDriverID
75976>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_DUMPSTATUS Callback 0 Passing sFileName sVoid iVoid Result iVoid
75983>>>>>>>    End_Procedure // DumpStatus
75984>>>>>>>
75984>>>>>>>
75984>>>>>>>
75984>>>>>>>    //***
75984>>>>>>>    //*** Procedure: ReadConfiguration
75984>>>>>>>    //*** Purpose  : Reset all driver level configurable attributes to the
75984>>>>>>>    //***            default value and then reread the configuration.
75984>>>>>>>    //***
75984>>>>>>>
75984>>>>>>>    Procedure ReadConfiguration
75986>>>>>>>        Local String  sVoid
75986>>>>>>>        Local String  sDriverID
75986>>>>>>>        Local Integer iVoid
75986>>>>>>>
75986>>>>>>>        Get psDriverID To sDriverID
75987>>>>>>>        If (sDriverID <> "") ;            Call_driver 0 sDriverID Function CLI_READCONFIGURATION Callback 0 Passing sVoid sVoid iVoid Result iVoid
75994>>>>>>>    End_Procedure // ReadConfiguration
75995>>>>>>>
75995>>>>>>>
75995>>>>>>>
75995>>>>>>>    //***
75995>>>>>>>    //*** Function: TextToRIMValue
75995>>>>>>>    //*** Purpose : Convert a text to the corresponding
75995>>>>>>>    //***           Generate_Record_ID_Method attribute value
75995>>>>>>>    //***
75995>>>>>>>
75995>>>>>>>    Function TextToRIMValue String sText Returns Integer
75997>>>>>>>        If (sText = "None") ;            Function_return RIM_NONE
76000>>>>>>>        Else If (sText = "Identity Column") ;            Function_return RIM_IDENTITY_COLUMN
76004>>>>>>>        Else If (sText = "Dispenser Table") ;            Function_return RIM_DISPENSER_TABLE
76008>>>>>>>        Else If (sText = "External") ;            Function_return RIM_EXTERNAL
76012>>>>>>>    End_Function // TextToRIMValue
76013>>>>>>>
76013>>>>>>>
76013>>>>>>>
76013>>>>>>>    //***
76013>>>>>>>    //*** Function: RIMValueTotext
76013>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76013>>>>>>>    //***           corresponding text.
76013>>>>>>>    //***
76013>>>>>>>
76013>>>>>>>    Function RIMValueToText Integer iAttrValue Returns String
76015>>>>>>>        If (iAttrValue = RIM_NONE) ;            Function_return "None"
76018>>>>>>>        Else If (iAttrValue = RIM_IDENTITY_COLUMN) ;            Function_return "Identity Column"
76022>>>>>>>        Else If (iAttrValue = RIM_DISPENSER_TABLE) ;            Function_return "Dispenser Table"
76026>>>>>>>        Else If (iAttrValue = RIM_EXTERNAL) ;            Function_return "External"
76030>>>>>>>    End_Function // RIMValueToText
76031>>>>>>>
76031>>>>>>>
76031>>>>>>>
76031>>>>>>>    //***
76031>>>>>>>    //*** Function: TextToROValue
76031>>>>>>>    //*** Purpose : Convert a text to the corresponding
76031>>>>>>>    //***           Generate_Record_ID_Method attribute value
76031>>>>>>>    //***
76031>>>>>>>
76031>>>>>>>    Function TextToROValue String sText Returns Integer
76033>>>>>>>        If (sText = "No") ;            Function_return RO_NO
76036>>>>>>>        Else If (sText = "Ignore Change") ;            Function_return RO_IGNORECHANGE
76040>>>>>>>        Else If (sText = "Accept Change") ;            Function_return RO_ACCEPTCHANGE
76044>>>>>>>        Else If (sText = "Error On Change") ;            Function_return RO_ERRORONCHANGE
76048>>>>>>>    End_Function // TextToRIMValue
76049>>>>>>>
76049>>>>>>>
76049>>>>>>>
76049>>>>>>>    //***
76049>>>>>>>    //*** Function: ROValueTotext
76049>>>>>>>    //*** Purpose : Convert a Generate_Record_ID_Method attribute value to the
76049>>>>>>>    //***           corresponding text.
76049>>>>>>>    //***
76049>>>>>>>
76049>>>>>>>    Function ROValueToText Integer iAttrValue Returns String
76051>>>>>>>        If (iAttrValue = RO_NO) ;            Function_return "No"
76054>>>>>>>        Else If (iAttrValue = RO_IGNORECHANGE) ;            Function_return "Ignore Change"
76058>>>>>>>        Else If (iAttrValue = RO_ACCEPTCHANGE) ;            Function_return "Accept Change"
76062>>>>>>>        Else If (iAttrValue = RO_ERRORONCHANGE) ;            Function_return "Error On Change"
76066>>>>>>>    End_Function // RIMValueToText
76067>>>>>>>
76067>>>>>>>
76067>>>>>>>
76067>>>>>>>    //***
76067>>>>>>>    //*** Function: LastDriverError
76067>>>>>>>    //*** Purpose : Return the text f the last error geneated by the driver.
76067>>>>>>>    //***
76067>>>>>>>
76067>>>>>>>    Function LastDriverError Returns String
76069>>>>>>>        Local String  sDriverID
76069>>>>>>>        Local String  sLastError
76069>>>>>>>        Local String  sLastErrorLength
76069>>>>>>>        Local Integer iLastErrorLength
76069>>>>>>>        Local Integer iVoid
76069>>>>>>>
76069>>>>>>>        //*** Initialize
76069>>>>>>>        Move "" To sLastError
76070>>>>>>>
76070>>>>>>>        Get psDriverID To sDriverID
76071>>>>>>>        If (sDriverID <> "") Begin
76073>>>>>>>            //*** Get the text of the last error
76073>>>>>>>            Move (Repeat(Character(" "), 14)) To sLastErrorlength
76074>>>>>>>            Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastErrorLength iVoid DRVR_LASTERRORTEXTLENGTH Result iVoid
76079>>>>>>>            Move (Left(sLastErrorLength, Pos(Character(0), sLastErrorLength) - 1)) To iLastErrorLength
76080>>>>>>>
76080>>>>>>>            If (iLastErrorLength > 0) Begin
76082>>>>>>>                Move (Repeat(Character(" "), iLastErrorLength + 1)) To sLastError
76083>>>>>>>                Call_driver 0 sDriverID Function CLI_GETDRIVERATTRIBUTE Callback 0 Passing sLastError iVoid DRVR_LASTERRORTEXT Result iVoid
76088>>>>>>>                Move (Left(sLastError, Pos(Character(0), sLastError) - 1)) To sLastError
76089>>>>>>>            End
76089>>>>>>>>
76089>>>>>>>        End
76089>>>>>>>>
76089>>>>>>>
76089>>>>>>>        Function_Return sLastError
76090>>>>>>>    End_Function // LastDriverError
76091>>>>>>>
76091>>>>>>>
76091>>>>>>>
76091>>>>>>>    //***
76091>>>>>>>    //*** Function: EnumerateTables
76091>>>>>>>    //*** Purpose : Enumerate the tables in a database
76091>>>>>>>    //***
76091>>>>>>>
76091>>>>>>>    Function EnumerateTables String sLogin Returns Integer
76093>>>>>>>        Local String  sDriver
76093>>>>>>>        Local String  sVoid
76093>>>>>>>        Local Integer iNumTables
76093>>>>>>>        Local Integer iVoid
76093>>>>>>>
76093>>>>>>>        Get psDriverID To sDriver
76094>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_TABLES Callback 0 Passing sLogin sVoid iVoid Result iNumTables
76101>>>>>>>
76101>>>>>>>        Function_Return iNumTables
76102>>>>>>>    End_Function // EnumerateTables
76103>>>>>>>
76103>>>>>>>
76103>>>>>>>
76103>>>>>>>    //***
76103>>>>>>>    //*** Function: TableName
76103>>>>>>>    //*** Purpose : Returns the name of the table enumerated at the given position
76103>>>>>>>    //***
76103>>>>>>>
76103>>>>>>>    Function TableName Integer iIndex Returns String
76105>>>>>>>        Local String  sDriver
76105>>>>>>>        Local String  sTableName
76105>>>>>>>        Local String  sVoid
76105>>>>>>>        Local Integer iVoid
76105>>>>>>>
76105>>>>>>>        Get psDriverID To sDriver
76106>>>>>>>        If (sDriver <> "") Begin
76108>>>>>>>            Move (Repeat(" ", 255)) To sTableName
76109>>>>>>>            Call_driver 0 sDriver Function CLI_TABLENAME Callback 0 Passing sTableName sVoid iIndex Result iVoid
76114>>>>>>>        End
76114>>>>>>>>
76114>>>>>>>
76114>>>>>>>        Function_Return sTableName
76115>>>>>>>    End_Function // TableName
76116>>>>>>>
76116>>>>>>>
76116>>>>>>>
76116>>>>>>>    //***
76116>>>>>>>    //*** Function: SchemaName
76116>>>>>>>    //*** Purpose : Returns the name of the schema of the table enumerated at the given position
76116>>>>>>>    //***
76116>>>>>>>
76116>>>>>>>    Function SchemaName Integer iIndex Returns String
76118>>>>>>>        Local String  sDriver
76118>>>>>>>        Local String  sSchemaName
76118>>>>>>>        Local String  sVoid
76118>>>>>>>        Local Integer iVoid
76118>>>>>>>
76118>>>>>>>        Get psDriverID To sDriver
76119>>>>>>>        If (sDriver <> "") Begin
76121>>>>>>>            Move (Repeat(" ", 255)) To sSchemaName
76122>>>>>>>            Call_driver 0 sDriver Function CLI_TABLESCHEMA Callback 0 Passing sSchemaName sVoid iIndex Result iVoid
76127>>>>>>>        End
76127>>>>>>>>
76127>>>>>>>
76127>>>>>>>        Function_Return sSchemaName
76128>>>>>>>    End_Function // SchemaName
76129>>>>>>>
76129>>>>>>>
76129>>>>>>>
76129>>>>>>>    //***
76129>>>>>>>    //*** Function: TableType
76129>>>>>>>    //*** Purpose : Returns the type of the table enumerated at the given position.
76129>>>>>>>    //***           Types can be "TABLE", "VIEW", "SYSTEM TABLE", "GLOBAL TEMPORARY",
76129>>>>>>>    //***           "LOCAL TEMPORARY", "ALIAS", "SYNONYM"
76129>>>>>>>    //***
76129>>>>>>>
76129>>>>>>>    Function TableType Integer iIndex Returns String
76131>>>>>>>        Local String  sDriver
76131>>>>>>>        Local String  sTableType
76131>>>>>>>        Local String  sVoid
76131>>>>>>>        Local Integer iVoid
76131>>>>>>>
76131>>>>>>>        Get psDriverID To sDriver
76132>>>>>>>        If (sDriver <> "") Begin
76134>>>>>>>            Move (Repeat(" ", 25)) To sTableType
76135>>>>>>>            Call_driver 0 sDriver Function CLI_TABLETYPE Callback 0 Passing sTableType sVoid iIndex Result iVoid
76140>>>>>>>        End
76140>>>>>>>>
76140>>>>>>>
76140>>>>>>>        Function_Return sTableType
76141>>>>>>>    End_Function // TableType
76142>>>>>>>
76142>>>>>>>
76142>>>>>>>
76142>>>>>>>    //***
76142>>>>>>>    //*** Function: TableComment
76142>>>>>>>    //*** Purpose : Returns the comment of the table enumerated at the given position
76142>>>>>>>    //***
76142>>>>>>>
76142>>>>>>>    Function TableComment Integer iIndex Returns String
76144>>>>>>>        Local String  sDriver
76144>>>>>>>        Local String  sTableComment
76144>>>>>>>        Local String  sVoid
76144>>>>>>>        Local Integer iVoid
76144>>>>>>>
76144>>>>>>>        Get psDriverID To sDriver
76145>>>>>>>        If (sDriver <> "") Begin
76147>>>>>>>            Move (Repeat(" ", 255)) To sTableComment
76148>>>>>>>            Call_driver 0 sDriver Function CLI_TABLECOMMENT Callback 0 Passing sTableComment sVoid iIndex Result iVoid
76153>>>>>>>        End
76153>>>>>>>>
76153>>>>>>>
76153>>>>>>>        Function_Return sTableComment
76154>>>>>>>    End_Function // TableComment
76155>>>>>>>
76155>>>>>>>
76155>>>>>>>
76155>>>>>>>    //***
76155>>>>>>>    //*** Function: EnumerateColumns
76155>>>>>>>    //*** Purpose : Enumerate the columns in a table
76155>>>>>>>    //***
76155>>>>>>>
76155>>>>>>>    Function EnumerateColumns String sLogin String sTableName Returns Integer
76157>>>>>>>        Local String  sDriver
76157>>>>>>>        Local Integer iNumColumns
76157>>>>>>>        Local Integer iVoid
76157>>>>>>>
76157>>>>>>>        Get psDriverID To sDriver
76158>>>>>>>        If (sDriver <> "") ;            Call_driver 0 sDriver Function CLI_ENUMERATE_COLUMNS Callback 0 Passing sLogin sTablename iVoid Result iNumColumns
76165>>>>>>>
76165>>>>>>>        Function_Return iNumColumns
76166>>>>>>>    End_Function // EnumerateColumns
76167>>>>>>>
76167>>>>>>>
76167>>>>>>>
76167>>>>>>>    //***
76167>>>>>>>    //*** Function: ColumnName
76167>>>>>>>    //*** Purpose : Returns the name of the column enumerated at the given position
76167>>>>>>>    //***
76167>>>>>>>
76167>>>>>>>    Function ColumnName Integer iIndex Returns String
76169>>>>>>>        Local String  sDriver
76169>>>>>>>        Local String  sColumnName
76169>>>>>>>        Local String  sVoid
76169>>>>>>>        Local Integer iVoid
76169>>>>>>>
76169>>>>>>>        Get psDriverID To sDriver
76170>>>>>>>        If (sDriver <> "") Begin
76172>>>>>>>            Move (Repeat(" ", 255)) To sColumnName
76173>>>>>>>            Call_driver 0 sDriver Function CLI_COLUMNNAME Callback 0 Passing sColumnName sVoid iIndex Result iVoid
76178>>>>>>>        End
76178>>>>>>>>
76178>>>>>>>
76178>>>>>>>        Function_Return sColumnName
76179>>>>>>>    End_Function // ColumnName
76180>>>>>>>
76180>>>>>>>
76180>>>>>>>
76180>>>>>>>    //***
76180>>>>>>>    //*** Function: CLIDFDateToSQLDate
76180>>>>>>>    //*** Purpose : Convert a DataFlex date to a SQL date using the dummy zero date value.
76180>>>>>>>    //***
76180>>>>>>>
76180>>>>>>>    Function CLIDFDateToSQLDate String sDRiver Date dDFDate Returns String
76182>>>>>>>        Local String sSQLDate
76182>>>>>>>        Local Integer iOrgDateFmt
76182>>>>>>>        Local Integer iOrgDateSep
76182>>>>>>>
76182>>>>>>>        //*** Change date format to military, SQL dates are military dates
76182>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76185>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76188>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76191>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76194>>>>>>>
76194>>>>>>>        //*** We only need to convert if the date is 0
76194>>>>>>>        If (Integer(dDFDate = 0)) ;            CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sSQLDate
76203>>>>>>>        Else ;            Move dDFDate To sSQLDate
76205>>>>>>>
76205>>>>>>>        //*** Change date format back to original
76205>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76208>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76211>>>>>>>
76211>>>>>>>        Function_Return sSQLDate
76212>>>>>>>    End_Function // CLIDFDateToSQLDate
76213>>>>>>>
76213>>>>>>>
76213>>>>>>>
76213>>>>>>>    //***
76213>>>>>>>    //*** Function: CLISQLDateToDFDate
76213>>>>>>>    //*** Purpose : Convert a SQL date to a DataFlex date using the dummy zero date value.
76213>>>>>>>    //***
76213>>>>>>>
76213>>>>>>>    Function CLISQLDateToDFDate String sDRiver String sSQLDate Returns Date
76215>>>>>>>        Local Date dDFDate
76215>>>>>>>        Local String sDummyDateValue
76215>>>>>>>        Local Integer iOrgDateFmt
76215>>>>>>>        Local Integer iOrgDateSep
76215>>>>>>>
76215>>>>>>>        //*** Change date format to military, SQL dates are military dates
76215>>>>>>>        Get_Attribute DF_DATE_FORMAT To iOrgDateFmt
76218>>>>>>>        Get_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76221>>>>>>>        Set_Attribute DF_DATE_FORMAT To DF_DATE_MILITARY
76224>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To (Ascii('-'))
76227>>>>>>>
76227>>>>>>>        //*** We only need to convert if the date is the dummy zero date value
76227>>>>>>>        CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE To sDummyDateValue
76234>>>>>>>        If (sDummyDateValue = sSQLDate) ;            Move 0 To dDFDate
76237>>>>>>>        Else ;            Move sSQLDate To dDFDate
76239>>>>>>>
76239>>>>>>>        //*** Change date format back to original
76239>>>>>>>        Set_Attribute DF_DATE_FORMAT To iOrgDateFmt
76242>>>>>>>        Set_Attribute DF_DATE_SEPARATOR To iOrgDateSep
76245>>>>>>>
76245>>>>>>>        Function_Return dDFDate
76246>>>>>>>    End_Function // CLISQLDateToDFDate
76247>>>>>>>
76247>>>>>>>
76247>>>>>>>
76247>>>>>>>    //***
76247>>>>>>>    //*** Function: RedirectConnection
76247>>>>>>>    //*** Purpose : Redirect an exisitng connection. The existing connection
76247>>>>>>>    //***           will point to another database but all tables will stay
76247>>>>>>>    //***           open!
76247>>>>>>>    //***
76247>>>>>>>
76247>>>>>>>    Function RedirectConnection String sOldConnection String sNewConnection Returns Integer
76249>>>>>>>        Local String  sDriver
76249>>>>>>>        Local String  sVoid
76249>>>>>>>        Local Integer iResult
76249>>>>>>>        Local Integer iVoid
76249>>>>>>>
76249>>>>>>>        Get psDriverID To sDriver
76250>>>>>>>        If (sDriver <> "") Begin
76252>>>>>>>            Call_driver 0 sDriver Function CLI_REDIRECTCONNECTION Callback 0 Passing sOldConnection sNewConnection iVoid Result iResult
76257>>>>>>>        End
76257>>>>>>>>
76257>>>>>>>        Function_Return iResult
76258>>>>>>>    End_Function // RedirectConnect
76259>>>>>>>
76259>>>>>>>
76259>>>>>>>
76259>>>>>>>    //***
76259>>>>>>>    //*** Function: CreateConnectionID
76259>>>>>>>    //*** Purpose : Create a DataFlex side connection id that can be used later on.
76259>>>>>>>    //***
76259>>>>>>>
76259>>>>>>>    Function CreateConnectionID String sID String sConnStr Integer iOpt Returns Integer
76261>>>>>>>        Local String  sDriver
76261>>>>>>>        Local Integer iResult
76261>>>>>>>        Local Integer iOptions
76261>>>>>>>
76261>>>>>>>        Get psDriverID to sDriver
76262>>>>>>>        If (Num_Arguments = 2) ;            Move 0 to iOptions
76265>>>>>>>        Else ;            Move iOpt to iOptions
76267>>>>>>>        If (sDriver <> "") Begin
76269>>>>>>>            Call_Driver 0 sDriver Function CLI_CREATECONNECTIONID Callback 0 Passing sID sConnStr iOptions Result iResult
76274>>>>>>>        End
76274>>>>>>>>
76274>>>>>>>        Function_Return iResult
76275>>>>>>>    End_Function // CreateConnectionID
76276>>>>>>>
76276>>>>>>>
76276>>>>>>>
76276>>>>>>>    //***
76276>>>>>>>    //*** Function: DeleteConnectionID
76276>>>>>>>    //*** Purpose : Delete a DataFlex side connection id.
76276>>>>>>>    //***
76276>>>>>>>
76276>>>>>>>    Function DeleteConnectionID String sID Integer iIndex Returns Integer
76278>>>>>>>        Local String  sDriver
76278>>>>>>>        Local Integer iResult
76278>>>>>>>        Local String sVoid
76278>>>>>>>
76278>>>>>>>        Get psDriverID To sDriver
76279>>>>>>>        If (sDriver <> "") Begin
76281>>>>>>>            Call_Driver 0 sDriver Function CLI_DELETECONNECTIONID Callback 0 Passing sID sVoid iIndex Result iResult
76286>>>>>>>        End
76286>>>>>>>>
76286>>>>>>>        Function_Return iResult
76287>>>>>>>    End_Function // DeleteConnectionID
76288>>>>>>>
76288>>>>>>>End_Class // cCLIHandler
76289>>>>>
76289>>>>>//*** Global storage for results
76289>>>>>Integer SQLResult
76289>>>>>
76289>>>>>//*** Embedded SQL function constants
76289>>>>>Define FUNC_SQLCONNECT             For 1000000
76289>>>>>Define FUNC_SQLFILECONNECT         For 1000001
76289>>>>>Define FUNC_SQLDISCONNECT          For 1000002
76289>>>>>Define FUNC_SQLOPEN                For 1000003
76289>>>>>Define FUNC_SQLCLOSE               For 1000004
76289>>>>>Define FUNC_SQLPREPARE             For 1000005
76289>>>>>Define FUNC_SQLEXECUTE             For 1000006
76289>>>>>Define FUNC_SQLEXECDIRECT          For 1000007
76289>>>>>Define FUNC_SQLFETCH               For 1000008
76289>>>>>Define FUNC_SQLCOLUMNINFO          For 1000009
76289>>>>>Define FUNC_SQLCOLUMNVALUE         For 1000010
76289>>>>>Define FUNC_SQLBINDFILE            For 1000011
76289>>>>>Define FUNC_SQLGETDATA             For 1000012
76289>>>>>Define FUNC_SQLCOLSTRINGATTRIBLEN  For 1000013
76289>>>>>Define FUNC_SQLCOLSTRINGATTRIB     For 1000014
76289>>>>>Define FUNC_SQLCOLINTATTRIB        For 1000015
76289>>>>>Define FUNC_SQLSTMTINTATTRIB       For 1000016
76289>>>>>Define FUNC_SQLSETPROCNAME         For 1000017
76289>>>>>DEfine FUNC_SQLSETPROCARG          For 1000018
76289>>>>>Define FUNC_SQLCALL                For 1000019
76289>>>>>Define FUNC_SQLGETPROCARGLEN       For 1000020
76289>>>>>Define FUNC_SQLGETPROCARG          For 1000021
76289>>>>>Define FUNC_SQLGETPROCRETVALLEN    For 1000022
76289>>>>>Define FUNC_SQLGETPROCRETVAL       For 1000023
76289>>>>>Define FUNC_SQLNEXTRESULTSET       For 1000024
76289>>>>>Define FUNC_SQLBUFFERSTATUS        For 1000025
76289>>>>>Define FUNC_SQLSETPROCSCHEMA       For 1000026
76289>>>>>Define FUNC_SQLGETMESSAGE          For 1000027
76289>>>>>
76289>>>>>//*** Embedded SQL statement attribute constants
76289>>>>>Define SQLSTMTATTRIB_COLUMNCOUNT    For 1
76289>>>>>Define SQLSTMTATTRIB_ROWCOUNT       For 2
76289>>>>>Define SQLSTMTATTRIB_ROWCOUNT_TYPE  For 3
76289>>>>>Define SQLSTMTATTRIB_NUMMESSAGES    For 4
76289>>>>>
76289>>>>>//*** Embedded SQL column attribute constants
76289>>>>>Define SQLCOLATTRIB_SIZE           For 1
76289>>>>>Define SQLCOLATTRIB_LENGTH         For 1
76289>>>>>Define SQLCOLATTRIB_PRECISION      For 2
76289>>>>>Define SQLCOLATTRIB_LABEL          For 3
76289>>>>>Define SQLCOLATTRIB_BASECOLUMNNAME For 4
76289>>>>>Define SQLCOLATTRIB_BASETABLENAME  For 5
76289>>>>>Define SQLCOLATTRIB_SQLTYPE        For 6
76289>>>>>Define SQLCOLATTRIB_NULLABLE       For 7
76289>>>>>Define SQLCOLATTRIB_DFTYPE         For 8
76289>>>>>
76289>>>>>
76289>>>>>
76289>>>>>//*****************************************************************************
76289>>>>>//*** Class  : cSQLStatement                                                ***
76289>>>>>//*** Purpose: Statement object for embedded sql                            ***
76289>>>>>//***                                                                       ***
76289>>>>>//*** Description:                                                          ***
76289>>>>>//***   An object is created for each statement. These will be children     ***
76289>>>>>//***   of cSQLConnection objects which manage the create and destruction   ***
76289>>>>>//***   of these.                                                           ***
76289>>>>>//*****************************************************************************
76289>>>>>
76289>>>>>// Global variables holding last executed embedded SQL connection and statement handles.
76289>>>>>Integer giLastSQLhdbc
76289>>>>>Integer giLastSQLhstmt
76289>>>>>
76289>>>>>Move -1 to giLastSQLhdbc
76290>>>>>Move -1 to giLastSQLhstmt
76291>>>>>
76291>>>>>Struct tSQLColumn
76291>>>>>    Integer iSQLType
76291>>>>>    Integer iSQLSize
76291>>>>>    Integer iSQLPrecision
76291>>>>>    Integer iVariableDataType
76291>>>>>End_Struct
76291>>>>>
76291>>>>>Class cSQLStatement is a cObject
76292>>>>>
76292>>>>>    Procedure Construct_object 
76294>>>>>        Forward Send Construct_object 
76296>>>>>
76296>>>>>        Property Handle  phCLIStatementHandle   0
76297>>>>>        Property Handle  phCLIConnectionHandle  0
76298>>>>>        Property String  psDriverID             ""
76299>>>>>        
76299>>>>>        Property Integer piLastColumn      0
76300>>>>>        Property Integer piLastArgument    0
76301>>>>>        Property Integer piBindFile        0
76302>>>>>        Property Integer piColumnCount     0
76303>>>>>
76303>>>>>        // Allocated buffer for SQLColumnValue. 
76303>>>>>        // Allocated size is size of the largest (not variable length) column
76303>>>>>        Property String  psMaxColValue     ""
76304>>>>>
76304>>>>>        // True if there is at least 1 column with a variable length data type                 
76304>>>>>        Property Integer piHasVariableDataType  0
76305>>>>>
76305>>>>>        // Max size of buffer for variable length data. Default 16000        
76305>>>>>        Property Integer piMaxVariableBufferLength 16000  
76306>>>>>
76306>>>>>        // Allocated buffer for SQLGetData. 
76306>>>>>        Property String  psVariableBuffer  ""
76307>>>>>
76307>>>>>        // Allocated size of psVariableBuffer
76307>>>>>        Property Integer piVariableBufferLength 0
76308>>>>>
76308>>>>>        // Stores column properties of a result set.
76308>>>>>        Property tSQLColumn[] paSQLColumns
76309>>>>>        
76309>>>>>        // piFetchResult is set by SQLFetchRowValues and SQLFetchResultSetValues
76309>>>>>        //               0    = Fetch returned no data.
76309>>>>>        //               <> 0 = Row fetched
76309>>>>>        Property Integer piFetchResult     0
76310>>>>>
76310>>>>>
76310>>>>>        Property String psDummyZeroDate              '0001-01-01'
76311>>>>>        Property String psDummyZeroDateMssqlDatetime '1753-01-01'        
76312>>>>>
76312>>>>>    End_Procedure 
76313>>>>>
76313>>>>>    //***
76313>>>>>    //*** Procedure: StoreStatementInfo
76313>>>>>    //*** Purpose  : Store basic information about the statement.
76313>>>>>    //***
76313>>>>>    Procedure StoreStatementInfo Handle hCLIStatementHandle String sDrvrId Handle hCLIConnectionHandle
76315>>>>>        
76315>>>>>        Set phCLIStatementHandle   to hCLIStatementHandle
76316>>>>>        Set phCLIConnectionHandle  to hCLIConnectionHandle
76317>>>>>        Set psDriverID             to sDrvrId
76318>>>>>        
76318>>>>>    End_Procedure 
76319>>>>>
76319>>>>>
76319>>>>>    //***
76319>>>>>    //*** Procedure: DestroySQLStatement
76319>>>>>    //*** Purpose  : Destroy the cSQLStatement object
76319>>>>>    //***
76319>>>>>    Procedure DestroySQLStatement
76321>>>>>        Send Destroy
76322>>>>>    End_Procedure 
76323>>>>>
76323>>>>>    //***
76323>>>>>    //*** Procedure: HandleError
76323>>>>>    //*** Puprose  : Handle an error that has occured while checking properties.
76323>>>>>    //***
76323>>>>>
76323>>>>>    Procedure HandleError Integer ihstmt Integer ihdbc String sDrvrId String sOriginMsg
76325>>>>>        Integer iErrHandle
76325>>>>>        Integer iErrNum
76325>>>>>        String  sLocationInfo
76325>>>>>
76325>>>>>        //*** Get the DataFlex statement identifier
76325>>>>>        Move Self To iErrHandle
76326>>>>>
76326>>>>>        //*** Determine error number
76326>>>>>        If (ihstmt = 0) ;            Move CLIERR_SQLINVALID_CLI_STMT_HANDLE To iErrNum
76329>>>>>        Else If (ihdbc = 0) ;            Move CLIERR_SQLINVALID_CLI_CONN_HANDLE To iErrNum
76333>>>>>        Else If (sDrvrId = "") ;            Move CLIERR_SQLINVALID_DRIVER_ID To iErrNum
76337>>>>>        Else ;            Move CLIERR_SQL_ERROR To iErrNum
76339>>>>>
76339>>>>>        //*** Create location ifnormation
76339>>>>>        Move "[" To sLocationInfo
76340>>>>>        If (sOriginMsg <> "") Begin
76342>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
76343>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
76344>>>>>        End
76344>>>>>>
76344>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
76345>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
76346>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
76347>>>>>
76347>>>>>        //*** Generate the error
76347>>>>>        Error iErrNum sLocationInfo
76348>>>>>>
76348>>>>>    End_Procedure
76349>>>>>
76349>>>>>
76349>>>>>
76349>>>>>    //***
76349>>>>>    //*** Procedure: StmtError
76349>>>>>    //*** Purpose  : Handle general error not related to the properties
76349>>>>>    //***
76349>>>>>
76349>>>>>    Procedure StmtError Integer iErrNum String sErrText String sOriginMsg
76351>>>>>        Integer iErrHandle
76351>>>>>        String  sLocationInfo
76351>>>>>
76351>>>>>        //*** Get the DataFlex statement identifier
76351>>>>>        Move Self to iErrHandle
76352>>>>>
76352>>>>>        //*** Create location information
76352>>>>>        Move "[" To sLocationInfo
76353>>>>>        If (sOriginMsg <> "") Begin
76355>>>>>            Move (Append(sLocationInfo, sOriginMsg)) To sLocationInfo
76356>>>>>            Move (Append(sLocationInfo, ", "))       To sLocationInfo
76357>>>>>        End
76357>>>>>>
76357>>>>>        If (sErrtext <> "") Begin
76359>>>>>            Move (Append(sLocationInfo, sErrtext)) To sLocationInfo
76360>>>>>            Move (Append(sLocationInfo, ", "))     To sLocationInfo
76361>>>>>        End
76361>>>>>>
76361>>>>>        Move (Append(sLocationInfo, "DataFlex hstmt = ")) To sLocationInfo
76362>>>>>        Move (Append(sLocationInfo, iErrHandle))          To sLocationInfo
76363>>>>>        Move (Append(sLocationInfo, "]"))                 To sLocationInfo
76364>>>>>
76364>>>>>        //*** Generate the error
76364>>>>>        Error iErrNum sLocationInfo
76365>>>>>>
76365>>>>>    End_Procedure 
76366>>>>>
76366>>>>>
76366>>>>>
76366>>>>>    //***
76366>>>>>    //*** Procedure: SQLIllegalAttribute
76366>>>>>    //*** Purpose  : Handle an illegal attribute error
76366>>>>>    //***
76366>>>>>
76366>>>>>    Procedure SQLIllegalAttribute String sErrText String sOriginMsg
76368>>>>>        Integer bReport
76368>>>>>
76368>>>>>        Get_attribute DF_REPORT_UNSUPPORTED_ATTRIBUTES To bReport
76371>>>>>        If (bReport) ;            Send StmtError CLIERR_SQLINVALID_ATTRIBUTE sErrtext sOriginMsg
76374>>>>>    End_Procedure 
76375>>>>>
76375>>>>>
76375>>>>>
76375>>>>>    //***
76375>>>>>    //*** Function: SQLPrivateColumnIsLegal
76375>>>>>    //*** Purpose : Check if a column number is legal
76375>>>>>    //***
76375>>>>>
76375>>>>>    Function SQLPrivateColumnIsLegal Integer ihdbc String sDrvrId Integer ihstmt Integer iCol Returns Integer
76377>>>>>        Integer bLegal
76377>>>>>        Integer iNumColumns
76377>>>>>
76377>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
76378>>>>>        If (iCol > 0 And iCol <= iNumColumns) ;            Move DFTRUE To bLegal
76381>>>>>        Else ;            Move DFFALSE To bLegal
76383>>>>>
76383>>>>>        Function_Return bLegal
76384>>>>>    End_Function 
76385>>>>>
76385>>>>>
76385>>>>>
76385>>>>>    //***
76385>>>>>    //*** Procedure: SQLClose
76385>>>>>    //*** Purpose  : Close a statement and free all alllocated resources
76385>>>>>    //***
76385>>>>>
76385>>>>>    Procedure SQLClose
76387>>>>>        Integer ihdbc
76387>>>>>        Integer ihstmt
76387>>>>>        Integer iVoid
76387>>>>>        String  sDrvrId
76387>>>>>        String  sEmpty
76387>>>>>
76387>>>>>        //*** Initialize
76387>>>>>        Move "" To sEmpty
76388>>>>>
76388>>>>>        //*** Get the cli handles
76388>>>>>        Get phCLIStatementHandle  to ihstmt
76389>>>>>        Get phCLIConnectionHandle to ihdbc
76390>>>>>        Get psDriverId            to sDrvrId
76391>>>>>
76391>>>>>        //*** Free the CLI handle
76391>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
76393>>>>>            //*** Call the driver function to close
76393>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCLOSE ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
76398>>>>>
76398>>>>>            Move -1 to giLastSQLhstmt
76399>>>>>            //*** Free the DataFlex handle
76399>>>>>            Send DestroySQLStatement
76400>>>>>        End
76400>>>>>>
76400>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLClose"
76402>>>>>    End_Procedure
76403>>>>>
76403>>>>>
76403>>>>>
76403>>>>>    //***
76403>>>>>    //*** Procedure: SQLPrepare
76403>>>>>    //*** Purpose  : Prepare a statement for execution
76403>>>>>    //***
76403>>>>>
76403>>>>>    Procedure SQLPrepare String sStatement
76405>>>>>        Integer ihdbc
76405>>>>>        Integer ihstmt
76405>>>>>        Integer iVoid
76405>>>>>        String  sDrvrId
76405>>>>>
76405>>>>>        //*** Get the cli handles
76405>>>>>        Get phCLIStatementHandle  to ihstmt
76406>>>>>        Get phCLIConnectionHandle to ihdbc
76407>>>>>        Get psDriverId            to sDrvrId
76408>>>>>
76408>>>>>        //*** Prepare
76408>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
76410>>>>>            //*** Call the driver function to prepare
76410>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLPREPARE ;                        Callback Self ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
76415>>>>>        End
76415>>>>>>
76415>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrepare"
76417>>>>>    End_Procedure
76418>>>>>
76418>>>>>    Procedure SQLGetStatementAttributes
76420>>>>>        Integer ihdbc ihstmt iNumColumns iCol iMaxSize
76420>>>>>        String sMaxValue
76420>>>>>        tSQLColumn[] aSQLColumns
76420>>>>>        tSQLColumn[] aSQLColumns
76421>>>>>        
76421>>>>>        Integer iSqlType
76421>>>>>        Integer iSQLSize
76421>>>>>        Integer iSQLprecision
76421>>>>>        Integer iVariableDataType
76421>>>>>        
76421>>>>>        String  sDrvrId
76421>>>>>
76421>>>>>        Integer iHasVariableDataType
76421>>>>>
76421>>>>>        Move 0 to iHasVariableDataType
76422>>>>>
76422>>>>>
76422>>>>>        //*** Get the cli handles
76422>>>>>        Get phCLIStatementHandle  to ihstmt
76423>>>>>        Get phCLIConnectionHandle to ihdbc
76424>>>>>        Get psDriverId            to sDrvrId
76425>>>>>
76425>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt to iNumColumns
76426>>>>>        
76426>>>>>        Set piColumnCount to iNumColumns
76427>>>>>        
76427>>>>>        // Fill columns array
76427>>>>>        For iCol from 1 to iNumColumns
76433>>>>>>
76433>>>>>            Move 0 to iVariableDataType
76434>>>>>            
76434>>>>>            Get SQLPrivateColAttribute iCol SQLCOLATTRIB_SQLTYPE ihdbc sDrvrId ihstmt to iSQLType
76435>>>>>            Get SQLPrivateColAttribute iCol SQLCOLATTRIB_SIZE ihdbc sDrvrId ihstmt to iSQLSize
76436>>>>>            Get SQLPrivateColAttribute iCol SQLCOLATTRIB_PRECISION ihdbc sDrvrId ihstmt to iSQLPrecision
76437>>>>>            
76437>>>>>            If ( (iSQLType = SQL_LONGVARCHAR) or (iSQLType = SQL_WLONGVARCHAR) ) Begin
76439>>>>>                 // text type 
76439>>>>>                Move 1 to iVariableDataType
76440>>>>>            End
76440>>>>>>
76440>>>>>            Else Begin
76441>>>>>                If (sDrvrId = "MSSQLDRV") Begin
76443>>>>>                    // SQL Server varchar(max) and nvarchar(max) types return Size = 0                   
76443>>>>>                    If ( ((iSQLType = SQL_VARCHAR) and (iSQLSize = 0) ) or ;                         ((iSQLType = SQL_WVARCHAR) and (iSQLSize = 0) ) ) Begin
76445>>>>>                            
76445>>>>>                        Move 1 to iVariableDataType     
76446>>>>>                    End
76446>>>>>>
76446>>>>>                End
76446>>>>>>
76446>>>>>            End
76446>>>>>>
76446>>>>>
76446>>>>>            Move iSqlType           to aSQLColumns[iCol].iSQLType            
76447>>>>>            Move iSQLSize           to aSQLColumns[iCol].iSQLSize
76448>>>>>            Move iSQLPrecision      to aSQLColumns[iCol].iSQLPrecision
76449>>>>>            Move iVariableDataType  to aSQLColumns[iCol].iVariableDataType
76450>>>>>            
76450>>>>>            If (not(iVariableDataType)) Begin
76452>>>>>                If (iSQLSize > iMaxSize) Begin
76454>>>>>                    Move iSQLSize to iMaxSize
76455>>>>>                End
76455>>>>>>
76455>>>>>            End
76455>>>>>>
76455>>>>>            Else Begin
76456>>>>>                Move 1 to iHasVariableDataType
76457>>>>>            End
76457>>>>>>
76457>>>>>            
76457>>>>>        Loop
76458>>>>>>
76458>>>>>        
76458>>>>>        Move (Repeat(' ', iMaxSize + 3)) to sMaxValue
76459>>>>>        Set psMaxColValue to sMaxValue
76460>>>>>        
76460>>>>>        Set paSQLColumns   to aSQLColumns        
76461>>>>>        Set piHasVariableDataType to iHasVariableDataType
76462>>>>>        
76462>>>>>    End_Procedure
76463>>>>>
76463>>>>>    //***
76463>>>>>    //*** Procedure: SQLExecute
76463>>>>>    //*** Purpose  : Execute a prepared statement
76463>>>>>    //***
76463>>>>>
76463>>>>>    Procedure SQLExecute
76465>>>>>        Integer ihdbc
76465>>>>>        Integer ihstmt
76465>>>>>        Integer iVoid
76465>>>>>        String  sDrvrId
76465>>>>>        String  sEmpty
76465>>>>>
76465>>>>>        //*** Initialize
76465>>>>>        Move "" To sEmpty
76466>>>>>
76466>>>>>        //*** Get the cli handles
76466>>>>>        Get phCLIStatementHandle  to ihstmt
76467>>>>>        Get phCLIConnectionHandle to ihdbc
76468>>>>>        Get psDriverId            to sDrvrId
76469>>>>>
76469>>>>>        //*** Execute
76469>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
76471>>>>>            //*** Call the driver function to execute
76471>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECUTE ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
76476>>>>>            Send SQLGetStatementAttributes
76477>>>>>        End
76477>>>>>>
76477>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecute"
76479>>>>>    End_Procedure
76480>>>>>
76480>>>>>
76480>>>>>
76480>>>>>    //***
76480>>>>>    //*** Procedure: SQLExecDirect
76480>>>>>    //*** Purpose  : Prepare and execute a statement
76480>>>>>    //***
76480>>>>>
76480>>>>>    Procedure SQLExecDirect String sStatement
76482>>>>>        Integer ihdbc
76482>>>>>        Integer ihstmt
76482>>>>>        Integer iVoid
76482>>>>>        String  sDrvrId
76482>>>>>
76482>>>>>        //*** Get the cli handles
76482>>>>>        Get phCLIStatementHandle  to ihstmt
76483>>>>>        Get phCLIConnectionHandle to ihdbc
76484>>>>>        Get psDriverId            to sDrvrId
76485>>>>>
76485>>>>>        //*** ExecDirect
76485>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
76487>>>>>            //*** Call the driver function to execdirect
76487>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLEXECDIRECT ;                        Callback Self ;                        Passing ihdbc sStatement ihstmt ;                        Result iVoid
76492>>>>>            Send SQLGetStatementAttributes
76493>>>>>        End
76493>>>>>>
76493>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLExecDirect"
76495>>>>>    End_Procedure
76496>>>>>
76496>>>>>
76496>>>>>
76496>>>>>    //***
76496>>>>>    //*** Procedure: SQLFetch
76496>>>>>    //*** Purpose  : Fetch the next row
76496>>>>>    //*** Returns  : 0   = No more data
76496>>>>>    //***            <>0 = Success
76496>>>>>    //***
76496>>>>>    Function SQLFetch Returns Integer
76498>>>>>        Integer ihdbc
76498>>>>>        Integer ihstmt
76498>>>>>        Integer iResult
76498>>>>>        String  sDrvrId
76498>>>>>        String  sEmpty
76498>>>>>
76498>>>>>        //*** Initialize
76498>>>>>        Move "" To sEmpty
76499>>>>>        Move 0  To iResult
76500>>>>>
76500>>>>>        //*** Get the cli handles
76500>>>>>        Get phCLIStatementHandle  to ihstmt
76501>>>>>        Get phCLIConnectionHandle to ihdbc
76502>>>>>        Get psDriverId            to sDrvrId
76503>>>>>
76503>>>>>        //*** Fetch
76503>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
76505>>>>>            Indicate Err False
76506>>>>>
76506>>>>>            //*** Call the driver function to fetch
76506>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback Self Passing ihdbc sEmpty ihstmt Result iResult
76511>>>>>
76511>>>>>            //*** If something went wrong, adjust the result
76511>>>>>            If (Err) Move 0 to iResult
76514>>>>>
76514>>>>>            Set piLastcolumn To 0
76515>>>>>        End
76515>>>>>>
76515>>>>>        Else Send HandleError ihstmt ihdbc sDrvrId "SQLFetch"
76517>>>>>
76517>>>>>        Function_return iResult
76518>>>>>    End_Function
76519>>>>>
76519>>>>>
76519>>>>>    //***
76519>>>>>    //*** Procedure: SQLFetchRowValues
76519>>>>>    //*** Purpose  : Fetch the next row and return an array with all column values
76519>>>>>    //*** Returns  : Array of strings with all column values
76519>>>>>    //***            Sets piFetchResult property 
76519>>>>>    //***               0    = No more data
76519>>>>>    //***               <> 0 = Success
76519>>>>>    //***
76519>>>>>    Function SQLFetchRowValues Returns String[] 
76521>>>>>      
76521>>>>>        String[] asValues
76522>>>>>
76522>>>>>        tSQLColumn[] aSQLColumns        
76522>>>>>        tSQLColumn[] aSQLColumns        
76523>>>>>        
76523>>>>>        Integer ihdbc
76523>>>>>        Integer ihstmt
76523>>>>>        Integer iResult iVoid
76523>>>>>        Integer iColCount iCol
76523>>>>>        String  sDrvrId
76523>>>>>        String  sEmpty 
76523>>>>>        String  sResult
76523>>>>>        String  sVariableResult
76523>>>>>        Integer iHasVariableDataType
76523>>>>>        Integer iLen
76523>>>>>        Integer iVariableBufferLength
76523>>>>>
76523>>>>>        //*** Initialize
76523>>>>>        Move "" to sEmpty
76524>>>>>        Move 0  to iResult
76525>>>>>
76525>>>>>        //*** Get the cli handles
76525>>>>>        Get phCLIStatementHandle  to ihstmt
76526>>>>>        Get phCLIConnectionHandle to ihdbc
76527>>>>>        Get psDriverId            to sDrvrId
76528>>>>>        
76528>>>>>        Get paSQLColumns to aSQLColumns
76529>>>>>        Get piColumnCount to iColCount
76530>>>>>        Get piHasVariableDataType to iHasVariableDataType
76531>>>>>        
76531>>>>>        If (iHasVariableDataType) Begin
76533>>>>>            
76533>>>>>            Get piVariableBufferLength      to iVariableBufferLength
76534>>>>>            Get piMaxVariableBufferLength   to iLen
76535>>>>>            
76535>>>>>            If (iLen > iVariableBufferLength) Begin
76537>>>>>                //*** Allocate
76537>>>>>                Move (Repeat(' ', iLen)) to sVariableResult
76538>>>>>               
76538>>>>>                Set piVariableBufferLength to iLen
76539>>>>>                Set psVariableBuffer       to sVariableResult
76540>>>>>                
76540>>>>>                Get piVariableBufferLength to iVariableBufferLength                
76541>>>>>            End
76541>>>>>>
76541>>>>>        End
76541>>>>>>
76541>>>>>
76541>>>>>        //*** Fetch
76541>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
76543>>>>>            Move (False) to Err
76544>>>>>
76544>>>>>            // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
76544>>>>>            // in the next FUNC_SQLCOLUMNVALUE call.
76544>>>>>            // If hdbc and hstmt have not changed since the last call we don't have to set it.
76544>>>>>            If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
76546>>>>>                //*** Setup function arguments
76546>>>>>                Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO Callback 0 Passing ihdbc iCol ihstmt Result iVoid
76551>>>>>                Move ihstmt to giLastSQLhstmt
76552>>>>>                Move ihdbc to giLastSQLhdbc
76553>>>>>            End
76553>>>>>>
76553>>>>>
76553>>>>>            //*** Call the driver function to fetch
76553>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback 0 Passing ihdbc sEmpty ihstmt Result iResult
76558>>>>>
76558>>>>>            //*** If something went wrong, adjust the result
76558>>>>>            If (Err) Move 0 to iResult
76561>>>>>            
76561>>>>>            If (iResult) Begin
76563>>>>>                For iCol from 1 to iColCount
76569>>>>>>
76569>>>>>                    
76569>>>>>                    If (not(aSQLColumns[iCol].iVariableDataType)) Begin
76571>>>>>                        Get psMaxColValue to sResult
76572>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE Callback 0 Passing sResult sEmpty iCol Result iVoid
76577>>>>>
76577>>>>>                        Move sResult to asValues[iCol - 1]
76578>>>>>                    End
76578>>>>>>
76578>>>>>                    Else Begin
76579>>>>>                        Get psVariableBuffer       to sVariableResult
76580>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                    Callback 0 ;                                    Passing sVariableResult iCol iVariableBufferLength ;                                    Result iVoid
76585>>>>>                                    
76585>>>>>                        Move sVariableResult to asValues[iCol - 1]
76586>>>>>                    End
76586>>>>>>
76586>>>>>                    
76586>>>>>                Loop
76587>>>>>>
76587>>>>>            End
76587>>>>>>
76587>>>>>        End
76587>>>>>>
76587>>>>>        Else Begin    
76588>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLFetchRowValues"
76589>>>>>        End
76589>>>>>>
76589>>>>>
76589>>>>>        Set piFetchResult to iResult
76590>>>>>
76590>>>>>        Function_Return asValues
76591>>>>>        
76591>>>>>    End_Function 
76592>>>>>
76592>>>>>    //***
76592>>>>>    //*** Procedure: SQLFetchResultsetValues
76592>>>>>    //*** Purpose  : Fetch a complete result set. 
76592>>>>>    //*** Returns  : 2-dimensional array of strings with result set
76592>>>>>    //***            Sets piFetchResult property 
76592>>>>>    //***               0    = No more data
76592>>>>>    //***               <> 0 = Success
76592>>>>>    //***
76592>>>>>    Function SQLFetchResultsetValues Returns String[][] 
76594>>>>>        
76594>>>>>        String[][] asValues 
76595>>>>>        
76595>>>>>        Integer ihdbc ihstmt iResult iVoid iColCount iCol iRow
76595>>>>>        String sDrvrId sEmpty sResult sMax
76595>>>>>
76595>>>>>        tSQLColumn[] aSQLColumns        
76595>>>>>        tSQLColumn[] aSQLColumns        
76596>>>>>        String  sVariableResult
76596>>>>>        Integer iHasVariableDataType
76596>>>>>        Integer iLen
76596>>>>>        Integer iVariableBufferLength
76596>>>>>
76596>>>>>        //*** Initialize
76596>>>>>        Move "" to sEmpty
76597>>>>>        Move 0  to iResult
76598>>>>>
76598>>>>>        //*** Get the cli handles
76598>>>>>        Get phCLIStatementHandle  to ihstmt
76599>>>>>        Get phCLIConnectionHandle to ihdbc
76600>>>>>        Get psDriverId            to sDrvrId
76601>>>>>
76601>>>>>        //*** Fetch
76601>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
76603>>>>>            Indicate Err False
76604>>>>>            
76604>>>>>            // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
76604>>>>>            // in the next FUNC_SQLCOLUMNVALUE call.
76604>>>>>            // If hdbc and hstmt have not changed since the last call we don't have to set it.
76604>>>>>            If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
76606>>>>>                //*** Setup function arguments
76606>>>>>                Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO Callback 0 Passing ihdbc iCol ihstmt Result iVoid
76611>>>>>                Move ihstmt to giLastSQLhstmt
76612>>>>>                Move ihdbc to giLastSQLhdbc
76613>>>>>            End
76613>>>>>>
76613>>>>>
76613>>>>>
76613>>>>>            Get paSQLColumns to aSQLColumns
76614>>>>>            Get piColumnCount to iColCount
76615>>>>>            Get piHasVariableDataType to iHasVariableDataType
76616>>>>>            If (iHasVariableDataType) Begin
76618>>>>>                Get piVariableBufferLength      to iVariableBufferLength
76619>>>>>                Get piMaxVariableBufferLength   to iLen
76620>>>>>                If (iLen > iVariableBufferLength) Begin
76622>>>>>                    //*** Allocate
76622>>>>>                    Move (Repeat(' ', iLen)) to sVariableResult
76623>>>>>                   
76623>>>>>                    Set piVariableBufferLength to iLen
76624>>>>>                    Set psVariableBuffer       to sVariableResult
76625>>>>>                    
76625>>>>>                    Get piVariableBufferLength to iVariableBufferLength                
76626>>>>>                End
76626>>>>>>
76626>>>>>                Else Begin
76627>>>>>                   Set psVariableBuffer       to sVariableResult
76628>>>>>                End
76628>>>>>>
76628>>>>>            End
76628>>>>>>
76628>>>>>
76628>>>>>            Get psMaxColValue to sMax
76629>>>>>
76629>>>>>            //*** Call the driver function to fetch
76629>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback Self Passing ihdbc sEmpty ihstmt Result iResult
76634>>>>>            If (Err) Move 0 to iResult
76637>>>>>
76637>>>>>            While (iResult <> 0)
76641>>>>>
76641>>>>>                For iCol from 1 to (iColCount)
76647>>>>>>
76647>>>>>                    
76647>>>>>                    If (not(aSQLColumns[iCol].iVariableDataType)) Begin
76649>>>>>                        Move sMax to sResult
76650>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE ;                                    Callback 0 ;                                    Passing sResult sEmpty iCol ;                                    Result iVoid
76655>>>>>                        Move sResult to asValues[iRow][iCol - 1]
76656>>>>>                    End
76656>>>>>>
76656>>>>>                    Else Begin
76657>>>>>                        //Variable data    
76657>>>>>                        Move sVariableResult to sResult
76658>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                    Callback 0 ;                                    Passing sResult iCol iVariableBufferLength ;                                    Result iVoid
76663>>>>>                                    
76663>>>>>                        Move sResult to asValues[iRow][iCol - 1]
76664>>>>>                    End
76664>>>>>>
76664>>>>>                Loop
76665>>>>>>
76665>>>>>
76665>>>>>                Increment iRow
76666>>>>>
76666>>>>>                //*** Call the driver function to fetch
76666>>>>>                Call_Driver 0 sDrvrId Function FUNC_SQLFETCH Callback Self Passing ihdbc sEmpty ihstmt Result iResult
76671>>>>>                If (Err) Move 0 to iResult
76674>>>>>
76674>>>>>            Loop
76675>>>>>>
76675>>>>>
76675>>>>>        End
76675>>>>>>
76675>>>>>        Else Send HandleError ihstmt ihdbc sDrvrId "SQLFetchResultsetValues"
76677>>>>>
76677>>>>>        Set piFetchResult to iResult
76678>>>>>
76678>>>>>        Function_Return asValues
76679>>>>>    End_Function 
76680>>>>>
76680>>>>>
76680>>>>>
76680>>>>>    //***
76680>>>>>    //*** Function: SQLNextColumn
76680>>>>>    //*** Purpose : Get the next column
76680>>>>>    //***
76680>>>>>
76680>>>>>    Function SQLNextColumn Returns String
76682>>>>>        Integer iCol
76682>>>>>        String  sResult
76682>>>>>
76682>>>>>        Get piLastColumn To iCol
76683>>>>>        Increment iCol
76684>>>>>        Get SQLColumnValue iCol To sResult
76685>>>>>        Set piLastColumn To iCol
76686>>>>>
76686>>>>>        Function_return sResult
76687>>>>>    End_Function 
76688>>>>>
76688>>>>>
76688>>>>>    //***
76688>>>>>    //*** Function: SQLColumnType
76688>>>>>    //*** Purpose : Returns the native type of a column
76688>>>>>    //***
76688>>>>>    Function SQLColumnType Integer iCol Returns Integer
76690>>>>>        Integer ihdbc
76690>>>>>        Integer ihstmt
76690>>>>>        String  sDrvrId
76690>>>>>        Integer iSQLType
76690>>>>>        Integer iColumns
76690>>>>>        
76690>>>>>        tSQLColumn[] aSQLColumns
76690>>>>>        tSQLColumn[] aSQLColumns
76691>>>>>        
76691>>>>>        //*** Get the cli handles
76691>>>>>        Get phCLIStatementHandle  to ihstmt
76692>>>>>        Get phCLIConnectionHandle to ihdbc
76693>>>>>        Get psDriverId            to sDrvrId
76694>>>>>
76694>>>>>        //*** Get the value
76694>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
76696>>>>>        
76696>>>>>            Get paSQLColumns   to aSQLColumns        
76697>>>>>            Move (SizeOfArray(aSQLColumns)) to iColumns
76698>>>>>            
76698>>>>>            If (iCol >= 1 and iCol <= iColumns) Begin
76700>>>>>                Move aSQLColumns[iCol].iSQLType to iSQLType
76701>>>>>            End
76701>>>>>>
76701>>>>>            Else Begin
76702>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnType"        
76703>>>>>            End
76703>>>>>>
76703>>>>>        End
76703>>>>>>
76703>>>>>        Else Begin
76704>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnType"
76705>>>>>        End
76705>>>>>>
76705>>>>>
76705>>>>>        Function_Return iSQLType
76706>>>>>    End_Function 
76707>>>>>
76707>>>>>    //***
76707>>>>>    //*** Function: SQLColumnSize
76707>>>>>    //*** Purpose : Returns the size (max length) of a column
76707>>>>>    //***
76707>>>>>    Function SQLColumnSize Integer iCol Returns Integer
76709>>>>>        Integer ihdbc
76709>>>>>        Integer ihstmt
76709>>>>>        String  sDrvrId
76709>>>>>        Integer iSQLSize
76709>>>>>        Integer iColumns
76709>>>>>        
76709>>>>>        tSQLColumn[] aSQLColumns
76709>>>>>        tSQLColumn[] aSQLColumns
76710>>>>>        
76710>>>>>        //*** Get the cli handles
76710>>>>>        Get phCLIStatementHandle  to ihstmt
76711>>>>>        Get phCLIConnectionHandle to ihdbc
76712>>>>>        Get psDriverId            to sDrvrId
76713>>>>>
76713>>>>>        //*** Get the value
76713>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
76715>>>>>        
76715>>>>>            Get paSQLColumns   to aSQLColumns        
76716>>>>>            Move (SizeOfArray(aSQLColumns)) to iColumns
76717>>>>>            
76717>>>>>            If (iCol >= 1 and iCol <= iColumns) Begin
76719>>>>>                Move aSQLColumns[iCol].iSQLSize to iSQLSize
76720>>>>>            End
76720>>>>>>
76720>>>>>            Else Begin
76721>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnSize"        
76722>>>>>            End
76722>>>>>>
76722>>>>>        End
76722>>>>>>
76722>>>>>        Else Begin
76723>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnSize"
76724>>>>>        End
76724>>>>>>
76724>>>>>
76724>>>>>        Function_Return iSQLSize
76725>>>>>    End_Function 
76726>>>>>
76726>>>>>    //***
76726>>>>>    //*** Function: SQLColumnVariableDatatype
76726>>>>>    //*** Purpose : Returns 1 for variable length datatypes. 
76726>>>>>    //***           For example SQL Server varchar(max) or text type
76726>>>>>    //***           The data of variable length datatype columns should be retrieved with SQLGetData 
76726>>>>>    Function SQLColumnVariableDatatype Integer iCol Returns Integer
76728>>>>>        Integer ihdbc
76728>>>>>        Integer ihstmt
76728>>>>>        String  sDrvrId
76728>>>>>        Integer iVariableDataType
76728>>>>>        Integer iColumns
76728>>>>>        
76728>>>>>        tSQLColumn[] aSQLColumns
76728>>>>>        tSQLColumn[] aSQLColumns
76729>>>>>        
76729>>>>>        //*** Get the cli handles
76729>>>>>        Get phCLIStatementHandle  to ihstmt
76730>>>>>        Get phCLIConnectionHandle to ihdbc
76731>>>>>        Get psDriverId            to sDrvrId
76732>>>>>
76732>>>>>        //*** Get the value
76732>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
76734>>>>>        
76734>>>>>            Get paSQLColumns   to aSQLColumns        
76735>>>>>            Move (SizeOfArray(aSQLColumns)) to iColumns
76736>>>>>            
76736>>>>>            If (iCol >= 1 and iCol <= iColumns) Begin
76738>>>>>                Move aSQLColumns[iCol].iVariableDataType to iVariableDataType
76739>>>>>            End
76739>>>>>>
76739>>>>>            Else Begin
76740>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnVariableDatatype"        
76741>>>>>            End
76741>>>>>>
76741>>>>>        End
76741>>>>>>
76741>>>>>        Else Begin
76742>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLColumnVariableDatatype"
76743>>>>>        End
76743>>>>>>
76743>>>>>
76743>>>>>        Function_Return iVariableDataType
76744>>>>>    End_Function 
76745>>>>>
76745>>>>>
76745>>>>>
76745>>>>>
76745>>>>>    //***
76745>>>>>    //*** Function: SQLColumnValue
76745>>>>>    //*** Purpose : Return the value of a column in a fetched row of a given
76745>>>>>    //***           statement.
76745>>>>>    //***
76745>>>>>    Function SQLColumnValue Integer iCol Returns String
76747>>>>>        Integer ihdbc
76747>>>>>        Integer ihstmt
76747>>>>>        String  sDrvrId
76747>>>>>        String  sResult
76747>>>>>
76747>>>>>        Integer iVoid
76747>>>>>        Integer iColSize
76747>>>>>        Integer iColPrecision
76747>>>>>        String  sEmpty
76747>>>>>        Integer bLegalColumn
76747>>>>>
76747>>>>>        //*** Initialize
76747>>>>>        Move "" To sResult
76748>>>>>
76748>>>>>        //*** Get the cli handles
76748>>>>>        Get phCLIStatementHandle  to ihstmt
76749>>>>>        Get phCLIConnectionHandle to ihdbc
76750>>>>>        Get psDriverId            to sDrvrId
76751>>>>>
76751>>>>>        // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
76751>>>>>        // in the next FUNC_SQLCOLUMNVALUE call.
76751>>>>>        // If hdbc and hstmt have not changed since the last call we don't have to set it.
76751>>>>>        If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
76753>>>>>            //*** Setup function arguments
76753>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback 0 ;                        Passing ihdbc iCol ihstmt ;                        Result iVoid
76758>>>>>            Move ihstmt to giLastSQLhstmt
76759>>>>>            Move ihdbc to giLastSQLhdbc
76760>>>>>        End
76760>>>>>>
76760>>>>>
76760>>>>>        If (iCol >= 1 and iCol <= piColumnCount(Self)) Begin
76762>>>>>            Get psMaxColValue to sResult
76763>>>>>            //*** Call the driver function to get the value
76763>>>>>            Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNVALUE ;                        Callback 0 ;                        Passing sResult sEmpty iCol ;                        Result iVoid
76768>>>>>        End
76768>>>>>>
76768>>>>>        Else Begin
76769>>>>>            Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLColumnValue"
76770>>>>>        End
76770>>>>>>
76770>>>>>
76770>>>>>        Function_Return sResult
76771>>>>>        
76771>>>>>    End_Function
76772>>>>>
76772>>>>>
76772>>>>>
76772>>>>>    //***
76772>>>>>    //*** Procedure: SQLBindFile
76772>>>>>    //*** Purpose  : Add a file to the files used to place the statement result in.
76772>>>>>    //***
76772>>>>>
76772>>>>>    Procedure SQLBindFile Integer iFileNum
76774>>>>>        Integer ihdbc
76774>>>>>        Integer ihstmt
76774>>>>>        Integer iVoid
76774>>>>>        String  sDrvrId
76774>>>>>        String  sFileType
76774>>>>>        Integer bIsOpen
76774>>>>>
76774>>>>>        //*** Get the cli handles
76774>>>>>        Get phCLIStatementHandle  to ihstmt
76775>>>>>        Get phCLIConnectionHandle to ihdbc
76776>>>>>        Get psDriverId            to sDrvrId
76777>>>>>
76777>>>>>        //*** If a file number is not passed see if we can use the statement's
76777>>>>>        //*** default file number which is usually set with SetFileConnection
76777>>>>>        If (iFileNum = 0) Begin
76779>>>>>            Get piBindFile To iFileNum
76780>>>>>            If (iFileNum = 0) Begin
76782>>>>>                //*** Logic error, if 0 is passed as filenumber, piBindFile should be set.
76782>>>>>                Send StmtError CLIERR_SQLINVALID_BIND_FILE "piBindFile should be set" "SQLBindFile"
76783>>>>>
76783>>>>>                Move 0 to SQLResult
76784>>>>>                Procedure_Return
76785>>>>>            End
76785>>>>>>
76785>>>>>        End
76785>>>>>>
76785>>>>>
76785>>>>>        //*** Bind the file
76785>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
76787>>>>>            //*** Chek if the file is open
76787>>>>>            Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
76790>>>>>            If (bIsOpen) Begin
76792>>>>>                //*** Check if the file has the correct type
76792>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
76795>>>>>                If (sFileType = sDrvrId) Begin
76797>>>>>                    //*** Call the driver function to add a file to a statement
76797>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLBINDFILE ;                                Callback Self ;                                Passing ihdbc iFileNum ihstmt ;                                Result iVoid
76802>>>>>                End
76802>>>>>>
76802>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
76804>>>>>            End
76804>>>>>>
76804>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File not open (number =" * String(iFileNum) + ")") "SQLBindFile"
76806>>>>>        End
76806>>>>>>
76806>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLBindFile"
76808>>>>>    End_Procedure 
76809>>>>>
76809>>>>>
76809>>>>>
76809>>>>>    //*************************************************************************
76809>>>>>    //*** Function: SQLGetData                                              ***
76809>>>>>    //*** Purpose : Get data of a column.                                   ***
76809>>>>>    //*************************************************************************
76809>>>>>
76809>>>>>    Function SQLGetData Integer iCol Integer iLen Returns String
76811>>>>>        Integer ihdbc
76811>>>>>        Integer ihstmt
76811>>>>>        Integer iVoid
76811>>>>>        Integer iColSize
76811>>>>>        Integer iResult
76811>>>>>        String  sDrvrId
76811>>>>>        String  sResult
76811>>>>>        String  sEmpty
76811>>>>>        Integer bLegalColumn
76811>>>>>        
76811>>>>>        Integer iVariableBufferLength
76811>>>>>
76811>>>>>        //*** Initialize
76811>>>>>        Move "" To sEmpty
76812>>>>>        Move 0 To iResult
76813>>>>>
76813>>>>>        //*** Get the cli handles
76813>>>>>        Get phCLIStatementHandle  to ihstmt
76814>>>>>        Get phCLIConnectionHandle to ihdbc
76815>>>>>        Get psDriverId            to sDrvrId
76816>>>>>
76816>>>>>        //*** Get the data
76816>>>>>        If (ihstmt <> 0 and ihdbc <> 0 and sDrvrId <> "") Begin
76818>>>>>            //*** Check if the column exists
76818>>>>>            If (iCol >= 1 and iCol <= piColumnCount(Self)) Begin
76820>>>>>                If (iLen = 0) Begin
76822>>>>>                    Get SQLColumnValue iCol to sResult
76823>>>>>                End
76823>>>>>>
76823>>>>>                Else Begin
76824>>>>>                    // Add 1 for string terminator
76824>>>>>                    Move (iLen + 1) to iLen
76825>>>>>
76825>>>>>                    Get piVariableBufferLength to iVariableBufferLength
76826>>>>>                    If (iLen > iVariableBufferLength) Begin
76828>>>>>                        //*** Allocate
76828>>>>>                        Move (Repeat(' ', iLen)) to sResult
76829>>>>>                       
76829>>>>>                        Set piVariableBufferLength to iLen
76830>>>>>                        Set psVariableBuffer       to sResult
76831>>>>>                    End
76831>>>>>>
76831>>>>>                    Else Begin
76832>>>>>                        Get psVariableBuffer       to sResult
76833>>>>>                    End
76833>>>>>>
76833>>>>>
76833>>>>>
76833>>>>>                    // FUNC_SQLCOLUMNINFO will tell the driver which hdbc and hstmt to use 
76833>>>>>                    // in the next FUNC_SQLCOLUMNVALUE call.
76833>>>>>                    // If hdbc and hstmt have not changed since the last call we don't have to set it.
76833>>>>>                    If (ihstmt <> giLastSQLhstmt or ihdbc <> giLastSQLhdbc) Begin
76835>>>>>                        //*** Setup function arguments
76835>>>>>                        Call_Driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                    Callback 0 ;                                    Passing ihdbc iCol ihstmt ;                                    Result iVoid
76840>>>>>                        Move ihstmt to giLastSQLhstmt
76841>>>>>                        Move ihdbc to giLastSQLhdbc
76842>>>>>                    End
76842>>>>>>
76842>>>>>
76842>>>>>                    Indicate Err False
76843>>>>>                    //*** Call the driver function to get the data
76843>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLGETDATA ;                                Callback Self ;                                Passing sResult iCol iLen ;                                Result iResult
76848>>>>>
76848>>>>>                    //*** If something went wrong, adjust the result
76848>>>>>                    If (Err) Begin
76850>>>>>                        Move 0 to iResult
76851>>>>>                    End
76851>>>>>>
76851>>>>>                End
76851>>>>>>
76851>>>>>            End
76851>>>>>>
76851>>>>>            Else Begin
76852>>>>>                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLGetData"
76853>>>>>            End
76853>>>>>>
76853>>>>>        End
76853>>>>>>
76853>>>>>        Else Begin
76854>>>>>            Send HandleError ihstmt ihdbc sDrvrId "SQLGetData"
76855>>>>>        End
76855>>>>>>
76855>>>>>
76855>>>>>        //*** Fill global result
76855>>>>>        Move iResult To SQLResult
76856>>>>>
76856>>>>>        Function_Return sResult
76857>>>>>    End_Function 
76858>>>>>
76858>>>>>
76858>>>>>
76858>>>>>    //***
76858>>>>>    //*** Function: SQLColumnMap
76858>>>>>    //*** Purpose : Map a column name to a number, if the name id not found no
76858>>>>>    //***           error is generated the returned number will be 0 (zero) in
76858>>>>>    //***           that case
76858>>>>>    //***
76858>>>>>
76858>>>>>    Function SQLColumnMap String sColname Returns Integer
76860>>>>>        Integer ihdbc
76860>>>>>        Integer ihstmt
76860>>>>>        Integer iNumColumns
76860>>>>>        Integer iColCount
76860>>>>>        Integer iColNum
76860>>>>>        String  sDrvrId
76860>>>>>        String  sCurColName
76860>>>>>
76860>>>>>        //*** Get the cli handles
76860>>>>>        Get phCLIStatementHandle  to ihstmt
76861>>>>>        Get phCLIConnectionHandle to ihdbc
76862>>>>>        Get psDriverId            to sDrvrId
76863>>>>>
76863>>>>>        //*** Get the number by looping through the column names
76863>>>>>        Move 0 To iColNum
76864>>>>>        Get SQLPrivateStmtAttribute SQLSTMTATTRIB_COLUMNCOUNT ihdbc sDrvrId ihstmt To iNumColumns
76865>>>>>        For iColCount From 1 To iNumColumns
76871>>>>>>
76871>>>>>            Get SQLPrivateColAttribute iColCount SQLCOLATTRIB_LABEL ihdbc sDrvrId ihstmt To sCurColName
76872>>>>>            If (Uppercase(Trim(sColName)) = Uppercase(Trim(sCurColName))) ;                Move iColCount To iColNum
76875>>>>>
76875>>>>>            If (iColNum) ;                Break
76878>>>>>        Loop
76879>>>>>>
76879>>>>>
76879>>>>>        Function_return iColNum
76880>>>>>    End_Function 
76881>>>>>
76881>>>>>
76881>>>>>
76881>>>>>    //***
76881>>>>>    //*** Function: SQLStmtAttribute
76881>>>>>    //*** Purpose : Get a statement attribute
76881>>>>>    //***
76881>>>>>
76881>>>>>    Function SQLStmtAttribute Integer iAttribId Returns String
76883>>>>>        Integer ihdbc
76883>>>>>        Integer ihstmt
76883>>>>>        String  sResult
76883>>>>>        String  sDrvrId
76883>>>>>
76883>>>>>        //*** Initialize
76883>>>>>        Move "" To sResult
76884>>>>>
76884>>>>>        //*** Get the cli handles
76884>>>>>        Get phCLIStatementHandle  to ihstmt
76885>>>>>        Get phCLIConnectionHandle to ihdbc
76886>>>>>        Get psDriverId            to sDrvrId
76887>>>>>
76887>>>>>        //*** Get the attribute
76887>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateStmtAttribute iAttribId ihdbc sDrvrId ihstmt To sResult
76890>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLStmtAttribute"
76892>>>>>
76892>>>>>        Function_Return sResult
76893>>>>>    End_Function 
76894>>>>>
76894>>>>>    Function SQLPrivateStmtAttribute Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
76896>>>>>        String  sResult
76896>>>>>        Integer iLen
76896>>>>>        Integer bLegalAttrib
76896>>>>>
76896>>>>>        //*** Initialize
76896>>>>>        Move ""     To sResult
76897>>>>>
76897>>>>>        //*** Get the attribute
76897>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
76899>>>>>            Case Begin
76899>>>>>                Case (iAttribId = SQLSTMTATTRIB_COLUMNCOUNT)
76901>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT)
76904>>>>>                Case (iAttribId = SQLSTMTATTRIB_ROWCOUNT_TYPE)
76907>>>>>                Case (iAttribId = SQLSTMTATTRIB_NUMMESSAGES)
76910>>>>>                    Move DFTRUE To bLegalAttrib
76911>>>>>                    Break
76912>>>>>
76912>>>>>                Case Else
76912>>>>>                    Move DFFALSE To bLegalAttrib
76913>>>>>                    Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateStmtAttribute"
76914>>>>>            Case End
76914>>>>>
76914>>>>>            If (bLegalAttrib) Begin
76916>>>>>                //*** Setup function arguments
76916>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLSTMTINTATTRIB ;                            Callback Self ;                            Passing ihdbc iAttribId ihstmt ;                            Result sResult
76921>>>>>            End
76921>>>>>>
76921>>>>>        End
76921>>>>>>
76921>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateStmtAttribute"
76923>>>>>
76923>>>>>        Function_Return sResult
76924>>>>>    End_Function 
76925>>>>>
76925>>>>>
76925>>>>>
76925>>>>>    //***
76925>>>>>    //*** Function: SQLColAttribute
76925>>>>>    //*** Purpose : Get a column's attribute
76925>>>>>    //***
76925>>>>>
76925>>>>>    Function SQLColAttribute Integer iCol Integer iAttribId Returns String
76927>>>>>        Integer ihdbc
76927>>>>>        Integer ihstmt
76927>>>>>        String  sResult
76927>>>>>        String  sDrvrId
76927>>>>>
76927>>>>>        //*** Initialize
76927>>>>>        Move "" To sResult
76928>>>>>
76928>>>>>        //*** Get the cli handles
76928>>>>>        Get phCLIStatementHandle  to ihstmt
76929>>>>>        Get phCLIConnectionHandle to ihdbc
76930>>>>>        Get psDriverId            to sDrvrId
76931>>>>>
76931>>>>>        //*** Get the attribute
76931>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") ;            Get SQLPrivateColAttribute iCol iAttribId ihdbc sDrvrId ihstmt To sResult
76934>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLColAttribute"
76936>>>>>
76936>>>>>        Function_Return sResult
76937>>>>>    End_Function 
76938>>>>>
76938>>>>>    Function SQLPrivateColAttribute Integer iCol Integer iAttribId Integer ihdbc String sDrvrId Integer ihstmt Returns String
76940>>>>>        String  sResult
76940>>>>>        String  sEmpty
76940>>>>>        Integer bIsStringAttribute
76940>>>>>        Integer iLen
76940>>>>>        Integer iVoid
76940>>>>>        Integer bLegalAttrib
76940>>>>>        Integer bLegalColumn
76940>>>>>
76940>>>>>        //*** Initialize
76940>>>>>        Move "" To sResult
76941>>>>>        Move "" To sEmpty
76942>>>>>        MOve 0  To iLen
76943>>>>>
76943>>>>>        //*** Get the attribute
76943>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
76945>>>>>            Get SQLPrivateColumnIsLegal ihdbc sDrvrId ihstmt iCol To bLegalColumn
76946>>>>>            If (bLegalColumn) Begin
76948>>>>>                //*** Determine the atributes type
76948>>>>>                Case Begin
76948>>>>>                    Case (iAttribId = SQLCOLATTRIB_SIZE)
76950>>>>>                    Case (iAttribId = SQLCOLATTRIB_LENGTH)
76953>>>>>                    Case (iAttribId = SQLCOLATTRIB_PRECISION)
76956>>>>>                    Case (iAttribId = SQLCOLATTRIB_SQLTYPE)
76959>>>>>                    Case (iAttribId = SQLCOLATTRIB_NULLABLE)
76962>>>>>                    Case (iAttribId = SQLCOLATTRIB_DFTYPE)
76965>>>>>                        Move DFFALSE To bIsStringAttribute
76966>>>>>                        Move DFTRUE To bLegalAttrib
76967>>>>>                        Break
76968>>>>>
76968>>>>>                    Case (iAttribId = SQLCOLATTRIB_LABEL)
76971>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASECOLUMNNAME)
76974>>>>>                    Case (iAttribId = SQLCOLATTRIB_BASETABLENAME)
76977>>>>>                        Move DFTRUE To bIsStringAttribute
76978>>>>>                        Move DFTRUE To bLegalAttrib
76979>>>>>                        Break
76980>>>>>
76980>>>>>                    Case Else
76980>>>>>                        Move DFFALSE To bLegalAttrib
76981>>>>>                        Send SQLIllegalAttribute ("Attribute is = " + String(iAttribId) + ")") "SQLPrivateColAttribute"
76982>>>>>                Case End
76982>>>>>
76982>>>>>                If (bLegalAttrib) Begin
76984>>>>>                    //*** Setup function arguments
76984>>>>>                    Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                                Callback Self ;                                Passing ihdbc iCol ihstmt ;                                Result iVoid
76989>>>>>
76989>>>>>                    If (bIsStringAttribute) Begin
76991>>>>>                        //*** Call the driver function to get the data length
76991>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIBLEN ;                                    Callback Self ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result iLen
76996>>>>>
76996>>>>>                        If (iLen) Begin
76998>>>>>                            //*** Allocate
76998>>>>>                            Move (Repeat(' ', iLen)) To sResult
76999>>>>>
76999>>>>>                            //*** Call the driver function to get the name
76999>>>>>                            Call_driver 0 sDrvrId Function FUNC_SQLCOLSTRINGATTRIB ;                                        Callback Self ;                                        Passing sResult sEmpty iAttribId ;                                        Result iVoid
77004>>>>>                        End
77004>>>>>>
77004>>>>>                    End
77004>>>>>>
77004>>>>>                    Else Begin
77005>>>>>                        //*** get the attribute
77005>>>>>                        Call_driver 0 sDrvrId Function FUNC_SQLCOLINTATTRIB ;                                    Callback Self ;                                    Passing sEmpty sEmpty iAttribId ;                                    Result sResult
77010>>>>>                    End
77010>>>>>>
77010>>>>>                End
77010>>>>>>
77010>>>>>            End
77010>>>>>>
77010>>>>>            Else ;                Send StmtError CLIERR_SQLINVALID_COLUMN ("(Column number = " + String(iCol) + ")") "SQLPrivateColAttribute"
77012>>>>>        End
77012>>>>>>
77012>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLPrivateColAttribute"
77014>>>>>
77014>>>>>        Function_Return sResult
77015>>>>>    End_Function 
77016>>>>>
77016>>>>>
77016>>>>>
77016>>>>>    //***
77016>>>>>    //*** Procedure: SQLSetProcedureName
77016>>>>>    //*** Purpsoe  : Preapre for calling a stored procedure, pass the procedure name.
77016>>>>>    //***
77016>>>>>
77016>>>>>    Procedure SQLSetProcedureName String sProcName String sSchemaArg
77018>>>>>        Integer ihdbc
77018>>>>>        Integer ihstmt
77018>>>>>        String  sDrvrId
77018>>>>>        Integer iVoid
77018>>>>>        String  sSchema
77018>>>>>        String  sEmpty
77018>>>>>
77018>>>>>        //*** Initialize
77018>>>>>        Move "" To sEmpty
77019>>>>>
77019>>>>>        //*** Get the cli handles
77019>>>>>        Get phCLIStatementHandle  to ihstmt
77020>>>>>        Get phCLIConnectionHandle to ihdbc
77021>>>>>        Get psDriverId            to sDrvrId
77022>>>>>
77022>>>>>        //*** Call the procedure
77022>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77024>>>>>            If (Num_Arguments >= 2) ;                Move sSchemaArg To sSchema
77027>>>>>            Else ;                Move "" To sSchema
77029>>>>>
77029>>>>>            If (sSchema <> "") Begin
77031>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLSETPROCSCHEMA ;                            Callback Self ;                            Passing ihdbc sSchema ihstmt ;                            Result iVoid
77036>>>>>            End
77036>>>>>>
77036>>>>>
77036>>>>>            //*** Call the procedure
77036>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCNAME ;                        Callback Self ;                        Passing ihdbc sProcName ihstmt ;                        Result iVoid
77041>>>>>
77041>>>>>            Set piLastArgument To 0
77042>>>>>        End
77042>>>>>>
77042>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetProcedurename"
77044>>>>>    End_Procedure 
77045>>>>>
77045>>>>>
77045>>>>>
77045>>>>>    //***
77045>>>>>    //*** Function: SQLSetNextArgument
77045>>>>>    //*** Purpose : Pass the next argument
77045>>>>>    //***
77045>>>>>
77045>>>>>    Procedure SQLSetNextArgument String sArgument
77047>>>>>        Integer iArgnum
77047>>>>>
77047>>>>>        Get piLastArgument To iArgnum
77048>>>>>        Increment iArgnum
77049>>>>>        Send SQLSetArgument iArgnum sArgument
77050>>>>>        Set piLastArgument To iArgnum
77051>>>>>    End_Procedure 
77052>>>>>
77052>>>>>
77052>>>>>
77052>>>>>    //***
77052>>>>>    //*** Procedure: SQLSetArgument
77052>>>>>    //*** Purpose  : Set the next argument
77052>>>>>    //***
77052>>>>>
77052>>>>>    Procedure SQLSetArgument Integer iArgnum String sArgument
77054>>>>>        Integer ihdbc
77054>>>>>        Integer ihstmt
77054>>>>>        String  sDrvrId
77054>>>>>        Integer iVoid
77054>>>>>        String  sEmpty
77054>>>>>
77054>>>>>        //*** Initialize
77054>>>>>        Move "" To sEmpty
77055>>>>>
77055>>>>>        //*** Get the cli handles
77055>>>>>        Get phCLIStatementHandle  to ihstmt
77056>>>>>        Get phCLIConnectionHandle to ihdbc
77057>>>>>        Get psDriverId            to sDrvrId
77058>>>>>
77058>>>>>        //*** Call the procedure
77058>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77060>>>>>            //*** Pass the information
77060>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Self ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
77065>>>>>
77065>>>>>            //*** Pass the argument
77065>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLSETPROCARG ;                        Callback Self ;                        Passing sArgument sEmpty 0 ;                        Result iVoid
77070>>>>>        End
77070>>>>>>
77070>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLSetArgument"
77072>>>>>    End_Procedure
77073>>>>>
77073>>>>>
77073>>>>>
77073>>>>>    //***
77073>>>>>    //*** Procedure: SQLCall
77073>>>>>    //*** Purpose  : Call a stored procedure
77073>>>>>    //***
77073>>>>>
77073>>>>>    Procedure SQLCall
77075>>>>>        Integer ihdbc
77075>>>>>        Integer ihstmt
77075>>>>>        String  sDrvrId
77075>>>>>        Integer iVoid
77075>>>>>        String  sEmpty
77075>>>>>
77075>>>>>        //*** Initialize
77075>>>>>        Move "" To sEmpty
77076>>>>>
77076>>>>>        //*** Get the cli handles
77076>>>>>        Get phCLIStatementHandle  to ihstmt
77077>>>>>        Get phCLIConnectionHandle to ihdbc
77078>>>>>        Get psDriverId            to sDrvrId
77079>>>>>
77079>>>>>        //*** Call the procedure
77079>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77081>>>>>            //*** Call the procedure
77081>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCALL ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt ;                        Result iVoid
77086>>>>>                        
77086>>>>>            Send SQLGetStatementAttributes
77087>>>>>            Set piLastArgument To 0
77088>>>>>        End
77088>>>>>>
77088>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLCall"
77090>>>>>    End_Procedure 
77091>>>>>
77091>>>>>
77091>>>>>
77091>>>>>    //***
77091>>>>>    //*** Function: SQLGetNextArgument
77091>>>>>    //*** Purpose : Get the next argument
77091>>>>>    //***
77091>>>>>
77091>>>>>    Function SQLGetNextArgument Returns String
77093>>>>>        Integer iArgnum
77093>>>>>        String  sResult
77093>>>>>
77093>>>>>        Get piLastArgument To iArgnum
77094>>>>>        Increment iArgnum
77095>>>>>        Get SQLGetArgument iArgnum To sResult
77096>>>>>        Set piLastArgument To iArgnum
77097>>>>>
77097>>>>>        Function_return sResult
77098>>>>>    End_Function 
77099>>>>>
77099>>>>>
77099>>>>>
77099>>>>>    //***
77099>>>>>    //*** Function: SQLGetArgument
77099>>>>>    //*** Purpose : Get the specified argument from a procedure
77099>>>>>    //***
77099>>>>>
77099>>>>>    Function SQLGetArgument Integer iArgnum Returns String
77101>>>>>        Integer ihdbc
77101>>>>>        Integer ihstmt
77101>>>>>        String  sDrvrId
77101>>>>>        Integer iVoid
77101>>>>>        String  sEmpty
77101>>>>>        String  sArgument
77101>>>>>        Integer iLen
77101>>>>>
77101>>>>>        //*** Initialize
77101>>>>>        Move "" To sEmpty
77102>>>>>        Move "" To sArgument
77103>>>>>
77103>>>>>        //*** Get the cli handles
77103>>>>>        Get phCLIStatementHandle  to ihstmt
77104>>>>>        Get phCLIConnectionHandle to ihdbc
77105>>>>>        Get psDriverId            to sDrvrId
77106>>>>>
77106>>>>>        //*** Call the procedure
77106>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77108>>>>>            //*** Pass the information
77108>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Self ;                        Passing ihdbc iArgnum ihstmt ;                        Result iVoid
77113>>>>>
77113>>>>>            //*** Get the length
77113>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARGLEN ;                        Callback Self ;                        Passing sEmpty sEmpty 0 ;                        Result iLen
77118>>>>>
77118>>>>>            If (iLen) Begin
77120>>>>>                //*** Allocate
77120>>>>>                Move (Repeat(' ', iLen)) To sArgument
77121>>>>>
77121>>>>>                //*** Pass the argument
77121>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCARG ;                            Callback Self ;                            Passing sArgument sEmpty 0 ;                            Result iVoid
77126>>>>>            End
77126>>>>>>
77126>>>>>        End
77126>>>>>>
77126>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetArgument"
77128>>>>>
77128>>>>>        Function_Return sArgument
77129>>>>>    End_Function 
77130>>>>>
77130>>>>>
77130>>>>>
77130>>>>>    //***
77130>>>>>    //*** Function: SQLReturnValue
77130>>>>>    //*** Purpose : Get the return value of a stored function
77130>>>>>    //***
77130>>>>>
77130>>>>>    Function SQLReturnValue Returns String
77132>>>>>        Integer ihdbc
77132>>>>>        Integer ihstmt
77132>>>>>        String  sDrvrId
77132>>>>>        Integer iVoid
77132>>>>>        String  sEmpty
77132>>>>>        String  sRetval
77132>>>>>        Integer iLen
77132>>>>>
77132>>>>>        //*** Initialize
77132>>>>>        Move "" To sEmpty
77133>>>>>        Move "" To sRetval
77134>>>>>
77134>>>>>        //*** Get the cli handles
77134>>>>>        Get phCLIStatementHandle  to ihstmt
77135>>>>>        Get phCLIConnectionHandle to ihdbc
77136>>>>>        Get psDriverId            to sDrvrId
77137>>>>>
77137>>>>>        //*** Call the procedure
77137>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77139>>>>>            //*** Get the length
77139>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVALLEN ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iLen
77144>>>>>
77144>>>>>            If (iLen) Begin
77146>>>>>                //*** Allocate
77146>>>>>                Move (Repeat(' ', iLen)) To sRetval
77147>>>>>
77147>>>>>                //*** Pass the argument
77147>>>>>                Call_driver 0 sDrvrId Function FUNC_SQLGETPROCRETVAL ;                            Callback Self ;                            Passing ihdbc sRetval ihstmt ;                            Result iVoid
77152>>>>>            End
77152>>>>>>
77152>>>>>        End
77152>>>>>>
77152>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLReturnValue"
77154>>>>>
77154>>>>>        Function_Return sRetval
77155>>>>>    End_Function 
77156>>>>>
77156>>>>>
77156>>>>>
77156>>>>>    //***
77156>>>>>    //*** Function: SQLNextResultSet
77156>>>>>    //*** Purpose : Switch to the next set
77156>>>>>    //*** Returns : 0   = No more result sets
77156>>>>>    //***           <>0 = Switched to next set
77156>>>>>    //***
77156>>>>>
77156>>>>>    Function SQLNextResultSet Returns Integer
77158>>>>>        Integer ihdbc
77158>>>>>        Integer ihstmt
77158>>>>>        String  sDrvrId
77158>>>>>        Integer iResult
77158>>>>>        String  sEmpty
77158>>>>>
77158>>>>>        //*** Initialize
77158>>>>>        Move "" To sEmpty
77159>>>>>        Move 0  To iResult
77160>>>>>
77160>>>>>        //*** Get the cli handles
77160>>>>>        Get phCLIStatementHandle  to ihstmt
77161>>>>>        Get phCLIConnectionHandle to ihdbc
77162>>>>>        Get psDriverId            to sDrvrId
77163>>>>>
77163>>>>>        //*** Call the procedure
77163>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77165>>>>>            //*** Get the length
77165>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLNEXTRESULTSET ;                        Callback Self ;                        Passing ihdbc sEmpty ihstmt  ;                        Result iResult
77170>>>>>                        
77170>>>>>            Send SQLGetStatementAttributes
77171>>>>>            Set piLastArgument to 0
77172>>>>>        End
77172>>>>>>
77172>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLNextResultSet"
77174>>>>>
77174>>>>>        Function_Return iResult
77175>>>>>    End_Function
77176>>>>>
77176>>>>>
77176>>>>>
77176>>>>>    //***
77176>>>>>    //*** Procedure: SQLFetchActivatesBuffer
77176>>>>>    //*** Purpose  : Setup a file that will be acivated after a succesfull
77176>>>>>    //***            fetch on the statement
77176>>>>>    //***
77176>>>>>
77176>>>>>    Procedure SQLFetchActivatesBuffer Integer iFileNum Integer bState
77178>>>>>        Integer ihdbc
77178>>>>>        Integer ihstmt
77178>>>>>        String  sDrvrId
77178>>>>>        Integer iResult
77178>>>>>        Integer bIsOpen
77178>>>>>        Integer iVoid
77178>>>>>        String  sFileType
77178>>>>>
77178>>>>>        //*** Check if file is open
77178>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77181>>>>>        If (bIsOpen) Begin
77183>>>>>            //*** Get the cli handles
77183>>>>>            Get phCLIStatementHandle  to ihstmt
77184>>>>>            Get phCLIConnectionHandle to ihdbc
77185>>>>>            Get psDriverId            to sDrvrId
77186>>>>>
77186>>>>>            //*** Call the procedure
77186>>>>>            If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77188>>>>>                //*** Check if the file has the correct type
77188>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sFileType
77191>>>>>                If (sFileType = sDrvrId) Begin
77193>>>>>                    //*** Setup the buffer
77193>>>>>                    Call_driver iFileNum sDrvrId Function FUNC_SQLBUFFERSTATUS ;                                Callback Self ;                                Passing ihdbc bState ihstmt  ;                                Result iVoid
77198>>>>>                End
77198>>>>>>
77198>>>>>                Else ;                    Send StmtError CLIERR_SQLINVALID_BIND_FILE ("File" * String(iFileNum) * "type incompatible with statement ("  + sFileType + ")") "SQLBindFile"
77200>>>>>            End
77200>>>>>>
77200>>>>>            Else ;                Send HandleError ihstmt ihdbc sDrvrId "SQLFetchActivatesBuffer"
77202>>>>>        End
77202>>>>>>
77202>>>>>        Else ;            Send StmtError CLIERR_SQLINVALID_BUFFER ("File not open (number =" * String(iFileNum) + ")") "SQLFetchActivatesBuffer"
77204>>>>>    End_Procedure 
77205>>>>>
77205>>>>>
77205>>>>>
77205>>>>>    Function SQLGetMessage Integer iMessageNum Returns String
77207>>>>>        Integer ihdbc
77207>>>>>        Integer ihstmt
77207>>>>>        String  sDrvrId
77207>>>>>        String  sMessage
77207>>>>>        Integer iVoid
77207>>>>>
77207>>>>>        //*** Initialize
77207>>>>>        Move "" To sMessage
77208>>>>>
77208>>>>>        //*** Get the cli handles
77208>>>>>        Get phCLIStatementHandle  to ihstmt
77209>>>>>        Get phCLIConnectionHandle to ihdbc
77210>>>>>        Get psDriverId            to sDrvrId
77211>>>>>
77211>>>>>        //*** Call the procedure
77211>>>>>        If (ihstmt <> 0 And ihdbc <> 0 And sDrvrId <> "") Begin
77213>>>>>            //*** Setup function arguments
77213>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLCOLUMNINFO ;                        Callback Self ;                        Passing ihdbc iMessageNum ihstmt ;                        Result iVoid
77218>>>>>
77218>>>>>            Move (Repeat(' ', 1024)) To sMessage
77219>>>>>            //*** Get the length
77219>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLGETMESSAGE ;                        Callback Self ;                        Passing iVoid sMessage iVoid ;                        Result iVoid
77224>>>>>        End
77224>>>>>>
77224>>>>>        Else ;            Send HandleError ihstmt ihdbc sDrvrId "SQLGetDiagRec"
77226>>>>>
77226>>>>>        Function_Return sMessage
77227>>>>>    End_Function 
77228>>>>>
77228>>>>>
77228>>>>>
77228>>>>>    //***
77228>>>>>    //*** Function: RemoveComponentIdentifier
77228>>>>>    //*** Purpose : Remove the component identifier from a diagnostic message
77228>>>>>    //***
77228>>>>>
77228>>>>>    Function RemoveComponentIdentifier String sDiagMessage Returns String
77230>>>>>        While (Left(sDiagMessage, 1) = "[")
77234>>>>>            Move (Right(sDiagMessage, Length(sDiagMessage) - Pos("]", sDiagMessage))) To sDiagMessage
77235>>>>>        End
77236>>>>>>
77236>>>>>
77236>>>>>        Function_Return sDiagMessage
77237>>>>>    End_Function
77238>>>>>
77238>>>>>
77238>>>>>
77238>>>>>    //***
77238>>>>>    //*** Function: DFDateToSQLDate
77238>>>>>    //*** Purpose : Convert a DataFlex date to a SQL Date. Use dummy zero dates.
77238>>>>>    //***
77238>>>>>    Function DFDateToSQLDate Date dDFDate Integer iSQLType Returns String
77240>>>>>        
77240>>>>>        Integer iType
77240>>>>>        String  sSQLDate
77240>>>>>        Integer iOrgDateFmt
77240>>>>>        Integer iOrgDateSep
77240>>>>>
77240>>>>>        String sDriverId
77240>>>>>        String sDummyZeroDate
77240>>>>>        String sDummyZeroDateMssqlDatetime
77240>>>>>
77240>>>>>        //*** Change date format to military, SQL dates are military dates
77240>>>>>        Get_Attribute DF_DATE_FORMAT to iOrgDateFmt
77243>>>>>        Get_Attribute DF_DATE_SEPARATOR to iOrgDateSep
77246>>>>>        Set_Attribute DF_DATE_FORMAT to DF_DATE_MILITARY
77249>>>>>        Set_Attribute DF_DATE_SEPARATOR to (Ascii('-'))
77252>>>>>
77252>>>>>        //*** We only need to convert if the date is 0
77252>>>>>        If (Integer(dDFDate = 0)) Begin
77254>>>>>
77254>>>>>            If (num_arguments < 2) Begin
77256>>>>>                Move SQL_TYPE_TIMESTAMP to iType
77257>>>>>            End
77257>>>>>>
77257>>>>>            Else Begin
77258>>>>>                Move iSQLType to iType
77259>>>>>            End
77259>>>>>>
77259>>>>>
77259>>>>>            
77259>>>>>            Get psDriverID to sDriverId
77260>>>>>            Get psDummyZeroDate to sDummyZeroDate
77261>>>>>                
77261>>>>>            If ( (iType = SQL_TYPE_TIMESTAMP) and (sDriverID = 'MSSQLDRV') ) Begin
77263>>>>>                Get psDummyZeroDateMssqlDatetime to sDummyZeroDateMssqlDatetime
77264>>>>>                Move sDummyZeroDateMssqlDatetime to sSQLDate
77265>>>>>            End
77265>>>>>>
77265>>>>>            Else Begin
77266>>>>>                Move sDummyZeroDate to sSQLDate
77267>>>>>            End
77267>>>>>>
77267>>>>>            
77267>>>>>            //CLI_Get_Driver_Attribute sDRiver DRVR_DUMMY_ZERO_DATE_VALUE to sSQLDate
77267>>>>>        End
77267>>>>>>
77267>>>>>        Else Begin
77268>>>>>            Move dDFDate to sSQLDate
77269>>>>>        End
77269>>>>>>
77269>>>>>
77269>>>>>        //*** Change date format back to original
77269>>>>>        Set_Attribute DF_DATE_FORMAT to iOrgDateFmt
77272>>>>>        Set_Attribute DF_DATE_SEPARATOR to iOrgDateSep
77275>>>>>
77275>>>>>        Function_Return sSQLDate
77276>>>>>    End_Function 
77277>>>>>
77277>>>>>
77277>>>>>    //***
77277>>>>>    //*** Function: SQLDateToDFDate
77277>>>>>    //*** Purpose : Convert a SQL date to a DataFlex Date. Use dummy zero dates.
77277>>>>>    //***
77277>>>>>    Function SQLDateToDFDate String sSQLDate Returns Date
77279>>>>>        
77279>>>>>        Integer iType
77279>>>>>        Date    dDFDate
77279>>>>>        Integer iOrgDateFmt
77279>>>>>        Integer iOrgDateSep
77279>>>>>        
77279>>>>>        String  sDriverId
77279>>>>>        String  sDummyZeroDate
77279>>>>>        String  sDummyZeroDateMssqlDatetime
77279>>>>>        
77279>>>>>        Get psDriverID to sDriverId
77280>>>>>        
77280>>>>>        Get psDummyZeroDate to sDummyZeroDate
77281>>>>>        Get psDummyZeroDateMssqlDatetime to sDummyZeroDateMssqlDatetime
77282>>>>>        
77282>>>>>        Get_Attribute DF_DATE_FORMAT to iOrgDateFmt
77285>>>>>        Get_Attribute DF_DATE_SEPARATOR to iOrgDateSep
77288>>>>>        Set_Attribute DF_DATE_FORMAT to DF_DATE_MILITARY
77291>>>>>        Set_Attribute DF_DATE_SEPARATOR to (Ascii('-'))
77294>>>>>        
77294>>>>>        Move (Left(sSQLDate,10)) to sSQLDate 
77295>>>>>
77295>>>>>        If ( (sSQLDate = sDummyZeroDate) or ;             ( (sDriverId = 'MSSQLDRV') and (sSQLDate = sDummyZeroDateMssqlDatetime) ) )  Begin
77297>>>>>            Move 0 to dDFDate
77298>>>>>        End
77298>>>>>>
77298>>>>>        Else Begin
77299>>>>>            Move sSQLDate to dDFDate
77300>>>>>        End
77300>>>>>>
77300>>>>>
77300>>>>>        //*** Change date format back to original
77300>>>>>        Set_Attribute DF_DATE_FORMAT to iOrgDateFmt
77303>>>>>        Set_Attribute DF_DATE_SEPARATOR to iOrgDateSep
77306>>>>>
77306>>>>>        Function_Return dDFDate
77307>>>>>    End_Function 
77308>>>>>
77308>>>>>End_Class 
77309>>>>>
77309>>>>>
77309>>>>>//*****************************************************************************
77309>>>>>//*** Class  : cSQLConnection                                               ***
77309>>>>>//*** Purpose: Connection object for embedded SQL                           ***
77309>>>>>//***                                                                       ***
77309>>>>>//*** Description:                                                          ***
77309>>>>>//***   This provides the ability to create a connection for a driver.      ***
77309>>>>>//***   It will contain child statement objects                             ***
77309>>>>>//*****************************************************************************
77309>>>>>
77309>>>>>Class cSQLConnection is a cObject
77310>>>>>
77310>>>>>    Procedure Construct_object 
77312>>>>>        Forward Send Construct_object 
77314>>>>>
77314>>>>>        Property Integer phCLIConnectionHandle       0
77315>>>>>        
77315>>>>>        Property String  psDriverID        ""
77316>>>>>        Property Integer piBindFile        0
77317>>>>>        
77317>>>>>        Property String psDummyZeroDate              '0001-01-01'
77318>>>>>        Property String psDummyZeroDateMssqlDatetime '1753-01-01'        
77319>>>>>
77319>>>>>    End_Procedure
77320>>>>>
77320>>>>>
77320>>>>>
77320>>>>>    //***
77320>>>>>    //*** Procedure: StoreConnectionInfo
77320>>>>>    //*** Purpose  : Store basic information about the connection
77320>>>>>    //***
77320>>>>>    Procedure StoreConnectionInfo Handle hCLIConnectionHandle String sDrvrId 
77322>>>>>        
77322>>>>>        String sDummyZeroDate
77322>>>>>        
77322>>>>>        Set phCLIConnectionHandle to hCLIConnectionHandle
77323>>>>>        Set psDriverID            to sDrvrId
77324>>>>>        
77324>>>>>        Case Begin
77324>>>>>            Case (sDrvrId = "MSSQLDRV")
77326>>>>>                Set psDummyZeroDate to '0001-01-01'
77327>>>>>                Set psDummyZeroDateMssqlDatetime to '1753-01-01'
77328>>>>>                Break
77329>>>>>            Case (sDrvrId = "DB2_DRV")
77332>>>>>                Set psDummyZeroDate to '0001-01-01'
77333>>>>>                Break
77334>>>>>            Case (sDrvrId = "ODBC_DRV")
77337>>>>>                CLI_Get_Driver_Attribute sDrvrId DRVR_DUMMY_ZERO_DATE_VALUE to sDummyZeroDate
77344>>>>>                Set psDummyZeroDate to sDummyZeroDate
77345>>>>>                Break
77346>>>>>        Case End
77346>>>>>        
77346>>>>>    End_Procedure 
77347>>>>>
77347>>>>>
77347>>>>>    //***
77347>>>>>    //*** Procedure: DestroySQLConnection
77347>>>>>    //*** Purpose : Destroy the SQLConnection object
77347>>>>>    //***
77347>>>>>    Procedure DestroySQLConnection
77349>>>>>        Send Destroy
77350>>>>>    End_Procedure 
77351>>>>>
77351>>>>>
77351>>>>>    //***
77351>>>>>    //*** Function: SQLConnect
77351>>>>>    //*** Purpose : Connect to a database server
77351>>>>>    //*** Returns : 1 Succesfully connected
77351>>>>>    //***           0 Not connected
77351>>>>>    Function SQLConnect String sDrvrID String sConnect Returns Integer
77353>>>>>        Integer ihdbc
77353>>>>>        String  sEmpty
77353>>>>>
77353>>>>>        //*** Initialize
77353>>>>>        Move "" To sEmpty
77354>>>>>        Move 0  To ihdbc
77355>>>>>
77355>>>>>        Indicate Err False
77356>>>>>
77356>>>>>        //*** Call the driver function to connect
77356>>>>>        Call_driver 0 sDrvrId Function FUNC_SQLCONNECT ;                    Callback Self ;                    Passing sConnect sEmpty Self ;                    Result ihdbc
77361>>>>>
77361>>>>>        //*** If there was an error, make result invalid
77361>>>>>        If (Err) ;            Move 0 To ihdbc
77364>>>>>
77364>>>>>        //*** Check result and store it
77364>>>>>        If (ihdbc <> 0) ;            Send StoreConnectionInfo ihdbc sDrvrId
77367>>>>>
77367>>>>>        //*** Return success status
77367>>>>>        Function_Return (ihdbc <> 0)
77368>>>>>    End_Function 
77369>>>>>
77369>>>>>
77369>>>>>
77369>>>>>    //***
77369>>>>>    //*** Function: SQLFileConnect
77369>>>>>    //*** Purpose : Use a connection of an already open file
77369>>>>>    //***
77369>>>>>    Function SQLFileConnect Integer iFileNum Returns Integer
77371>>>>>        Integer ihdbc
77371>>>>>        Integer bIsOpen
77371>>>>>        String  sDrvrId
77371>>>>>        String  sEmpty
77371>>>>>
77371>>>>>        //*** Initialize
77371>>>>>        Move "" To sEmpty
77372>>>>>        Move 0  To ihdbc
77373>>>>>
77373>>>>>        //*** Check if file is open
77373>>>>>        Get_attribute DF_FILE_OPENED Of iFileNum To bIsOpen
77376>>>>>        If (bIsOpen) Begin
77378>>>>>            //*** Fill the driver id, assume longest is 255 characters
77378>>>>>            Move (Repeat(' ', 255)) To sDrvrId
77379>>>>>            Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
77382>>>>>
77382>>>>>            Indicate Err False
77383>>>>>
77383>>>>>            //*** Call the driver function to connect
77383>>>>>            Call_driver iFileNum sDrvrId Function FUNC_SQLFILECONNECT ;                        Callback Self ;                        Passing sEmpty sEmpty 0 ;                        Result ihdbc
77388>>>>>
77388>>>>>            //*** If there was an error, make result invalid
77388>>>>>            If (Err) ;                Move 0 To ihdbc
77391>>>>>
77391>>>>>            //*** Check result and store it
77391>>>>>            If (ihdbc <> 0) Begin
77393>>>>>                //*** Somehow Call_driver overwrites the sDrvrId variable, restore it here
77393>>>>>                Get_attribute DF_FILE_DRIVER Of iFileNum To sDrvrId
77396>>>>>                Send StoreConnectionInfo ihdbc sDrvrId
77397>>>>>
77397>>>>>                //*** Set filenum so it can be used for fetching
77397>>>>>                Set piBindFile To iFileNum
77398>>>>>            End
77398>>>>>>
77398>>>>>        End
77398>>>>>>
77398>>>>>
77398>>>>>        //*** Return success status
77398>>>>>        Function_Return (ihdbc <> 0)
77399>>>>>    End_Function
77400>>>>>
77400>>>>>
77400>>>>>
77400>>>>>    //***
77400>>>>>    //*** Procedure: SQLDisconnect
77400>>>>>    //*** Purpose  : Disconnect from an embedded SQL server and free allocated
77400>>>>>    //***            resources
77400>>>>>    //***
77400>>>>>    Procedure SQLDisconnect
77402>>>>>        Integer ihdbc
77402>>>>>        Integer iVoid
77402>>>>>        String  sDrvrId
77402>>>>>        String  sEmpty
77402>>>>>
77402>>>>>        //*** Initialize
77402>>>>>        Move "" To sEmpty
77403>>>>>
77403>>>>>        //*** Get the cli handle
77403>>>>>        Get phCLIConnectionHandle to ihdbc
77404>>>>>        Get psDriverId To sDrvrId
77405>>>>>
77405>>>>>        //*** Free the CLI handle
77405>>>>>        If (ihdbc <> 0) Begin
77407>>>>>            //*** Call the driver function to disconnect
77407>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLDISCONNECT ;                        Callback Self ;                        Passing sEmpty sEmpty ihdbc ;                        Result iVoid
77412>>>>>
77412>>>>>            Move -1 to giLastSQLhdbc
77413>>>>>
77413>>>>>            //*** Free the DataFlex handle
77413>>>>>            Send DestroySQLConnection
77414>>>>>        End
77414>>>>>>
77414>>>>>    End_Procedure 
77415>>>>>
77415>>>>>
77415>>>>>
77415>>>>>    //***
77415>>>>>    //*** Function: CreateSQLStatement
77415>>>>>    //*** Purpose : Create a cSQLStatement object
77415>>>>>    //***
77415>>>>>    Function CreateSQLStatement Returns Handle
77417>>>>>        
77417>>>>>        Handle hoSQLStatement
77417>>>>>        Get Create (RefClass(cSQLStatement)) to hoSQLStatement
77418>>>>>        
77418>>>>>        //*** If the connection has a default Bind File, assign it to the
77418>>>>>        //*** statement object. The default is set when you open a file with a
77418>>>>>        //*** SetFileConnection command.
77418>>>>>        Set piBindFile of hoSQLStatement to (piBindFile(Self))
77419>>>>>        
77419>>>>>        Function_Return hoSQLStatement
77420>>>>>    End_Function 
77421>>>>>
77421>>>>>
77421>>>>>    //***
77421>>>>>    //*** Function: SQLOpen
77421>>>>>    //*** Prupose : Open a statement for use
77421>>>>>    //***
77421>>>>>    Function SQLOpen Returns Handle
77423>>>>>        Handle  hoSQLStatement
77423>>>>>        Integer ihdbc
77423>>>>>        Integer ihstmt
77423>>>>>        Integer iVoid
77423>>>>>        String  sDrvrId
77423>>>>>        String  sEmpty
77423>>>>>        String  sDummyZeroDate
77423>>>>>        String  sDummyZeroDateMssqlDatetime 
77423>>>>>
77423>>>>>        //*** Initialize
77423>>>>>        Move "" To sEmpty
77424>>>>>
77424>>>>>        //*** Get the cli handle to the connection
77424>>>>>        Get phCLIConnectionHandle to ihdbc
77425>>>>>        Get psDriverId  To sDrvrId
77426>>>>>
77426>>>>>        //*** Allocate a new handle and populate it
77426>>>>>        If (ihdbc <> 0) Begin
77428>>>>>            //**** Create a new cSQLStatement object
77428>>>>>            Get CreateSQLStatement to hoSQLStatement
77429>>>>>
77429>>>>>            //*** Call the driver function to allocate a cli statement handle
77429>>>>>            Call_driver 0 sDrvrId Function FUNC_SQLOPEN ;                        Callback Self ;                        Passing hoSQLStatement sEmpty ihdbc ;                        Result ihstmt
77434>>>>>
77434>>>>>            //*** If unsuccessful destroy hoSQLStatement
77434>>>>>            If (ihstmt = 0) Begin
77436>>>>>                Send DestroySQLStatement of hoSQLStatement
77437>>>>>                Move 0 to hoSQLStatement
77438>>>>>            End
77438>>>>>>
77438>>>>>            Else Begin
77439>>>>>                Send StoreStatementInfo of hoSQLStatement ihstmt sDrvrId ihdbc
77440>>>>>
77440>>>>>                // Store DummyZeroDate of hoSQLConnection in hoSQLStatement
77440>>>>>                Get psDummyZeroDate              to sDummyZeroDate
77441>>>>>                Get psDummyZeroDateMssqlDatetime to sDummyZeroDateMssqlDatetime
77442>>>>>                
77442>>>>>                Set psDummyZeroDate              of hoSQLStatement to sDummyZeroDate
77443>>>>>                Set psDummyZeroDateMssqlDatetime of hoSQLStatement to sDummyZeroDateMssqlDatetime
77444>>>>>                
77444>>>>>            End
77444>>>>>>
77444>>>>>        End
77444>>>>>>
77444>>>>>
77444>>>>>        Function_Return hoSQLStatement
77445>>>>>    End_Function 
77446>>>>>
77446>>>>>End_Class 
77447>>>>>
77447>>>>>
77447>>>>>
77447>>>>>//*****************************************************************************
77447>>>>>//*** Class  : cSQLHandlemanager                                            ***
77447>>>>>//*** Purpose: Manager for embedded SQL handles.                            ***
77447>>>>>//***                                                                       ***
77447>>>>>//*** Description:                                                          ***
77447>>>>>//***   We want to be able to use multiple drivers and multiple             ***
77447>>>>>//***   connections within a driver and multiple statements within a        ***
77447>>>>>//***   connection. To allow this we have placed our own handle logic on    ***
77447>>>>>//***   top of the driver handle logic. This way we can handle the          ***
77447>>>>>//***   situation where two driver handles may be equal.                    ***
77447>>>>>//*****************************************************************************
77447>>>>>
77447>>>>>Class cSQLHandleManager is a cObject
77448>>>>>
77448>>>>>    Procedure Construct_object 
77450>>>>>        Forward Send Construct_object 
77452>>>>>
77452>>>>>        Property String  psDefaultDriver      ""
77453>>>>>        Property String  psDefaultConnection  ""
77454>>>>>
77454>>>>>    End_Procedure 
77455>>>>>
77455>>>>>    //***
77455>>>>>    //*** Function: CreateSQLConnection
77455>>>>>    //*** Purpose : Create a cSQLConnection object
77455>>>>>    //***
77455>>>>>    Function CreateSQLConnection Returns Handle
77457>>>>>        Handle hoSQLConnection
77457>>>>>        Get Create (RefClass(cSQLConnection)) to hoSQLConnection
77458>>>>>        Function_Return hoSQLConnection
77459>>>>>    End_Function 
77460>>>>>
77460>>>>>
77460>>>>>    //***
77460>>>>>    //*** Procedure: SQLSetConnect
77460>>>>>    //*** Purpose  : Store default connection information
77460>>>>>    //***
77460>>>>>
77460>>>>>    Procedure SQLSetConnect String sDriver String sConnect
77462>>>>>        Set psDefaultDriver      To sDriver
77463>>>>>        Set psDefaultConnection  To sConnect
77464>>>>>    End_Procedure 
77465>>>>>
77465>>>>>
77465>>>>>
77465>>>>>    //***
77465>>>>>    //*** Function: SQLConnect
77465>>>>>    //*** Purpose : Make a connection to an embedded SQL server
77465>>>>>    //*** Returns : The DataFlex handle to the connection
77465>>>>>    //***
77465>>>>>    Function SQLConnect String sDrvrID String sConnect Returns integer
77467>>>>>        Handle hoSQLConnection
77467>>>>>        Integer bOK
77467>>>>>
77467>>>>>        //*** Check arguments
77467>>>>>        If (sDrvrID = "" And sConnect = "") Begin
77469>>>>>            Get psDefaultDriver      To sDrvrId
77470>>>>>            Get psDefaultConnection  To sConnect
77471>>>>>        End
77471>>>>>>
77471>>>>>
77471>>>>>        //*** Create a cSQLConnection object
77471>>>>>        Get CreateSQLConnection to hoSQLConnection
77472>>>>>        //*** Connect to the database 
77472>>>>>        Get SQLConnect of hoSQLConnection sDrvrID sConnect to bOK
77473>>>>>
77473>>>>>        //*** If connection to the database failed, destroy the cSQLConnection object and return a 0 handle
77473>>>>>        If (not(bOK)) Begin
77475>>>>>            Send DestroySQLConnection of hoSQLConnection
77476>>>>>            Move 0 to hoSQLConnection
77477>>>>>        End
77477>>>>>>
77477>>>>>
77477>>>>>        Function_Return hoSQLConnection
77478>>>>>    End_Function 
77479>>>>>
77479>>>>>
77479>>>>>
77479>>>>>    //***
77479>>>>>    //*** Function: SQLFileConnect
77479>>>>>    //*** Purpose : Make an existing connection available for use with Embedded SQL.
77479>>>>>    //***           The connection is identified by the number of a file
77479>>>>>    //***           that is open for that connection.
77479>>>>>    //***
77479>>>>>
77479>>>>>    Function SQLFileConnect Integer iFileNum Returns Handle
77481>>>>>        Handle hoSQLConnection
77481>>>>>        Integer bOK
77481>>>>>
77481>>>>>        //*** Create a cSQLConnection object
77481>>>>>        Get CreateSQLConnection to hoSQLConnection
77482>>>>>        Get SQLFileConnect of hoSQLConnection iFileNum To bOK
77483>>>>>
77483>>>>>        //*** If connection to the database failed, destroy the cSQLConnection object and return a 0 handle
77483>>>>>        If (not(bOK)) Begin
77485>>>>>            Send DestroySQLConnection of hoSQLConnection
77486>>>>>            Move 0 to hoSQLConnection
77487>>>>>        End
77487>>>>>>
77487>>>>>
77487>>>>>        Function_Return hoSQLConnection
77488>>>>>    End_Function 
77489>>>>>
77489>>>>>End_Class 
77490>>>>>
77490>>>Use MsSqlDrv.pkg
Including file: MSSqldrv.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\MSSqldrv.pkg)
77490>>>>>//*****************************************************************************
77490>>>>>//*** MSSQLDRV.PKG                                                          ***
77490>>>>>//***                                                                       ***
77490>>>>>//*** Author: Ben Weijers                                                   ***
77490>>>>>//***         Data Access Nederland                                         ***
77490>>>>>//***         29 June 1998                                                  ***
77490>>>>>//***                                                                       ***
77490>>>>>//***                                                                       ***
77490>>>>>//*** Purpose:                                                              ***
77490>>>>>//***   Package that declares MS SQL driver constants and functions.        ***
77490>>>>>//****                                                                      ***
77490>>>>>//***   This package can be used by developers who want to add Data Access  ***
77490>>>>>//***   MS SQL Client specific code to a DataFlex application.              ***
77490>>>>>//***   Updated:  June 4th 2012 (Current CK build: 5.1.0.96)                ***
77490>>>>>//***             Changed EnumerateServers function to use the highest      ***
77490>>>>>//***             available SQL Server client driver.                       ***
77490>>>>>//***             Moved SQL Server client constants from cli.pkg to         ***
77490>>>>>//***             mssqldrv.pkg                                              ***
77490>>>>>//***   Updated:  November 6th 2013 (Current CK build: 6.0.0.19)            ***
77490>>>>>//***             Added constants for SQL Server specific native types      ***
77490>>>>>//***             ( var...(max) types, money types, datetime types)         ***
77490>>>>>//*****************************************************************************
77490>>>>>
77490>>>>>Use Cli.pkg
77490>>>>>Use SQL.pkg
77490>>>>>
77490>>>>>//*** Driver Indentification
77490>>>>>
77490>>>>>//*** Error number constants
77490>>>>>
77490>>>>>
77490>>>>>//*** Possible DF_DRIVER_SQLSERVER_CLIENT_VERSION values
77490>>>>>
77490>>>>>
77490>>>>>
77490>>>>>
77490>>>>>// SQL Server spcific types. 
77490>>>>>Define SQL_SS_TIMESTAMPOFFSET   for   (-155) //SQL server datetimeoffset type */
77490>>>>>Define SQL_SS_TIME2             for   (-154) //SQL server time type */
77490>>>>>Define SQL_SS_XML               for   (-152) //SQL server xml type */
77490>>>>>Define SQL_SS_VARIANT           for   (-150) //SQL server variant type */
77490>>>>>
77490>>>>>// SQL Server spcific types. 
77490>>>>>Define SQL_TYPE_TIMESTAMP2      for   (-200) //SQL server datetime2 type */
77490>>>>>Define SQL_VARCHARMAX           for   (-201) //SQL server varchar(max) type */
77490>>>>>Define SQL_WVARCHARMAX          for   (-202) //SQL server wvarchar(max) type */
77490>>>>>Define SQL_VARBINARYMAX         for   (-203) //SQL server varbinary(max) type */
77490>>>>>Define SQL_TYPE_MONEY           for   (-204) //SQL server money type */
77490>>>>>Define SQL_TYPE_SMALLMONEY      for   (-205) //SQL server smallmoney type */
77490>>>>>Define SQL_TYPE_SMALLDATETIME   for   (-206) //SQL server smalldatetype type */
77490>>>>>
77490>>>>>
77490>>>>>//*****************************************************************************
77490>>>>>//*** MSSQL_SetConstraint <FileNum> <ConstraintText>                        ***
77490>>>>>//***                                                                       ***
77490>>>>>//***   Setup a constraint for a file.                                      ***
77490>>>>>//*****************************************************************************
77490>>>>>
77490>>>>>
77490>>>>>
77490>>>>>Class cMSSQLHandler Is A cCLIHandler
77491>>>>>
77491>>>>>    Procedure Construct_Object
77493>>>>>        Forward Send Construct_Object
77495>>>>>
77495>>>>>        Set psDriverID To MSSQLDRV_ID
77496>>>>>    End_Procedure // Construct_Object
77497>>>>>
77497>>>>>
77497>>>>>
77497>>>>>    //***
77497>>>>>    //*** Function: ExtractList
77497>>>>>    //*** Purpose : Extract the list from the out connect string.
77497>>>>>    //***
77497>>>>>
77497>>>>>    Function ExtractList String sOutConnStr Integer hoStore Returns Integer
77499>>>>>        Local String  sItem
77499>>>>>        Local Integer iStart
77499>>>>>        Local Integer iEnd
77499>>>>>
77499>>>>>        If (hoStore = 0) ;            Move Current_object To hoStore
77502>>>>>
77502>>>>>        Send Delete_Data To hoStore
77503>>>>>        Move (Pos("{", sOutConnStr)) To iStart
77504>>>>>        While (iStart > 0)
77508>>>>>            Move (Right(sOutConnStr, Length(sOutConnStr) - iStart)) To sOutConnStr
77509>>>>>            If (Left(sOutConnStr, 1) = "}") ;                Move 0 To iStart
77512>>>>>            Else Begin
77513>>>>>                Move (Pos(",", sOutConnStr)) To iStart
77514>>>>>                Move (Pos("}", sOutConnStr)) To iEnd
77515>>>>>                If ((iStart = 0) Or (iEnd < iStart)) ;                    Move iEnd To iStart
77518>>>>>
77518>>>>>                If (iStart > 0) ;                    Set Value Of hoStore Item (Item_Count(Current_Object)) To (Left(sOutConnStr, iStart - 1))
77521>>>>>
77521>>>>>                If (iStart = iEnd) ;                    Move 0 To iStart
77524>>>>>            End
77524>>>>>>
77524>>>>>        Loop
77525>>>>>>
77525>>>>>
77525>>>>>        Function_Return (Item_Count(hoStore))
77526>>>>>    End_Procedure // ExtractList
77527>>>>>
77527>>>>>
77527>>>>>
77527>>>>>    //***
77527>>>>>    //*** Function: BrowseConnect
77527>>>>>    //*** Purpose : Call the driver's browse connect function
77527>>>>>    //***
77527>>>>>
77527>>>>>    Function BrowseConnect String sInConnStr Returns String
77529>>>>>        Local String  sDriver
77529>>>>>        Local String  sOutConnStr
77529>>>>>        Local Integer iArg
77529>>>>>        Local Integer iRetval
77529>>>>>
77529>>>>>        Get psDriverID To sDriver
77530>>>>>        If (sDriver <> "") Begin
77532>>>>>            Move (Repeat(" ", 8192)) To sOutConnStr
77533>>>>>            Call_Driver 0 sDRiver Function CLI_BROWSECONNECT Callback 0 Passing sInConnStr sOutConnStr iArg Result iRetval
77538>>>>>        End
77538>>>>>>
77538>>>>>
77538>>>>>        Function_Return sOutConnStr
77539>>>>>    End_Function// BrowseConnect
77540>>>>>
77540>>>>>    Function DriverIndex String sDriver Returns Integer
77542>>>>>    
77542>>>>>        Local String  sCurrentDriver
77542>>>>>        Local Integer iNumberOfDrivers iDriver iCount
77542>>>>>    
77542>>>>>        Move 0 to iDriver
77543>>>>>    
77543>>>>>        Get_Attribute DF_NUMBER_DRIVERS to iNumberOfDrivers
77546>>>>>        For iCount from 1 to iNumberOfDrivers
77552>>>>>>
77552>>>>>    
77552>>>>>            Get_Attribute DF_DRIVER_NAME of iCount to sCurrentDriver
77555>>>>>            If ( Uppercase(sCurrentDriver) = Uppercase(sDriver) ) Begin
77557>>>>>                Move iCount to iDriver
77558>>>>>            End
77558>>>>>>
77558>>>>>        Loop
77559>>>>>>
77559>>>>>    
77559>>>>>        Function_Return iDriver
77560>>>>>    
77560>>>>>    End_Function 
77561>>>>>
77561>>>>>    //***
77561>>>>>    //*** Procedure: EnumerateServers
77561>>>>>    //*** Purpose  : Enumerate the available SQL Server database servers
77561>>>>>    //***
77561>>>>>    Function EnumerateServers Returns Integer
77563>>>>>        Local String  sServerList
77563>>>>>        Local Integer iNumServers
77563>>>>>        Local Integer iDriver
77563>>>>>        Local Integer iClientVersion
77563>>>>>        Local String  sDriver
77563>>>>>        
77563>>>>>        Get DriverIndex MSSQLDRV_ID to iDriver
77564>>>>>        
77564>>>>>        Get_Attribute DF_DRIVER_SQLSERVER_CLIENT_VERSION of iDriver to iClientVersion
77567>>>>>        
77567>>>>>        If (iClientVersion = SQLSERVER2012CLIENT) Begin
77569>>>>>            Move SQLSERVER2012DRVRSTR to sDriver
77570>>>>>        End
77570>>>>>>
77570>>>>>        Else Begin
77571>>>>>            If (iClientVersion = SQLSERVER2008CLIENT) Begin
77573>>>>>                Move SQLSERVER2008DRVRSTR to sDriver
77574>>>>>            End  
77574>>>>>>
77574>>>>>            Else Begin
77575>>>>>                If (iClientVersion = SQLSERVER2005CLIENT) Begin
77577>>>>>                    Move SQLSERVER2005DRVRSTR to sDriver
77578>>>>>                End  
77578>>>>>>
77578>>>>>                Else Begin
77579>>>>>                    Move SQLSERVER2000DRVRSTR to sDriver 
77580>>>>>                End
77580>>>>>>
77580>>>>>            End
77580>>>>>>
77580>>>>>        End
77580>>>>>>
77580>>>>>
77580>>>>>        Move ("DRIVER={" + sDriver + "};") to sDriver
77581>>>>>        Get BrowseConnect sDriver to sServerList
77582>>>>>        Get ExtractList sServerList Current_object To iNumServers
77583>>>>>        Function_Return iNumServers
77584>>>>>    End_Function // EnumerateServers
77585>>>>>
77585>>>>>    //***
77585>>>>>    //*** Function: EnumerateDatabases
77585>>>>>    //*** Purpose : Enumerate database in a given server.
77585>>>>>    //***
77585>>>>>
77585>>>>>    Function EnumerateDatabases String sServer String sUser String sPassWord Returns Integer
77587>>>>>        Local Integer hoSQL
77587>>>>>        Local String  sConnect
77587>>>>>        Local String  sDatabase
77587>>>>>        Local Integer hdbc
77587>>>>>        Local Integer hstmt
77587>>>>>        Local Integer iFetchResult
77587>>>>>
77587>>>>>        If (Num_Arguments < 3) ;            Move "" To sPassWord
77590>>>>>        If (Num_Arguments < 2) ;            Move "" To sUser
77593>>>>>
77593>>>>>        If (sUser <> "") ;            Move ("SERVER=" + Trim(sServer) + ";UID=" + Trim(sUser) + ";PWD=" + Trim(sPassword) + ";") To sConnect
77596>>>>>        Else ;            Move ("SERVER=" + Trim(sServer) + ";Trusted_Connection=yes") To sConnect
77598>>>>>
77598>>>>>        Object oEnumDBSQLmanager Is A cSQLHandleManager
77600>>>>>            Move Current_Object To hoSQL
77601>>>>>        End_Object // oEnumDBSQLManager
77602>>>>>
77602>>>>>        If (hoSQL <> 0) Begin
77604>>>>>            Get SQLConnect Of hoSQL "MSSQLDRV" sConnect To hdbc
77605>>>>>            If (hdbc <> 0) Begin
77607>>>>>                Get SQLOpen Of hdbc To hstmt
77608>>>>>                If (hstmt <> 0) Begin
77610>>>>>                    //*** We could do a direct select on the sysdatabases table but we use
77610>>>>>                    //*** the stored procedure sp_database instead. SQL Server recommends this
77610>>>>>                    //*** approach in case meta data might change, the stored procedure will
77610>>>>>                    //*** stay the same.
77610>>>>>                    Send SQLSetProcedureName To hstmt "sp_databases"
77611>>>>>                    Send SQLCall To hstmt
77612>>>>>                    Repeat
77612>>>>>>
77612>>>>>                        Get SQLFetch Of hstmt To iFetchResult
77613>>>>>                        If (iFetchResult <> 0) Begin
77615>>>>>                            Get SQLColumnValue Of hstmt 1 To sDatabase
77616>>>>>                            Set Value Item (Item_Count(Current_Object)) To sDatabase
77617>>>>>                        End
77617>>>>>>
77617>>>>>                    Until (iFetchResult = 0)
77619>>>>>
77619>>>>>                    Send SQLClose To hstmt
77620>>>>>                End
77620>>>>>>
77620>>>>>                Send SQLDisconnect To hdbc
77621>>>>>            End
77621>>>>>>
77621>>>>>        End
77621>>>>>>
77621>>>>>        Send Destroy_Object To hoSQL
77622>>>>>
77622>>>>>        Function_return (Item_Count(Current_Object))
77623>>>>>    End_Function // EnumerateDatabases
77624>>>>>
77624>>>>>End_Class // cMSSQLHandler
77625>>>>>
77625>>>
77625>>>String gsSrvConnUserID
77625>>>
77625>>>    Integer giDBCSqlcon                             // Handle de conexao global
77625>>>
77625>>>    Integer giSRVCONN 
77625>>>    String gsRptDatabaseName
77625>>>    String gsRptUserID
77625>>>    String gsRptPassword
77625>>>    
77625>>>    String gsRptServerNameBD
77625>>>    String gsBDDllConnect
77625>>>    String gsStrConnTemp 1000
77625>>>    String gsConnectionInfo 1000
77625>>>    
77625>>>    Get_Attribute DF_FILE_NEXT_EMPTY of giSRVCONN to giSRVCONN
77628>>>
77628>>>    Define MIN_ASC_BD for 32
77628>>>    Define MAX_ASC_BD For 126
77628>>>    Define NUM_ASC_BD For (MAX_ASC_BD - MIN_ASC_BD + 1)
77628>>>    Define NUM_PWD_BD For 9753
77628>>>
77628>>>    Function NumPwdBD Global String sPassword Returns Number
77630>>>        Number  nch
77630>>>        Number  nshift2
77630>>>        Integer iTemp
77630>>>        Integer istr_len
77630>>>        Number  nValue
77630>>>    
77630>>>        Move (Length(sPassword)) to iStr_len
77631>>>        For iTemp From 1 to iStr_len
77637>>>>
77637>>>            Move (Ascii(Mid(sPassword, 1, iTemp))) to nCh
77638>>>            Move (nch ^ 3 * nShift2) to nValue
77639>>>            Move ( Mod((nshift2 + 13), 23)) to nshift2
77640>>>        Loop
77641>>>>
77641>>>        Function_Return nValue
77642>>>    End_Function
77643>>>
77643>>>    Function ClearPwdBD Global String sPassword Returns String
77645>>>        UChar[] sChars
77646>>>        Integer iCount iSize
77646>>>        String sResult
77646>>>        
77646>>>        Move (StringToUCharArray("[]{}(),;?*!@ ")) to sChars
77647>>>        Move (SizeOfArray(sChars)) to iSize
77648>>>        Move sPassword to sResult
77649>>>        
77649>>>        For iCount from 0 to (iSize - 1)
77655>>>>
77655>>>            Move (Replaces(Character(sChars[iCount]), sResult, "")) to sResult
77656>>>        Loop
77657>>>>
77657>>>        
77657>>>        Function_Return sResult
77658>>>    End_Function
77659>>>
77659>>>    Function DeCriptPwdBD Global String Psenha Integer iKeyPass Returns String
77661>>>        String sRet
77661>>>        Number nOffset nTemp
77661>>>        Integer iStr_lenght
77661>>>        Integer iTemp
77661>>>        Integer ich
77661>>>        
77661>>>        Move (Rtrim(pSenha)) to pSenha
77662>>>        
77662>>>        If iKeyPass gt 1000 Begin
77664>>>            Move iKeyPass to nOffset
77665>>>        End
77665>>>>
77665>>>        Else Move (NumPwdBD(NUM_PWD_BD)) to nOffset
77667>>>    
77667>>>        Move (Length(Psenha)) to iStr_lenght
77668>>>        Move "" to sRet
77669>>>    
77669>>>        For iTemp From 1 to iStr_lenght
77675>>>>
77675>>>            Move (Ascii(Mid(Psenha, 1, iTemp))) to ich
77676>>>            If (ich = 134) Move 32 to ich
77679>>>            If ((ich >= MIN_ASC_BD) and (ich <= MAX_ASC_BD)) Begin
77681>>>                Move (iCh - MIN_ASC_BD) to ich
77682>>>                Move (Integer((NUM_ASC_BD + 1) * (nOffset+(1.5*iTemp)))) to nTemp
77683>>>    
77683>>>                Move (Mod((ich - nTemp),NUM_ASC_BD )) to ich
77684>>>            End
77684>>>>
77684>>>            If (ich < 0) Begin
77686>>>                Move (ich + NUM_ASC_BD) to iCh
77687>>>            End
77687>>>>
77687>>>            Move (ich + MIN_ASC_BD) to iCh
77688>>>            Move (sRet + Character(ich)) to sRet
77689>>>        Loop
77690>>>>
77690>>>        Function_Return sRet
77691>>>    End_Function      
77692>>>
77692>>>    
77692>>>    Function CriptpwdBD Global String Psenha Integer iKeyPass Returns String
77694>>>        String sRet
77694>>>        Number nOffset nTemp
77694>>>        Integer iStr_lenght
77694>>>        Integer iTemp
77694>>>        Integer ich
77694>>>        
77694>>>        Move (Trim(pSenha)) to pSenha
77695>>>        
77695>>>        If iKeyPass gt 1000 Begin
77697>>>            Move iKeyPass to nOffset
77698>>>        End
77698>>>>
77698>>>        Else Move (NumPwdBD(NUM_PWD_BD)) to nOffset
77700>>>    
77700>>>        Move (Length(Psenha)) to iStr_lenght
77701>>>        Move "" to sRet
77702>>>        For iTemp From 1 to iStr_lenght
77708>>>>
77708>>>            Move (Ascii(Mid(Psenha, 1, iTemp))) to ich
77709>>>    
77709>>>            If ((ich >= MIN_ASC_BD)and(iCh<=MAX_ASC_BD)) Begin
77711>>>                Move (ich - MIN_ASC_BD) to iCh
77712>>>                Move (Integer((NUM_ASC_BD + 1) * (nOffset+(1.5*iTemp)))) to nTemp
77713>>>                Move (Mod((ich + nTemp),NUM_ASC_BD )) to ich
77714>>>                Move (ich + MIN_ASC_BD) to ich
77715>>>                If (ich = 32) Move 134 to ich
77718>>>                Move ( sRet + Character(ich) ) to sRet
77719>>>            End
77719>>>>
77719>>>            Else Begin
77720>>>                Move ( (Trim(sRet))+  (Mid(Psenha, 1, iTemp)) ) to sRet
77721>>>            End
77721>>>>
77721>>>       Loop
77722>>>>
77722>>>       Function_Return sRet
77723>>>    End_Function
77724>>>
77724>>>        Handle  ghSQLMngr
77724>>>
77724>>>    
77724>>>    Object oSQLHandlerGeral is a cSQLHandleManager
77726>>>        Move Self to ghSQLMngr
77727>>>    End_Object
77728>>>    
77728>>>    // Indica a conexao de monitoramento (KeepAlive nÆo pode estar configurado para um valor muito grande)
77728>>>        Handle ghoConn
77728>>>
77728>>>Function DriverIndex String sDriver Returns Integer
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
77730>>>    String sCurrentDriver
77730>>>    Integer iDriver iNumDrivers
77730>>>
77730>>>    Get_Attribute DF_NUMBER_DRIVERS to iNumDrivers
77733>>>
77733>>>    For iDriver from 1 to iNumDrivers
77739>>>>
77739>>>        Get_Attribute DF_DRIVER_NAME of iDriver to sCurrentDriver
77742>>>        If (Uppercase(sDriver) = Uppercase(sCurrentDriver)) Begin
77744>>>            Function_Return iDriver
77745>>>        End
77745>>>>
77745>>>    Loop
77746>>>>
77746>>>
77746>>>    Function_Return 0
77747>>>End_Function
77748>>>
77748>>>Function FindConnectionID String sConnID Returns Boolean
#REM AMBIGUOUS METHODS ON .DESKTOP. ARE .NOT. RECOMMENDED (OBSOLETE TECHNIQUE)
77750>>>    Integer iDriver iNumConn iConn iConnOptions
77750>>>    String sConnString sID
77750>>>
77750>>>    Get DriverIndex gsBDDllConnect to iDriver
77751>>>
77751>>>    If (iDriver = 0) Begin
77753>>>        Function_Return False
77754>>>    End
77754>>>>
77754>>>
77754>>>    Get_Attribute DF_DRIVER_NUMBER_CONNECTION_IDS of iDriver to iNumConn
77757>>>
77757>>>    For iConn from 0 to (iNumConn - 1)
77763>>>>
77763>>>        Get_Attribute DF_DRIVER_CONNECTION_ID of iDriver iConn to sID
77766>>>        Get_Attribute DF_DRIVER_CONNECTION_ID_STRING of iDriver iConn to sConnString
77769>>>        Get_Attribute DF_DRIVER_CONNECTION_ID_OPTIONS of iDriver iConn to iConnOptions
77772>>>
77772>>>        If (Trim(Uppercase(sConnID)) = Trim(Uppercase(sID))) Function_Return True
77775>>>    Loop
77776>>>>
77776>>>
77776>>>    Function_Return False
77777>>>End_Function
77778>
77778>Define USE_APP
77778>
77778>
77778>Use DFAllEnt.pkg
77778>Use cCJStandardCommandBarSystem.pkg
Including file: cCJStandardCommandBarSystem.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cCJStandardCommandBarSystem.pkg)
77778>>>// these are all the packages used in a standard MDI menubar/toolbar system
77778>>>
77778>>>Use cCJCommandBarSystem.pkg
77778>>>Use cCJStandardMenuItemClasses.pkg
77778>>>Use cCJAboutMenuItem.pkg
Including file: cCJAboutMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cCJAboutMenuItem.pkg)
77778>>>>>Use cCJCommandBarSystem.pkg
77778>>>>>Use LanguageText.pkg
77778>>>>>
77778>>>>>// It is expected that if you use this class that you provide an about object that is
77778>>>>>// activated via activate_about such as DfAbout.pkg. We don't use this for you automatically
77778>>>>>// because you may wish to create your own custom about package.
77778>>>>>
77778>>>>>Class cCJAboutMenuItem is a cCJMenuItem    
77779>>>>>
77779>>>>>    Procedure Construct_Object
77781>>>>>        Forward Send Construct_Object
77783>>>>>        Set psCaption to C_$CaptionAbout
77784>>>>>        Set psDescription to C_$ToolTipAbout
77785>>>>>        Set psToolTip to C_$DescAbout
77786>>>>>        Set psImage to "ActionAbout.ico"
77787>>>>>        Set psCategory to C_$CategoryHelp
77788>>>>>    End_Procedure
77789>>>>>    
77789>>>>>    Procedure OnExecute Variant vCommandBarControl
77791>>>>>        Handle hoCommandBars hoClientArea
77791>>>>>        Get CommandBarSystemObject to hoCommandBars
77792>>>>>        Get ClientAreaObject of hoCommandBars to hoClientArea
77793>>>>>        If hoClientArea Begin
77795>>>>>            Send Activate_About of hoClientArea
77796>>>>>        End
77796>>>>>>
77796>>>>>    End_Procedure
77797>>>>>
77797>>>>>End_Class
77798>>>>>
77798>>>>>
77798>>>Use cCJDeoMenuItemClasses.pkg
77798>>>Use cCJMDIWindowsMenuItem.pkg
Including file: cCJMDIWindowsMenuItem.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cCJMDIWindowsMenuItem.pkg)
77798>>>>>Use cCJCommandBarSystem.pkg
77798>>>>>
77798>>>>>Register_Function Client_ID Returns Integer
77798>>>>>
77798>>>>>// only used by cCJMDIWIndowsMenuItem
77798>>>>>Class cCJMDIWindowItem is a cCJMenuItem
77799>>>>>
77799>>>>>    Procedure Construct_Object
77801>>>>>        Forward Send Construct_Object
77803>>>>>        Property Handle phWindow 0 // object id of view
77804>>>>>        Set pbControlFlagNoMovable to True
77805>>>>>        Set pbActiveUpdate to True
77806>>>>>    End_Procedure
77807>>>>>    
77807>>>>>    Procedure OnExecute Variant vCommandBarControl
77809>>>>>        Handle hWindow
77809>>>>>        Get phWindow to hWindow
77810>>>>>        Send Activate_View of hWindow
77811>>>>>    End_Procedure
77812>>>>>    
77812>>>>>End_Class                
77813>>>>>
77813>>>>>
77813>>>>>Class cCJMDIWindowsMenuItem is a cCJMenuItem
77814>>>>>    
77814>>>>>    Procedure Construct_Object
77816>>>>>        Forward Send Construct_Object
77818>>>>>        Property Handle[] phArrayOfWindows
77819>>>>>        Set peControlType to xtpControlPopup
77820>>>>>        Set psCategory to C_$CategoryWindow
77821>>>>>    End_Procedure
77822>>>>>    
77822>>>>>     // This adds MDI windows to the existing menu items.
77822>>>>>     // This removes any existing windows menus and always adds a new set to the end
77822>>>>>
77822>>>>>     Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
77824>>>>>        Handle  hClientArea hView
77824>>>>>        String  sLabel
77824>>>>>        Integer i iWindows
77824>>>>>        Handle[] hArrayOfWindows
77825>>>>>        Variant vItem
77825>>>>>        
77825>>>>>        // delete all windows actions and menu items. Assume we have an array of DF action objects for the windows
77825>>>>>        // also assume that destroying an action removes all menu instances of that action
77825>>>>>        Get phArrayOfWindows to hArrayOfWindows
77826>>>>>        Move (SizeOfArray(hArrayOfWindows)) to iWindows
77827>>>>>        For i from 0 to (iWindows-1)
77833>>>>>>
77833>>>>>            Send Destroy of hArrayOfWindows[i] // assume this removes all menu items of this action
77834>>>>>        Loop
77835>>>>>>
77835>>>>>        Move (ResizeArray(hArrayOfWindows,0)) to hArrayOfWindows
77836>>>>>
77836>>>>>        // Add all views to this menu. Create the action and add the item
77836>>>>>        Move 0 to i
77837>>>>>        Get Client_Id to hClientArea // object id of client area
77838>>>>>        If (hClientArea > 0) Begin
77840>>>>>            Get Next_Mdi_Dialog of hClientArea True to hView // find first view
77841>>>>>            While (hView <> 0)
77845>>>>>                If (Active_State(hView)) Begin
77847>>>>>                    // create the action
77847>>>>>                    Get Create U_cCJMDIWindowItem to hArrayOfWindows[i]
77848>>>>>                    Get Label of hView to sLabel // caption bar (name) of view
77849>>>>>                    Set psCaption of hArrayOfWindows[i] to sLabel
77850>>>>>                    Set psDescription of hArrayOfWindows[i] to ("Make this view (" - trim(sLabel) - ") the active window.")
77851>>>>>                    If (current_scope(desktop)=hView and View_mode(hView)<>VIEWMODE_ICONIZE) Begin
77853>>>>>                        Set pbChecked of hArrayOfWindows[i] to True
77854>>>>>                    End
77854>>>>>>
77854>>>>>                    Set phWindow of hArrayOfWindows[i] to hView // used by custom OnExecute
77855>>>>>                    If (i=0) Begin
77857>>>>>                        Set pbControlBeginGroup of hArrayOfWindows[i] to True
77858>>>>>                    End
77858>>>>>>
77858>>>>>                    // Create a menu item for this action
77858>>>>>                    Get AddDynamicControl of hArrayOfWindows[i] hCommandBarControls to vItem
77859>>>>>                    Increment i
77860>>>>>                End
77860>>>>>>
77860>>>>>                Get Next_Mdi_Dialog of hClientArea False to hView // find next
77861>>>>>            Loop
77862>>>>>>
77862>>>>>        End
77862>>>>>>
77862>>>>>
77862>>>>>        Set phArrayOfWindows to hArrayOfWindows
77863>>>>>
77863>>>>>     End_Procedure
77864>>>>>     
77864>>>>>End_Class
77865>>>>>
77865>
77865>Object oHtmlHelp is a cHtmlHelp
77867>End_Object
77868>
77868>Object oApplication is a cApplication
77870>    Set peHelpType to htHtmlHelp
77871>    Set psAutoOpenWorkspace to "sag-rm.ws"
77872>    
77872>    Procedure OnCreate 
77875>        String sVersionMajor sVersionMinor sVersionRelease sVersionBuild
77875>        Send DoOpenWorkspace CURRENT$WORKSPACE
77876>        
77876>        //Move 'M1A1' to gsCodUser
77876>        
Including file: Conexao.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\Conexao.pkg)
77876>>Define CK_VERSION for "6.1.0.18"
77876>>
77876>>Open "srvini" as giSRVCONN
77878>>Vfind giSRVCONN 0 ge
77880>>Get_Field_Value giSRVCONN  1 to gsRptServerNameBD
77883>>Get_Field_Value giSRVCONN  2 to gsRptDatabaseName
77886>>Get_Field_Value giSRVCONN  3 to gsRptUserID
77889>>Get_Field_Value giSRVCONN  4 to gsRptPassword 
77892>>Get_Field_Value giSRVCONN  5 to gsBDDllConnect
77895>>
77895>>Close giSRVCONN
77896>>
77896>>Move (Trim(gsRptServerNameBD))  to gsRptServerNameBD
77897>>Move (Trim(gsRptDatabaseName))  to gsRptDatabaseName
77898>>Move (Trim(gsRptUserID))        to gsRptUserID
77899>>Move (Trim(gsRptPassword))      to gsRptPassword
77900>>Move (Trim(gsBDDllConnect))     to gsBDDllConnect
77901>>
77901>>Move gsRptUserID to gsSrvConnUserID
77902>>
77902>>Move ("SERVER="+gsRptServerNameBD       +;        ";DATABASE="+gsRptDatabaseName  +;          ";UID="+gsRptUserID           +;          ";PWD="+gsRptPassword         +;          ";APP=SAG-RM" ) to gsStrConnTemp 
77903>>
77903>>//If (gbTeste = True) Begin
77903>>//    Move ("SERVER=localhost"    +;     
77903>>//          ";DATABASE=SAGRM" +;
77903>>//          ";UID=sa"     +;
77903>>//          ";PWD=sa99@!" +;
77903>>//          ";APP=SAGRM" ) to gsStrConnTemp 
77903>>//End
77903>>//Else Begin
77903>>//    Move ("SERVER=10.1.1.251"    +;     
77903>>//          ";DATABASE=SAGATE" +;
77903>>//          ";UID=sa"     +;
77903>>//          ";PWD=sa99123@!" +;
77903>>//          ";APP=SAG-RM" ) to gsStrConnTemp 
77903>>//End
77903>>
77903>>//Move "MSSQLDRV" to gsBDDllConnect   
77903>>Move gsRptDatabaseName  to gsRptServerNameBD
77904>>Move gsBDDllConnect     to gsBDDllConnect
77905>>
77905>>Load_Driver gsBDDllConnect
77906>>Logout gsBDDllConnect gsRptServerNameBD
77907>>
77907>>Integer iConnResult iDriver
77907>>
77907>>
77907>>Get DriverIndex gsBDDllConnect to iDriver
77908>>Set_Attribute DF_DRIVER_DEFAULT_TABLE_CHARACTER_FORMAT of iDriver to "Ansi"
77911>>Set_Attribute DF_DRIVER_APPLICATION_CHARACTER_FORMAT of iDriver to "OEM"
77914>>Set_Attribute DF_DRIVER_DEFAULT_MAP_DF_TO_SQL_TYPE_SCHEMA of iDriver to MAP_DF_TO_SQL_TYPE_SQL2005
77917>>Set_Attribute DF_DRIVER_FIND_CACHE_TIMEOUT of iDriver to 15000
77920>>Set_Attribute DF_DRIVER_USE_CACHE of iDriver to True
77923>>Set_Attribute DF_DRIVER_USE_CACHE_EXPIRATION of iDriver to False
77926>>Set_Attribute DF_DRIVER_IGNORE_WARNINGS of iDriver to True
77929>>Set_Attribute DF_TRANABORT_ONERROR to True
77932>>
77932>>// Locks (Tratativa para eliminar processamento desnecessÿrio)
77932>>Set_Attribute DF_LOCK_DELAY to 200
77935>>Set_Attribute DF_LOCK_TIMEOUT to 3000
77938>>Set_Transaction_Retry to 15
77939>>>
77939>>
77939>>Handle hoCLI
77939>>Get Create U_cMSSQLHandler to hoCLI
77940>>
77940>>If (hoCLI <> 0) Begin
77942>>    Boolean bIDExist
77942>>    String sRevision
77942>>    
77942>>    Get CKRevision of hoCLI to sRevision
77943>>    If (sRevision <> CK_VERSION) Begin
77945>>        Send Stop_Box ("VersÆo do Connectivity Kit instalada nÆo ‚ a correta.\n\nVersÆo encontrada: " + sRevision + "\nVersÆo requerida: " + CK_VERSION) "VersÆo CK"
77946>>        Abort
77947>>>
77947>>    End
77947>>>
77947>>
77947>>    Set psDriverID of hoCLI to gsBDDllConnect
77948>>
77948>>    // Verifica para substituir o ID
77948>>    Get FindConnectionID gsRptDatabaseName to bIDExist
77949>>    If (bIDExist) Begin
77951>>        Get DeleteConnectionID of hoCLI gsRptDatabaseName -1 to iConnResult
77952>>    End
77952>>>
77952>>
77952>>    // Cria o novo ID
77952>>    Get CreateConnectionID of hoCLI gsRptDatabaseName gsStrConnTemp 1 to iConnResult
77953>>End
77953>>>
77953>>
77953>>Send SQLSetConnect of ghSQLMngr gsBDDllConnect gsStrConnTemp
77954>>Move gsStrConnTemp to gsConnectionInfo
77955>>
77955>>// Conexao de monitoramento de atividade
77955>>Open GQUERIES
Including file: GQUERIES.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GQUERIES.fd)
77957>>Get SQLFileConnect of ghSQLMngr GQUERIES.File_Number to ghoConn
77958>>Move ghoConn to giDBCSqlcon
77959>>
77959>>
77959>>Open GSEQ
Including file: GSEQ.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GSEQ.fd)
77961>>Move GSEQ.File_Number to ghoDDSeq
77962>      
77962>        
77962>        Move "SourceIn - GestÆo de Neg¢cios" to gsCompany
77963>        Move "SAG - Sistema Suxiliar de GestÆo" to gsProduct
77964>        Set psCompany to gsCompany
77965>        Set psProduct to gsProduct
77966>        
77966>        Get phoVersionInfo to ghoVersionInfo
77967>        Get piVersionMajor of ghoVersionInfo to sVersionMajor
77968>        Get piVersionMinor of ghoVersionInfo to sVersionMinor
77969>        Get piVersionRelease of ghoVersionInfo to sVersionRelease
77970>        Get piVersionBuild of ghoVersionInfo to sVersionBuild
77971>        Move (sVersionMajor+'.'+sVersionMinor+'.'+sVersionRelease+'_'+sVersionBuild) to gsVersaoSys
77972>        
77972>    End_Procedure
77973>End_Object
77974>
77974>Object oToolTipController is a cToolTipController
77976>    Move Self to ghoToolTipController
77977>End_Object
77978>
77978>Use oEditContextMenu.pkg
77978>Use oDEOEditContextMenu17.pkg
77978>
77978>Object oMain is a Panel
77980>    Set Label to ("SAG-CFG - Configurador v."+gsVersaoSys+" - SourceIn")
77981>    Set Location to 4 3
77982>    Set Size to 300 450
77983>
77983>    Object oCommandBarSystem is a cCJCommandBarSystem
77985>        Set pbTimerUpdate to True
77986>
77986>        Procedure OnCreateCommandBars
77989>            Handle hoOptions
77989>            Get OptionsObject to hoOptions
77990>            Forward Send OnCreateCommandBars
77992>        End_Procedure
77993>   
77993>        Object oMenuBar is a cCJMenuBar
77995>            
77995>            Object oFileMenu is a cCJMenuItem
77997>                Set peControlType to xtpControlPopup          
77998>                Set psCaption   to "&Arquivo"
77999>                Set psDescription to  "Localizar, gravar, excluir, limpar informa‡Æo ou sair desta aplica‡Æo"
78000>                Set psCategory to "Menus"
78001>    
78001>                Object oClearMenuItem is a cCJClearMenuItem
78003>                    Set pbAddToDesignerMenu to True
78004>                End_Object
78005>    
78005>                Object oClearAllMenu is a cCJClearAllMenuItem
78007>                    Set pbAddToDesignerMenu to True
78008>                End_Object
78009>    
78009>                Object oPromptMenuItem is a cCJPromptMenuItem
78011>                    Set pbAddToDesignerMenu to True
78012>                    Set pbControlBeginGroup to True
78013>                End_Object
78014>    
78014>                Object oFindMenuItem is a cCJFindMenuItem
78016>                    Set pbAddToDesignerMenu to True
78017>                    Set pbControlBeginGroup to True
78018>                End_Object
78019>    
78019>                Object oFindNextMenu is a cCJFindNextMenuItem
78021>                    Set pbAddToDesignerMenu to True
78022>                End_Object
78023>    
78023>                Object oFindPreviousMenu is a cCJFindPreviousMenuItem
78025>                    Set pbAddToDesignerMenu to True
78026>                End_Object
78027>    
78027>                Object oFindFirstMenu is a cCJFindFirstMenuItem
78029>                    Set pbAddToDesignerMenu to True
78030>                End_Object
78031>    
78031>                Object oFindLastMenu is a cCJFindLastMenuItem
78033>                    Set pbAddToDesignerMenu to True
78034>                End_Object
78035>    
78035>                Object oSaveMenuItem is a cCJSaveMenuItem
78037>                    Set pbAddToDesignerMenu to True
78038>                    Set pbControlBeginGroup to True
78039>                End_Object
78040>    
78040>                Object oDeleteMenuItem is a cCJDeleteMenuItem
78042>                    Set pbAddToDesignerMenu to True
78043>                End_Object
78044>    
78044>                Object oExitMenu is a cCJExitMenuItem
78046>                    Set pbControlBeginGroup to True
78047>                End_Object
78048>
78048>            End_Object
78049>            
78049>            Object oViewMenu is a cCJMenuItem
78051>                Set peControlType to xtpControlPopup
78052>                Set psCaption to "&View"
78053>                Set psToolTip to "View"
78054>                Set psDescription to "Views dispon¡veis"
78055>
78055>                Object oCadastrodeObjetosMenuItem is a cCJMenuItem
78057>                    Set psCaption to "Cadastro de Objetos"
78058>                    Set psTooltip to "Cadastro de Objetos"
78059>                    Set pbEnabled to gbLoginCfg
78060>                
78060>                    Procedure OnExecute Variant vCommandBarControl
78063>                        Handle hoClient
78063>                        Get Client_Id to hoClient
78064>                        Send Activate_oVWCADOBJETOS of hoClient
78065>                    End_Procedure
78066>                End_Object
78067>
78067>                Object oCadastrodaempresaMenuItem is a cCJMenuItem
78069>                    Set psCaption to "Cadastro da empresa"
78070>                    Set psTooltip to "Cadastro da empresa"
78071>                    Set pbEnabled to gbLoginCfg
78072>                
78072>                    Procedure OnExecute Variant vCommandBarControl
78075>                        Handle hoClient
78075>                        Get Client_Id to hoClient
78076>                        Send Activate_oVWEMPRESA of hoClient
78077>                    End_Procedure
78078>                End_Object
78079>
78079>                Procedure OnPopupInit Variant vCommandBarControl Handle hoCommandBarControls
78082>                    Forward Send OnPopupInit vCommandBarControl hoCommandBarControls
78084>                    Set pbEnabled of oCadastrodeObjetosMenuItem to gbLoginCfg
78085>                    Set pbEnabled of oCadastrodaempresaMenuItem to gbLoginCfg
78086>                End_Procedure
78087>
78087>            End_Object
78088>            
78088>            Object oReportMenu is a cCJMenuItem
78090>                Set peControlType to xtpControlPopup          
78091>                Set psCaption to "&Relat¢rio"
78092>                Set psToolTip to "Relat¢rio"
78093>                Set psDescription to "Relat¢rios dispon¡veis"
78094>            End_Object
78095>            
78095>            Object oNavigateMenu is a cCJMenuItem
78097>                Set peControlType to xtpControlPopup      
78098>                Set psCaption to "&Navega‡Æo"    
78099>                Set psTooltip to "Navega‡Æo"    
78100>                Set psDescription to "Posicionar em diferentes  reas da aplica‡Æo"
78101>                
78101>                Object oNextAreaMenu is a cCJNextAreaMenu
78103>                End_Object
78104>                
78104>                Object oPriorAreaMenu is a cCJPriorAreaMenu
78106>                End_Object
78107>                
78107>                Object oNextViewMenu is a cCJNextViewMenu
78109>                End_Object
78110>                
78110>                Object oPriorViewMenu is a cCJPriorViewMenu
78112>                End_Object
78113>                
78113>                Object oPromptMenu is a cCJPromptMenuItem
78115>                    Set pbControlBeginGroup to True
78116>                End_Object
78117>    
78117>                Object oZoomMenu is a cCJZoomMenuItem
78119>                End_Object
78120>    
78120>            End_Object
78121>    
78121>            Object oWindowMenu is a cCJMDIWindowsMenuItem
78123>                Set peControlType to xtpControlPopup      
78124>                Set psCaption to "&Janela"
78125>                Set psToolTip to "Janela"
78126>                Set psDescription to "Mostrar views atuais e configurar outras op‡äes de apresenta‡Æo"    
78127>                
78127>                // These are the static windows items. More will be created in onInitPopup 
78127>                Object oDisplayOptionsMenu is a cCJMenuItem
78129>                    Set peControlType to xtpControlPopup          
78130>                    Set psCaption to "Op‡äes de &apresenta‡Æo"
78131>                    Set psToolTip to "Op‡äes de apresenta‡Æo"
78132>                    Set psDescription to "Configurar modo de apresenta‡Æo"
78133>    
78133>                    Object oStatusbarMenu is a cCJStatusbarMenuItem
78135>                    End_Object
78136>    
78136>                    Object oAutoArrangeIconsMenu is a cCJAutoArrangeIconsMenuItem
78138>                    End_Object
78139>    
78139>                    Object oRestoreMenusMenu is a cCJRestoreMenusMenuItem
78141>                        Set pbControlBeginGroup to True
78142>                    End_Object
78143>
78143>                End_Object
78144>    
78144>                Object oCascadeMenu is a cCJCascadeMenuItem
78146>                    Set pbControlBeginGroup to True
78147>                End_Object
78148>    
78148>                Object oHorizTile is a cCJTileHorizontally
78150>                End_Object
78151>    
78151>                Object oVertTile is a cCJTileVertically
78153>                End_Object
78154>    
78154>                Object oMinimizeMenuItem is a cCJMinimizeWindowsMenuItem
78156>                    Set pbControlBeginGroup to True
78157>                End_Object
78158>    
78158>                Object oRestoreMenuItem is a cCJRestoreWindowsMenuItem
78160>                End_Object
78161>    
78161>                Object oArrangeIconsMenuItem is a cCJAutoArrangeIconsMenuItem
78163>                    Set pbControlBeginGroup to True
78164>                End_Object
78165>    
78165>            End_Object
78166>            
78166>            Object oHelpMenu is a cCJMenuItem
78168>                Set peControlType to xtpControlPopup    
78169>                Set psCaption to "Aj&uda"
78170>                Set psDescription to "Acessar informa‡Æo para aprendizado e uso desta aplica‡Æo DataFlex"
78171>                Set psToolTip to "Ajuda"
78172>                
78172>                Object oHelpMenuItem is a cCJHelpMenuItem 
78174>                End_Object
78175>    
78175>                Object oAboutMenuItem is a cCJAboutMenuItem
78177>                End_Object
78178>           
78178>            End_Object
78179>    
78179>        End_Object
78180>    
78180>        Object oFindToolBar is a cCJToolbar
78182>            Set psTitle to "Barra de ferramentas de busca"
78183>    
78183>            Object oFindFirstTool is a cCJFindFirstMenuItem
78185>            End_Object
78186>    
78186>            Object oFindPreviousTool is a cCJFindPreviousMenuItem
78188>            End_Object
78189>    
78189>            Object oFindMenuTool is a cCJFindMenuItem
78191>            End_Object
78192>    
78192>            Object oFindNextTool is a cCJFindNextMenuItem
78194>            End_Object
78195>    
78195>            Object oFindLastTool is a cCJFindLastMenuItem
78197>            End_Object
78198>    
78198>            Object oPromptToolItem is a cCJPromptMenuItem
78200>                Set pbControlBeginGroup to True
78201>            End_Object
78202>    
78202>        End_Object
78203>            
78203>        Object oFileToolBar is a cCJToolbar
78205>            Set psTitle to "Barra de ferramentas de entrada de dados"
78206>    
78206>            Object oClearToolItem is a cCJClearMenuItem
78208>                Set peControlStyle to xtpButtonIconAndCaption
78209>            End_Object
78210>            
78210>            Object oClearAllToolItem2 is a cCJClearAllMenuItem
78212>                Set peControlStyle to xtpButtonIconAndCaption
78213>            End_Object
78214>                
78214>            Object oSaveToolItem is a cCJSaveMenuItem
78216>                Set peControlStyle to xtpButtonIconAndCaption
78217>                Set pbControlBeginGroup to True
78218>            End_Object
78219>    
78219>            Object oDeleteToolItem is a cCJDeleteMenuItem
78221>                Set peControlStyle to xtpButtonIconAndCaption
78222>            End_Object
78223>    
78223>        End_Object
78224>    
78224>        Object oEditToolBar is a cCJToolbar
78226>            Set psTitle to "Barra de ferramentas de edi‡Æo"
78227>            
78227>            Object oCutToolbarItem is a cCJCutMenuItem
78229>            End_Object
78230>    
78230>            Object oCopyToolbarItem is a cCJCopyMenuItem
78232>            End_Object
78233>    
78233>            Object oPasteToolbarItem is a cCJPasteMenuItem
78235>            End_Object
78236>    
78236>            Object oDeleteEditToolbarItem is a cCJDeleteEditMenuItem
78238>                Set pbControlBeginGroup to True
78239>            End_Object
78240>    
78240>        End_Object
78241>
78241>        Object oRememberToolbar is a cCJToolbar
78243>            Set psTitle to C_$Remember
78244>
78244>            Object oRememberItems is a cCJMenuItem
78246>
78246>                Set peControlType to xtpControlPopup
78247>                Set peControlStyle to xtpButtonCaption
78248>                Set psCaption to C_$Remember
78249>                
78249>                Object oMenuItem is a cCJRememberFieldMenuItem
78251>                    Set peControlStyle to xtpButtonIconAndCaption
78252>                End_Object
78253>                
78253>                Object oMenuItem is a cCJRememberLastFieldMenuItem
78255>                    Set peControlStyle to xtpButtonIconAndCaption
78256>                End_Object
78257>                
78257>                Object oMenuItem is a cCJUnRememberFieldMenuItem
78259>                    Set peControlStyle to xtpButtonIconAndCaption
78260>                End_Object
78261>                
78261>                Object oMenuItem is a cCJUnRememberFieldAllMenuItem
78263>                    Set peControlStyle to xtpButtonIconAndCaption
78264>                End_Object
78265>
78265>            End_Object
78266>            
78266>        End_Object
78267>        
78267>        Object oStatusBar is a cCJStatusBar
78269>            
78269>            Object oStatusPane1 is a cCJStatusBarPane
78271>                Set piID to sbpIDIdlePane
78272>                Set pbStyleStretch to True
78273>            End_Object
78274>    
78274>            Object oStatusPane2 is a cCJStatusBarPane
78276>                Set phoViewPane to Self
78277>                Set pbStyleStretch to True
78278>            End_Object
78279>
78279>        End_Object
78280>    
78280>    End_Object
78281>
78281>    Object oClientArea is a ClientArea
78283>        Use StdAbout.pkg
Including file: StdAbout.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\StdAbout.pkg)
78283>>>//************************************************************************
78283>>>// Confidential Trade Secret.
78283>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
78283>>>// as an unpublished work.  All rights reserved.
78283>>>// DataFlex is a registered trademark of Data Access Corporation.
78283>>>//
78283>>>//************************************************************************
78283>>>//************************************************************************
78283>>>//
78283>>>// $File name  : StdAbout.pkg
78283>>>// $File title : Standard about object package for VDF
78283>>>// Notice      :
78283>>>// $Author(s)  : John Tuohy
78283>>>//
78283>>>// $Rev History
78283>>>//
78283>>>// JT 06/27/97   File created
78283>>>//************************************************************************
78283>>>
78283>>>// This provides a quick and simple way to create an about package for a program.
78283>>>// You need to create a message inside you client area called Activate_About.
78283>>>// Within this message you should send the message DoAbout passing needed
78283>>>// string information.
78283>>>//
78283>>>//       Procedure Activate_About
78283>>>//           Send DoAbout sTitle sVersion sCopyright sAuthor sBitmap
78283>>>//       End_Procedure
78283>>>//    where: sTitle =     Name of application. If none provided, uses caption
78283>>>//                        bar title
78283>>>//           sVersion   = Version Line. If none provided, will be blank
78283>>>//           sCopyRight = Copyright Line. If none provided, will be blank
78283>>>//           sAuthor    = Author name, blank if none provided
78283>>>//           sBitMap    = Bitmap logo. If none provided, standard VDF bitmap
78283>>>//                        is used.
78283>>>// It is expected that you will place this in your own object package. For
78283>>>// example an order about package may look like this:
78283>>>//
78283>>>//   // OrderAbout.pkg
78283>>>//   Use StdAbout.pkg
78283>>>//   Procedure Activate_About
78283>>>//      String sTitle sCopyright sVersion sAuthor
78283>>>//      Move "My Order Entry System" to sTitle
78283>>>//      Move "Version 2.1" to sVersion
78283>>>//      Move "Copyright 1997, Super Software Inc." to sCopyright
78283>>>//      Move "John Smith"  to sAuthor
78283>>>//      Send DoAbout sTitle sVersion sCopyright sAuthor ""
78283>>>//   end_procedure
78283>>>//   // end of file.
78283>>>
78283>>>Use DfAbout.pkg
Including file: Dfabout.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\Dfabout.pkg)
78283>>>>>//************************************************************************
78283>>>>>// Confidential Trade Secret.
78283>>>>>// Copyright (c) 1997 Data Access Corporation, Miami Florida
78283>>>>>// as an unpublished work.  All rights reserved.
78283>>>>>// DataFlex Is A registered trademark Of Data Access Corporation.
78283>>>>>//
78283>>>>>//************************************************************************
78283>>>>>//************************************************************************
78283>>>>>//
78283>>>>>// $File name  : DfAbout.pkg
78283>>>>>// $File title : About class support
78283>>>>>// Notice      :
78283>>>>>// $Author(s)  : Vincent Oorsprong, Ken Ross
78283>>>>>//
78283>>>>>// $Rev History
78283>>>>>//
78283>>>>>// VOO 02/22/2012 Replaced obsolete code, improved Network_User_Name by asking
78283>>>>>//                Windows for the size first. 
78283>>>>>// VOO 07/25/2003 Removed OnResize procedure for sysinfo dialog. Replaced logic
78283>>>>>//                with anchor technique. Removed unnessary property in the
78283>>>>>//                sysinfo dialog. Changed the size Of the about & sysinfo dialog
78283>>>>>//                object To better look in Windows XP. Repositioned the close
78283>>>>>//                button in the sysinfo dialog To line up with the display area
78283>>>>>//                Replaced obsolete code and techniques. Removed dead code.
78283>>>>>// JJT 10/23/2001 removed all ghoworkspace support. Uses app object or nothing
78283>>>>>// SWB 07/19/01   Added support Of the Application object in preference to
78283>>>>>//                the global Workspace object, if it is present
78283>>>>>// JJT 11/05/98   Added version information
78283>>>>>// VOO 29/10/98   Replaced the GetFreeSystemResources for the Win32 variant
78283>>>>>// JJT 7/31/97    Registered Enumerate Workspace so dfabout can exist without
78283>>>>>//                workspace package.
78283>>>>>// JJT 6/27/97    Turned the sysinfo objects into classes so the AboutDialog
78283>>>>>//                class can create this object.
78283>>>>>//                Cleaned up the interface (used correct classes and messages)
78283>>>>>//                Added workspace reporting support To sys-info.
78283>>>>>//                Turned off wrapping in the sys-info editor.
78283>>>>>// KR  ??/??/96   File created
78283>>>>>//************************************************************************
78283>>>>>Use LanguageText.pkg
78283>>>>>Use Windows.pkg
78283>>>>>Use DFbitmap.pkg
78283>>>>>Use GlobalFunctionsProcedures.pkg
78283>>>>>Use cTextEdit.pkg
78283>>>>>
78283>>>>>Use cli.pkg
78283>>>>>Use DFBTRDRV.PKG
Including file: DFBTRDRV.PKG    (C:\Program Files (x86)\DataFlex 18.1\Pkg\DFBTRDRV.PKG)
78283>>>>>>>//****************************************************************************
78283>>>>>>>//
78283>>>>>>>// $File name  : DFBTRDRV.PKG
78283>>>>>>>// $File title : Package for the DataFlex Connectivity Kit for Pervasive.SQL
78283>>>>>>>// Notice      : This package contains constants and commands, used to call
78283>>>>>>>//               specific functions in the DFBTRDRV.
78283>>>>>>>// $Author(s)  : Eddy Kleinjan
78283>>>>>>>//
78283>>>>>>>// $System     : DataFlex Connectivity Kit for Pervasive.SQL
78283>>>>>>>// Created     : 01-07-97 @ 12:00:00
78283>>>>>>>//
78283>>>>>>>// Changed     : 04-04-2001.
78283>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.145
78283>>>>>>>//
78283>>>>>>>// Changed     : June 6, 2001
78283>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.148
78283>>>>>>>//
78283>>>>>>>//               Added DFBTR_DDF_OWNER command.
78283>>>>>>>//
78283>>>>>>>// Changed     : June 12, 2001
78283>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 1.3.0.149
78283>>>>>>>//
78283>>>>>>>//               Added DF_FIELD_IS_NULL and DF_FIELD_NULL_ALLOWED attributes
78283>>>>>>>//
78283>>>>>>>// Changed     : August 4, 2004
78283>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.1
78283>>>>>>>//
78283>>>>>>>//               Added cDfbtrdrvHandler class.
78283>>>>>>>//               New functions in this class:
78283>>>>>>>//                  Function CKRevision Returns String
78283>>>>>>>//                  Function CkUsesUri Returns Integer
78283>>>>>>>//                  Function PSQLRequesterVersionInfo Integer iFileNum Returns String
78283>>>>>>>//                  Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
78283>>>>>>>//                  Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
78283>>>>>>>//
78283>>>>>>>// Changed     : September 30, 2005
78283>>>>>>>//               DataFlex Connectity Kit for Pervasive.SQL version 3.0.0.14
78283>>>>>>>//
78283>>>>>>>//               Bugfix: Prevent compiler errors when no (df)error.pkg is used
78283>>>>>>>//****************************************************************************
78283>>>>>>>Use Ui
78283>>>>>>>//
78283>>>>>>>// Driver Indentification
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//*** Driver attributes
78283>>>>>>>//
78283>>>>>>>// Call_Driver functions ID's
78283>>>>>>>//
78283>>>>>>>//
78283>>>>>>>// DFBTRFN_CONVERT_FILE options
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// DFBTRFN_SET_OWNER options
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// DFBTRFN_SET_TRANSACTION_TYPE options
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to create all vars which may be needed
78283>>>>>>>// in other commands.
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to set the owner of a Btrieve file.
78283>>>>>>>// File must have been opened.
78283>>>>>>>// Filenumber needs to be passed.
78283>>>>>>>// To clear set the owner to "".
78283>>>>>>>// Examples:
78283>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret"
78283>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY CALLBACK MyCallBack
78283>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" ENCRYPT
78283>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to "Secret" READONLY ENCRYPT CALLBACK MyCallBack
78283>>>>>>>// To clear:
78283>>>>>>>//      DFBTR_SET_OWNER MyFileNumber to ""
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to parse DFBTR_SET_OWNVER
78283>>>>>>>// options.
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to parse for Callback
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to clear the owner of a Btrieve file.
78283>>>>>>>// File must have been opened.
78283>>>>>>>// Filenumber needs to be passed.
78283>>>>>>>// Examples:
78283>>>>>>>//      DFBTR_CLEAR_OWNER MyFileNumber
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to add a owner name to the internal list of ownernames
78283>>>>>>>// which will be tries when opening files.
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to remove all owners from the internal list of ownernames
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to set the owner name to be used when opening the DDF files.
78283>>>>>>>// The DDF owner is required when Pervasive.SQL security is turned on.
78283>>>>>>>// The DDF owner is equal to the password of the Master user in Pervasive.SQL
78283>>>>>>>// This command overwrites the DDF_OWNER setting in DFBTRDRV.INT
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to change the transaction type.
78283>>>>>>>// Valid types are:
78283>>>>>>>//     DFBTRTT_NONE
78283>>>>>>>//     DFBTRTT_EXCLUSIVE
78283>>>>>>>//     DFBTRTT_CONCURRENT
78283>>>>>>>//
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to get the current transaction type.
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to set explicit_locking
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to get explicit locking
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to set detection for incompatible positive signs in numeric fields
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//
78283>>>>>>>// Command to get detection for incompatible positive signs in numeric fields
78283>>>>>>>//
78283>>>>>>>
78283>>>>>>>//*****************************************************************************
78283>>>>>>>//*** Class  : cDfbtrdrvHandler                                                  ***
78283>>>>>>>//*** Purpose: An instance of this class can be used as a broker object to  ***
78283>>>>>>>//***          call several Dfbtrdrv releated methods.                           ***
78283>>>>>>>//*****************************************************************************
78283>>>>>>>
78283>>>>>>>Class cDFBtrDrvHandler Is An Array
78284>>>>>>>
78284>>>>>>>    Procedure Construct_Object Integer iImage
78286>>>>>>>        Forward Send Construct_object iImage
78288>>>>>>>
78288>>>>>>>        Property String  psDriverID       Public "DFBTRDRV"
78289>>>>>>>    End_Procedure // Construct_Object
78290>>>>>>>
78290>>>>>>>
78290>>>>>>>
78290>>>>>>>    //***
78290>>>>>>>    //*** Function: CKRevsion
78290>>>>>>>    //*** Purpose : The revsion of a Dfbtrdrv Connectivity Kit
78290>>>>>>>    //***
78290>>>>>>>
78290>>>>>>>    Function CKRevision Returns String
78292>>>>>>>        Local String  sDriverID
78292>>>>>>>        Local String  sRevision
78292>>>>>>>        Local String  sVoid
78292>>>>>>>        Local Integer iRetval
78292>>>>>>>
78292>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
78292>>>>>>>        // This error would otherwise be raised when we have an older
78292>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
78292>>>>>>>        Send Ignore_error To Error_object_Id 20491
78293>>>>>>>        Get psDriverID To sDriverID
78294>>>>>>>        Move (Repeat(" ", 255)) To sRevision
78295>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKREVISION Callback 0 Passing sRevision sVoid 0 Result iRetval
78300>>>>>>>        Send Trap_Error To Error_object_Id 20491
78301>>>>>>>        If (Trim(sRevision) = "") Begin
78303>>>>>>>            // Unable to get the revision. return all zeroes.
78303>>>>>>>            Move "0.0.0.0" To sRevision
78304>>>>>>>        End
78304>>>>>>>>
78304>>>>>>>        Function_Return sRevision
78305>>>>>>>    End_Function // CKRevision
78306>>>>>>>
78306>>>>>>>    Function CkUsesUri Returns Integer
78308>>>>>>>        Local String  sDriverID
78308>>>>>>>        Local String  sVoid1
78308>>>>>>>        Local String  sVoid2
78308>>>>>>>        Local Integer iRetval
78308>>>>>>>
78308>>>>>>>        Get psDriverID To sDriverID
78309>>>>>>>
78309>>>>>>>        Move 0 To iRetval
78310>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
78310>>>>>>>        // This error would otherwise be raised when we have an older
78310>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKUSESURI function
78310>>>>>>>        Send Ignore_error To Error_object_Id 20491
78311>>>>>>>        Call_Driver 0 sDRiverID Function DFBTRFN_CKUSESURI Callback 0 Passing sVoid1 sVoid2 0 Result iRetval
78316>>>>>>>        Send Trap_Error To Error_object_Id 20491
78317>>>>>>>
78317>>>>>>>        Function_Return iRetval
78318>>>>>>>    End_Function // CKUsesUri
78319>>>>>>>
78319>>>>>>>
78319>>>>>>>
78319>>>>>>>    //***
78319>>>>>>>    //*** Function: ExtractPartFromRevsion
78319>>>>>>>    //*** Purpose : Extarct the Nth part of a a.b.c.d revsion string.
78319>>>>>>>    //***
78319>>>>>>>    //*** Returns : The part version number or -1 if there is no such part number.
78319>>>>>>>    //***
78319>>>>>>>
78319>>>>>>>    Function ExtractPartFromRevision Integer iPartNum String sRevision Returns Integer
78321>>>>>>>        Local Integer iPartRev
78321>>>>>>>        Local Integer iCurrentPart
78321>>>>>>>        Local Integer iSeparatorPos
78321>>>>>>>
78321>>>>>>>        If (iPartNum > 4) ;            Function_Return -1
78324>>>>>>>
78324>>>>>>>        Move 0 To iCurrentPart
78325>>>>>>>        Repeat
78325>>>>>>>>
78325>>>>>>>            Move (Pos(".", sRevision)) To iSeparatorPos
78326>>>>>>>            If (iSeparatorPos > 0) Begin
78328>>>>>>>                Move (Left(sRevision, iSeparatorPos - 1)) To iPartRev
78329>>>>>>>                Move (Right(sRevision, Length(sRevision) - iSeparatorPos)) To sRevision
78330>>>>>>>                Increment iCurrentPart
78331>>>>>>>            End
78331>>>>>>>>
78331>>>>>>>            Else If (sRevision <> "") Begin
78334>>>>>>>                Move sRevision To iPartRev
78335>>>>>>>                Move "" To sRevision
78336>>>>>>>                Increment iCurrentPart
78337>>>>>>>            End
78337>>>>>>>>
78337>>>>>>>            Else ;                Move -1 To iPartRev
78339>>>>>>>        Until (iCurrentPart >= iPartNum Or iPartRev = -1)
78341>>>>>>>
78341>>>>>>>        Function_Return iPartRev
78342>>>>>>>    End_Function // EcxtractPartFromRevision
78343>>>>>>>
78343>>>>>>>
78343>>>>>>>
78343>>>>>>>    //***
78343>>>>>>>    //*** Function: CKMajorRevision
78343>>>>>>>    //*** Purpose : Returns the major revision of the CK
78343>>>>>>>    //***
78343>>>>>>>
78343>>>>>>>    Function CKMajorRevision Returns Integer
78345>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 1, CKRevision(Current_Object)))
78346>>>>>>>    End_Function // CKMajorRevision
78347>>>>>>>
78347>>>>>>>
78347>>>>>>>
78347>>>>>>>    //***
78347>>>>>>>    //*** Function: CKMinorRevision
78347>>>>>>>    //*** Purpose : Returns the minor revision of the CK
78347>>>>>>>    //***
78347>>>>>>>
78347>>>>>>>    Function CKMinorRevision Returns Integer
78349>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 2, CKRevision(Current_Object)))
78350>>>>>>>    End_Function // CKMinorRevision
78351>>>>>>>
78351>>>>>>>
78351>>>>>>>
78351>>>>>>>    //***
78351>>>>>>>    //*** Function: CKReleaseRevision
78351>>>>>>>    //*** Purpose : Returns the release revision of the CK
78351>>>>>>>    //***
78351>>>>>>>
78351>>>>>>>    Function CKReleaseRevision Returns Integer
78353>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 3, CKRevision(Current_Object)))
78354>>>>>>>    End_Function // CKReleaseRevision
78355>>>>>>>
78355>>>>>>>
78355>>>>>>>
78355>>>>>>>    //***
78355>>>>>>>    //*** Function: CKBuildRevision
78355>>>>>>>    //*** Purpose : Returns the major revision of the CK
78355>>>>>>>    //***
78355>>>>>>>
78355>>>>>>>    Function CKBuildRevision Returns Integer
78357>>>>>>>        Function_Return (ExtractPartFromRevision (Current_Object, 4, CKRevision(Current_Object)))
78358>>>>>>>    End_Function // CKBuildRevision
78359>>>>>>>
78359>>>>>>>
78359>>>>>>>
78359>>>>>>>    //***
78359>>>>>>>    //*** Function: IsMinimalRevision
78359>>>>>>>    //*** Purpose : Determines if the CK conforms to a passed minimal revsion.
78359>>>>>>>    //***
78359>>>>>>>
78359>>>>>>>    Function IsMinimalRevision Integer iMajor Integer iMinor Integer iRelease Integer iBuild Returns Integer
78361>>>>>>>        If (iMajor < CKMajorRevision(Current_object)) ;            Function_return (TRUE)
78364>>>>>>>        Else If (iMajor = CKMajorRevision(Current_object)) Begin
78367>>>>>>>            If (iMinor < CKMinorRevision(Current_object)) ;                Function_return (TRUE)
78370>>>>>>>            Else If (iMinor = CKMinorRevision(Current_object)) Begin
78373>>>>>>>                If (iRelease < CKReleaseRevision(Current_object)) ;                    Function_return (TRUE)
78376>>>>>>>                Else If (iRelease = CKReleaseRevision(Current_object) And iBuild <= CKBuildRevision(Current_object)) ;                    Function_return (TRUE)
78380>>>>>>>            End
78380>>>>>>>>
78380>>>>>>>        End
78380>>>>>>>>
78380>>>>>>>
78380>>>>>>>        Function_Return (FALSE)
78381>>>>>>>    End_Function // IsMinimalRevision
78382>>>>>>>
78382>>>>>>>    //   Functions to query the Pervasive.SQL version:
78382>>>>>>>    //       PSQLRequesterVersionInfo    Integer iFileNum Returns String
78382>>>>>>>    //       PSQLLocalEngineVersionInfo  Integer iFileNum Returns String
78382>>>>>>>    //       PSQLServerEngineVersionInfo Integer iFileNum Returns String
78382>>>>>>>    //
78382>>>>>>>    //   All 3 functions return the version of a Pervasive.SQL component
78382>>>>>>>    //   in the following format:
78382>>>>>>>    //       <version>.<revision>.<type>
78382>>>>>>>    //   possible values for <type>:
78382>>>>>>>    //       9 for 32-bit Windows workstation/workgroup engine or Linux
78382>>>>>>>    //         server using Workgroup authentication mode
78382>>>>>>>    //       C for client cache engine
78382>>>>>>>    //       D for DOS workstation
78382>>>>>>>    //       N for client Requester
78382>>>>>>>    //       S for NetWare server
78382>>>>>>>    //       T for 32-bit Windows server engine
78382>>>>>>>    //       U for Linux server using PAM or BTPASSWD authentication
78382>>>>>>>    //
78382>>>>>>>    //   example:
78382>>>>>>>    //       8.50.T
78382>>>>>>>    //   will be returned for a Pervasive.SQL 8.5 Server Engine running on
78382>>>>>>>    //   32-bits Windows server.
78382>>>>>>>    //
78382>>>>>>>    //   The FileNumber parameter must specify an opened table or 0.
78382>>>>>>>    //   For PSQLServerEngineVersionInfo the FileNumber can not be 0.
78382>>>>>>>    //
78382>>>>>>>    //   If the version information is not available or can not be obtained
78382>>>>>>>    //   the functions will return "0.0.0"
78382>>>>>>>
78382>>>>>>>
78382>>>>>>>    //***
78382>>>>>>>    //*** Function: PSQLRequesterVersionInfo
78382>>>>>>>    //*** Purpose : Returns the version information of the
78382>>>>>>>    //***           Pervasive.SQL Client requester.
78382>>>>>>>
78382>>>>>>>    Function PSQLRequesterVersionInfo Integer iFileNum Returns String
78384>>>>>>>
78384>>>>>>>        Local String  sDriverID
78384>>>>>>>        Local String  sVersion
78384>>>>>>>        Local String  sVoid
78384>>>>>>>        Local Integer iRetval
78384>>>>>>>
78384>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
78384>>>>>>>        // This error would otherwise be raised when we have an older
78384>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
78384>>>>>>>        Send Ignore_error To Error_object_Id 20491
78385>>>>>>>        Get psDriverID To sDriverID
78386>>>>>>>        Move (Repeat(" ", 255)) To sVersion
78387>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLREQUESTERVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
78392>>>>>>>        Send Trap_Error To Error_object_Id 20491
78393>>>>>>>        If (Trim(sVersion) = "") Begin
78395>>>>>>>            // Unable to get the revision. return all zeroes.
78395>>>>>>>            Move "0.0.0" To sVersion
78396>>>>>>>        End
78396>>>>>>>>
78396>>>>>>>        Function_Return sVersion
78397>>>>>>>    End_Function //  PSQLRequesterVersion
78398>>>>>>>
78398>>>>>>>    //***
78398>>>>>>>    //*** Function: PSQLLocalEngineVersionInfo
78398>>>>>>>    //*** Purpose : Returns the version information of the
78398>>>>>>>    //***           Pervasive.SQL Local Engine
78398>>>>>>>
78398>>>>>>>    Function PSQLLocalEngineVersionInfo Integer iFileNum Returns String
78400>>>>>>>
78400>>>>>>>        Local String  sDriverID
78400>>>>>>>        Local String  sVersion
78400>>>>>>>        Local String  sVoid
78400>>>>>>>        Local Integer iRetval
78400>>>>>>>
78400>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
78400>>>>>>>        // This error would otherwise be raised when we have an older
78400>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
78400>>>>>>>        Send Ignore_error To Error_object_Id 20491
78401>>>>>>>        Get psDriverID To sDriverID
78402>>>>>>>        Move (Repeat(" ", 255)) To sVersion
78403>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLLOCALENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
78408>>>>>>>        Send Trap_Error To Error_object_Id 20491
78409>>>>>>>        If (Trim(sVersion) = "") Begin
78411>>>>>>>            // Unable to get the revision. return all zeroes.
78411>>>>>>>            Move "0.0.0" To sVersion
78412>>>>>>>        End
78412>>>>>>>>
78412>>>>>>>        Function_Return sVersion
78413>>>>>>>    End_Function //  PSQLLocalEngineVersion
78414>>>>>>>
78414>>>>>>>    //***
78414>>>>>>>    //*** Function: PSQLServerEngineVersionInfo
78414>>>>>>>    //*** Purpose : Returns the version information of the
78414>>>>>>>    //***           Pervasive.SQL Server Engine
78414>>>>>>>
78414>>>>>>>    Function PSQLServerEngineVersionInfo Integer iFileNum Returns String
78416>>>>>>>
78416>>>>>>>        Local String  sDriverID
78416>>>>>>>        Local String  sVersion
78416>>>>>>>        Local String  sVoid
78416>>>>>>>        Local Integer iRetval
78416>>>>>>>
78416>>>>>>>        // Ignore error 20491 DFBTRERR_INVALID_DRIVER_FUNCTION_CALL.
78416>>>>>>>        // This error would otherwise be raised when we have an older
78416>>>>>>>        // DFBTRDRV version that has no DFBTRFN_CKREVISION function
78416>>>>>>>        Send Ignore_error To Error_object_Id 20491
78417>>>>>>>        Get psDriverID To sDriverID
78418>>>>>>>        Move (Repeat(" ", 255)) To sVersion
78419>>>>>>>        Call_Driver iFileNum sDRiverID Function DFBTRFN_PSQLSERVERENGINEVERSIONINFO Callback 0 Passing sVersion sVoid 0 Result iRetval
78424>>>>>>>        Send Trap_Error To Error_object_Id 20491
78425>>>>>>>        If (Trim(sVersion) = "") Begin
78427>>>>>>>            // Unable to get the revision. return all zeroes.
78427>>>>>>>            Move "0.0.0" To sVersion
78428>>>>>>>        End
78428>>>>>>>>
78428>>>>>>>        Function_Return sVersion
78429>>>>>>>    End_Function //  PSQLServerEngineVersion
78430>>>>>>>
78430>>>>>>>End_Class // cDfbtrdrvHandler
78431>>>>>>>
78431>>>>>
78431>>>>>
78431>>>>>External_Function WNetGetUser "WNetGetUserA" MPR.DLL Pointer lpName Pointer lpUser_Name Pointer lpLength Returns DWord
78432>>>>>
78432>>>>>Register_Function phoWorkspace Returns Handle
78432>>>>>Register_Function Help_filename Returns String
78432>>>>>Register_Function GetHelpFile Returns String
78432>>>>>Register_Function pbEnterKeyAsTabKey Returns Boolean
78432>>>>>
78432>>>>>//****************************************************************************
78432>>>>>// $Module type: FUNCTION
78432>>>>>// $Module name: Network_User_Name
78432>>>>>// $Author     : AK/VOO/KCR
78432>>>>>// Created     : 09-24-96 @ 19:17
78432>>>>>//
78432>>>>>// Description
78432>>>>>//    This function reads the current username Of windows and returns that
78432>>>>>//    name or an text unknown user
78432>>>>>//
78432>>>>>// $Rev History
78432>>>>>//  02/22/2012  Ask Windows how long the size of the name should be
78432>>>>>//  07/25/2003  Replaced obsolete code
78432>>>>>//  09/24/1996  Module header created
78432>>>>>//****************************************************************************
78432>>>>>Function Network_User_Name for cDesktop Returns String
78434>>>>>    String sName
78434>>>>>    Integer iRetval iLength
78434>>>>>
78434>>>>>    Move 0 to iLength
78435>>>>>    Move (WNetGetUser (0, 0, AddressOf (iLength))) to iRetval
78436>>>>>    ZeroString iLength to sName
78437>>>>>    Move (WNetGetUser (0, AddressOf (sName), AddressOf (iLength))) to iRetval
78438>>>>>
78438>>>>>    If (iRetval = NO_ERROR) Begin
78440>>>>>        Function_Return (CString (sName))
78441>>>>>    End
78441>>>>>>
78441>>>>>    
78441>>>>>    Function_Return "User Unknown"
78442>>>>>End_Function
78443>>>>>
78443>>>>>// OBSOLETE STRUCTURE AND WINDOWS API CALL. KEPT FOR BACKWARDS COMPATIBILITY
78443>>>>>Type MEMORYSTATUS
78443>>>>>   Field MEMORYSTATUS.dwLength         as DWord // sizeof(MEMORYSTATUS)
78443>>>>>   Field MEMORYSTATUS.dwMemoryLoad     as DWord // percent Of memory in use
78443>>>>>   Field MEMORYSTATUS.dwTotalPhys      as DWord // bytes Of physical memory
78443>>>>>   Field MEMORYSTATUS.dwAvailPhys      as DWord // free physical memory bytes
78443>>>>>   Field MEMORYSTATUS.dwTotalPageFile  as DWord // bytes Of paging file
78443>>>>>   Field MEMORYSTATUS.dwAvailPageFile  as DWord // free bytes Of paging file
78443>>>>>   Field MEMORYSTATUS.dwTotalVirtual   as DWord // user bytes Of address space
78443>>>>>   Field MEMORYSTATUS.dwAvailVirtual   as DWord // free user bytes
78443>>>>>End_Type // MEMORYSTATUS
78443>>>>>
78443>>>>>External_Function GlobalMemoryStatus "GlobalMemoryStatus" Kernel32.Dll Pointer lpsMemoryStatus Returns Integer
78444>>>>>
78444>>>>>Struct tWinMemoryStatusEx
78444>>>>>    UInteger dwLength                
78444>>>>>    UInteger dwMemoryLoad          
78444>>>>>    UBigInt ullTotalPhys           
78444>>>>>    UBigInt ullAvailPhys           
78444>>>>>    UBigInt ullTotalPageFile       
78444>>>>>    UBigInt ullAvailPageFile       
78444>>>>>    UBigInt ullTotalVirtual        
78444>>>>>    UBigInt ullAvailVirtual        
78444>>>>>    UBigInt ullAvailExtendedVirtual
78444>>>>>End_Struct
78444>>>>>
78444>>>>>External_Function GlobalMemoryStatusEx "GlobalMemoryStatusEx" Kernel32.Dll Pointer lpMemoryStatus Returns Integer
78445>>>>>
78445>>>>>Class SysinfoDisplay is a cTextEdit
78446>>>>>    Procedure Construct_Object
78448>>>>>        Forward Send Construct_Object
78450>>>>>
78450>>>>>        Set Location To 6 6
78451>>>>>        Set Size To 110 255
78452>>>>>        Set Read_Only_State To True
78453>>>>>        Set pbWrap to False
78454>>>>>    End_Procedure
78455>>>>>
78455>>>>>    //****************************************************************************
78455>>>>>    // $Module type: PROCEDURE
78455>>>>>    // $Module name: Show_Current_Directory
78455>>>>>    // $Author     : VOO
78455>>>>>    // Created     : 06-10-96 @ 15:24
78455>>>>>    //
78455>>>>>    // Description
78455>>>>>    //    This method will show the name Of the current directory in the system
78455>>>>>    //    information box
78455>>>>>    //
78455>>>>>    // $Rev History
78455>>>>>    //    06-10-96  Module header created
78455>>>>>    //****************************************************************************
78455>>>>>    Procedure Show_Current_Directory
78457>>>>>        String sDir
78457>>>>>
78457>>>>>        Get_Current_Directory To sDir
78458>>>>>
78458>>>>>        Send AppendTextLn (SFormat (C_$CurrentDirectory, sDir))
78459>>>>>    End_Procedure
78460>>>>>
78460>>>>>    Procedure Show_Windows_Directory
78462>>>>>        String sWindir
78462>>>>>
78462>>>>>        Get_Windows_Directory To sWindir
78463>>>>>
78463>>>>>        Send AppendTextLn (SFormat (C_$WindowsDirectory, sWindir))
78464>>>>>    End_Procedure
78465>>>>>
78465>>>>>    Procedure Show_Current_User
78467>>>>>        Send AppendTextLn (SFormat (C_$NetworkUserName, Network_User_Name (Self)))
78468>>>>>    End_Procedure
78469>>>>>
78469>>>>>    Procedure Show_Number_Format
78471>>>>>        Integer iFormat
78471>>>>>        String sFormatText
78471>>>>>
78471>>>>>        Get_Attribute DF_THOUSANDS_SEPARATOR to iFormat
78474>>>>>        Move (Character (iFormat)) To sFormatText
78475>>>>>        Send AppendTextLn (SFormat (C_$ThousandsSeparator, sFormatText, iFormat))
78476>>>>>
78476>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iFormat
78479>>>>>        Move (Character (iFormat)) to sFormatText
78480>>>>>        Send AppendTextLn (SFormat (C_$DecimalSeparator, sFormatText))
78481>>>>>    End_Procedure
78482>>>>>
78482>>>>>    Procedure Show_Filelist_Name
78484>>>>>        String sFilename
78484>>>>>
78484>>>>>        Get_Attribute DF_FILELIST_NAME to sFilename
78487>>>>>
78487>>>>>        Send AppendTextLn (SFormat (C_$CurrentFilelist, sFilename))
78488>>>>>    End_Procedure
78489>>>>>
78489>>>>>    Procedure Show_Lock_Delay
78491>>>>>        Integer iLockdelay
78491>>>>>
78491>>>>>        Get_Attribute DF_LOCK_DELAY to iLockdelay
78494>>>>>
78494>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingDelay, iLockDelay))
78495>>>>>    End_Procedure
78496>>>>>
78496>>>>>    Procedure Show_Lock_Timeout
78498>>>>>        Integer iLockTimeout
78498>>>>>
78498>>>>>        Get_Attribute DF_LOCK_TIMEOUT to iLockTimeout
78501>>>>>
78501>>>>>        Send AppendTextLn (SFormat (C_$DatabaseLockingTimeout, iLockTimeOut))
78502>>>>>    End_Procedure
78503>>>>>
78503>>>>>    Procedure Show_Screen_Size
78505>>>>>        Integer iYscreensize iXscreensize
78505>>>>>
78505>>>>>        Move (GetSystemMetrics (SM_CXSCREEN)) To iXscreensize
78506>>>>>        Move (GetSystemMetrics (SM_CYSCREEN)) To iYscreensize
78507>>>>>
78507>>>>>        Send AppendTextLn (SFormat (C_$VideoResolution, iXscreensize, iYscreensize))
78508>>>>>    End_Procedure
78509>>>>>
78509>>>>>    Procedure Show_Page_Size
78511>>>>>        Send AppendTextLn (SFormat (C_$PageEndFormFeed, Pageend, Pagefeed))
78512>>>>>    End_procedure
78513>>>>>
78513>>>>>    Procedure Show_Date
78515>>>>>        Date dToday
78515>>>>>
78515>>>>>        Sysdate dToday
78516>>>>>
78516>>>>>        Send AppendTextLn (SFormat (C_$CurrentSystemDate, String (dToday)))
78517>>>>>    End_procedure
78518>>>>>
78518>>>>>    Procedure Show_Date_Format
78520>>>>>        Integer iDateFormat
78520>>>>>        String sDateFormat
78520>>>>>
78520>>>>>        Get_Attribute DF_DATE_FORMAT to iDateFormat
78523>>>>>        Case Begin
78523>>>>>            Case (iDateFormat = DF_DATE_USA)
78525>>>>>                Move C_$USA To sDateFormat
78526>>>>>                Case Break
78527>>>>>            Case (iDateFormat = DF_DATE_EUROPEAN)
78530>>>>>                Move C_$European To sDateFormat
78531>>>>>                Case Break
78532>>>>>            Case (iDateFormat = DF_DATE_MILITARY)
78535>>>>>                Move C_$Military To sDateFormat
78536>>>>>                Case Break
78537>>>>>            Case Else
78537>>>>>                Move C_$UnknownDateType To sDateFormat
78538>>>>>                Case Break
78539>>>>>        Case End
78539>>>>>
78539>>>>>        Send AppendTextLn (SFormat (C_$DateFormat, sDateformat))
78540>>>>>    End_Procedure
78541>>>>>
78541>>>>>    Procedure Show_Systemresources
78543>>>>>        tWinMemoryStatusEx MemoryStatusInfo
78543>>>>>        tWinMemoryStatusEx MemoryStatusInfo
78543>>>>>        Integer iRetval
78543>>>>>
78543>>>>>        Move (SizeOfType (tWinMemoryStatusEx)) to MemoryStatusInfo.dwLength
78544>>>>>        Move (GlobalMemoryStatusEx (AddressOf (MemoryStatusInfo))) to iRetval
78545>>>>>        If (iRetval = 0) Begin
78547>>>>>            Move (ShowLastError ()) to iRetval
78548>>>>>        End
78548>>>>>>
78548>>>>>
78548>>>>>        Send AppendTextLn (SFormat (C_$AvailableMemory, MemoryStatusInfo.ullTotalPhys))
78549>>>>>        Send AppendTextLn (SFormat (C_$MemoryUtilization, MemoryStatusInfo.dwMemoryLoad))
78550>>>>>        Send AppendTextLn (SFormat (C_$AvailablePhysicalMemory, Real (MemoryStatusInfo.ullAvailPhys) / Real (MemoryStatusInfo.ullTotalPhys) * 100.0))
78551>>>>>        Send AppendTextLn (SFormat (C_$AvailablePagefileSpace, Real (MemoryStatusInfo.ullAvailPageFile) / Real (MemoryStatusInfo.ullTotalPageFile) * 100.0))
78552>>>>>        Send AppendTextLn (SFormat (C_$AvailableVirtualMemory, Real (MemoryStatusInfo.ullAvailVirtual) / Real (MemoryStatusInfo.ullTotalVirtual) * 100.0))
78553>>>>>    End_Procedure
78554>>>>>
78554>>>>>    Procedure Show_Registration
78556>>>>>        String sRegName
78556>>>>>        Integer iSN iMaxUsers
78556>>>>>
78556>>>>>        Registration sRegName iSN
78557>>>>>>
78557>>>>>        
78557>>>>>        Get_Licensed_Max_Users to iMaxUsers
78558>>>>>
78558>>>>>        Send AppendTextLn ""
78559>>>>>//        Send AppendTextLn (SFormat (C_$Serial, iSN))
78559>>>>>//        Send AppendTextLn (SFormat (C_$RegName, sRegName))
78559>>>>>        Send AppendTextLn (SFormat (C_$MaxNumUsers, iMaxUsers))
78560>>>>>    End_Procedure
78561>>>>>
78561>>>>>    //****************************************************************************
78561>>>>>    // If workspaces are used, we will send the message EnumerateWorkspaceData
78561>>>>>    // To the workspace object passing the an object and message To send back
78561>>>>>    // To this object. It is expected that the workspace object will send this
78561>>>>>    // message for every line Of information it wants displayed (passing the
78561>>>>>    // information To be displayed
78561>>>>>    //****************************************************************************
78561>>>>>    Register_Procedure EnumerateWorkspaceData Integer hObjId Integer hmMessId
78561>>>>>
78561>>>>>    Procedure Show_ServicePack
78563>>>>>        String sKey sVersionDescription sVersion 
78563>>>>>        Handle hoRegistry
78563>>>>>        Boolean bExists bOpened
78563>>>>>        
78563>>>>>        Get Create (RefClass (cRegistry)) to hoRegistry
78564>>>>>        Set phRootKey of hoRegistry to HKEY_LOCAL_MACHINE
78565>>>>>        Set pfAccessRights of hoRegistry to KEY_READ
78566>>>>>
78566>>>>>        Move C_DFVersionRegistryRoot to sKey
78567>>>>>        Get KeyExists of hoRegistry sKey to bExists
78568>>>>>        If (bExists) Begin
78570>>>>>            Get OpenKey of hoRegistry sKey to bOpened
78571>>>>>            If (bOpened) Begin
78573>>>>>                Get ValueExists of hoRegistry "CurrentVersionDescription" to bExists
78574>>>>>                If (bExists) Begin
78576>>>>>                    Get ReadString of hoRegistry "CurrentVersionDescription" to sVersionDescription
78577>>>>>                End
78577>>>>>>
78577>>>>>                
78577>>>>>                Get ValueExists of hoRegistry "CurrentVersion" to bExists
78578>>>>>                If (bExists) Begin
78580>>>>>                    Get ReadString of hoRegistry "CurrentVersion" to sVersion
78581>>>>>                End                
78581>>>>>>
78581>>>>>                Send CloseKey of hoRegistry
78582>>>>>            End
78582>>>>>>
78582>>>>>        End
78582>>>>>>
78582>>>>>        Send Destroy of hoRegistry
78583>>>>>
78583>>>>>        If (sVersionDescription <> "") Begin
78585>>>>>           Send AppendTextLn (sVersionDescription * "-" * sVersion)
78586>>>>>           Send AppendTextLn ""
78587>>>>>        End
78587>>>>>>
78587>>>>>    End_Procedure
78588>>>>>
78588>>>>>    Procedure Show_WorkspaceInformation
78590>>>>>        Integer hoWorkspace
78590>>>>>
78590>>>>>        If (ghoApplication <> 0) Begin
78592>>>>>            Get phoWorkspace of ghoApplication to hoWorkspace
78593>>>>>            If (hoWorkspace <> 0) Begin
78595>>>>>                Send EnumerateWorkspaceData of hoWorkspace Self (Refproc (AppendTextLn))
78596>>>>>            End
78596>>>>>>
78596>>>>>        End
78596>>>>>>
78596>>>>>    End_Procedure
78597>>>>>
78597>>>>>    Function VersionStr Integer iVer Integer iRev Integer iBld Returns String
78599>>>>>        Function_Return (String (iVer) - "." - String (iRev) - "." - String (iBld))
78600>>>>>    End_Function
78601>>>>>
78601>>>>>    Procedure Show_Versions
78603>>>>>        Integer iVersion iRevision iBuild
78603>>>>>
78603>>>>>        Version_information iVersion iRevision iBuild
78605>>>>>
78605>>>>>        Send AppendTextLn (SFormat (C_$RuntimeVersion, VersionStr(Self,iVersion,iRevision,iBuild) ))
78606>>>>>        Send AppendTextLn (SFormat (C_$PackageVersion, VersionStr(Self,PKG_VERSION, PKG_REVISION, PKG_BUILD) ))
78607>>>>>        Send AppendTextLn (SFormat (C_$FMACVersion, VersionStr(Self,FMAC_VERSION, FMAC_REVISION, FMAC_BUILD) ))
78608>>>>>    End_Procedure
78609>>>>>    
78609>>>>>    Function CKRevisionNumber String sDriverID Returns String
78611>>>>>        Handle hoCLIHandler
78611>>>>>        Handle hoDFBtrDrvHandler
78611>>>>>        String sCKRevision
78611>>>>>
78611>>>>>
78611>>>>>        If (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV") Begin
78613>>>>>            Get Create (RefClass(cCLIHandler)) to hoCLIHandler
78614>>>>>            Set psDriverID of hoCLIHandler to sDriverID
78615>>>>>            Move (CKRevision(hoCLIHandler)) to sCKRevision
78616>>>>>            Send Destroy of hoCLIHandler
78617>>>>>        End
78617>>>>>>
78617>>>>>        Else Begin
78618>>>>>            If (sDriverID = "DFBTRDRV") Begin
78620>>>>>                Get Create (RefClass(cDFBtrDrvHandler)) to hoDFBtrDrvHandler
78621>>>>>                Set psDriverID of hoDFBtrDrvHandler to sDriverID
78622>>>>>                Move (CKRevision(hoDFBtrDrvHandler)) to sCKRevision
78623>>>>>                Send Destroy of hoDFBtrDrvHandler
78624>>>>>            End
78624>>>>>>
78624>>>>>        End
78624>>>>>>
78624>>>>>        
78624>>>>>        Function_Return sCKRevision
78625>>>>>    End_Function
78626>>>>>    
78626>>>>>    
78626>>>>>    Function IsDataAccessCK String sDriverID Returns Boolean
78628>>>>>        
78628>>>>>        If (sDriverID = "DATAFLEX") Begin
78630>>>>>            Function_Return False
78631>>>>>        End
78631>>>>>>
78631>>>>>    
78631>>>>>        Function_Return (sDriverID = "MSSQLDRV" or sDriverID = "ODBC_DRV" or sDriverID = "DB2_DRV" or sDriverID = "DFBTRDRV")
78632>>>>>    End_Function    
78633>>>>>
78633>>>>>
78633>>>>>    //***
78633>>>>>    //*** BW
78633>>>>>    //*** Procedure: Show_Drivers
78633>>>>>    //*** Purpose  : Show loaded database drivers
78633>>>>>    //***
78633>>>>>
78633>>>>>    Procedure Show_Drivers
78635>>>>>        String sCurrentDriver sRevNumber
78635>>>>>        String sLoadedDrivers
78635>>>>>        Integer iNumberOfDrivers iCount
78635>>>>>        Boolean bOK
78635>>>>>
78635>>>>>        Move "" To sLoadedDrivers
78636>>>>>        Get_Attribute DF_NUMBER_DRIVERS To iNumberOfDrivers
78639>>>>>        For iCount From 1 To iNumberOfDrivers
78645>>>>>>
78645>>>>>            Get_Attribute DF_DRIVER_NAME Of iCount To sCurrentDriver
78648>>>>>            If (sLoadedDrivers <> "") Begin
78650>>>>>                Move (Append (sLoadedDrivers, ", ")) To sLoadedDrivers
78651>>>>>            End
78651>>>>>>
78651>>>>>            Get IsDataAccessCK sCurrentDriver to bOK
78652>>>>>            If (bOK) Begin
78654>>>>>                Get CKRevisionNumber sCurrentDriver to sRevNumber
78655>>>>>                Move (sCurrentDriver * "(" + sRevNumber + ")") to sCurrentDriver
78656>>>>>            End
78656>>>>>>
78656>>>>>            Move (Append (sLoadedDrivers, sCurrentDriver)) To sLoadedDrivers
78657>>>>>        Loop
78658>>>>>>
78658>>>>>        Send AppendTextLn (SFormat (C_$DatabaseDriver, sLoadedDrivers))
78659>>>>>    End_Procedure
78660>>>>>
78660>>>>>    Procedure Show_HelpFile
78662>>>>>        String sHelpFile
78662>>>>>        Integer eHelpType
78662>>>>>
78662>>>>>        If (ghoApplication <> 0) Begin
78664>>>>>            Get peHelpType Of ghoApplication To eHelpType
78665>>>>>            If (eHelpType = htHtmlHelp and ghoHtmlHelp) Begin
78667>>>>>                Get GetHelpFile Of ghoHtmlHelp To sHelpFile
78668>>>>>            End
78668>>>>>>
78668>>>>>            Else If (eHelpType = htWinHelp and Help_object_id) Begin
78671>>>>>                Get Help_filename Of Help_object_id To sHelpFile
78672>>>>>            End
78672>>>>>>
78672>>>>>            Else Begin
78673>>>>>                Move C_$ThereIsNoHelpfileDefined To sHelpFile
78674>>>>>            End
78674>>>>>>
78674>>>>>
78674>>>>>            Send AppendTextLn ""
78675>>>>>            Send AppendTextLn (SFormat (C_$HelpFile, sHelpFile))
78676>>>>>        End
78676>>>>>>
78676>>>>>    End_Procedure
78677>>>>>
78677>>>>>    Procedure Show_EnterAsTab
78679>>>>>        Boolean bEnterKeyAsTabKey
78679>>>>>        String sText
78679>>>>>
78679>>>>>        If (ghoApplication <> 0) Begin
78681>>>>>            Get pbEnterKeyAsTabKey Of ghoApplication To bEnterKeyAsTabKey
78682>>>>>            If (bEnterKeyAsTabKey) Begin
78684>>>>>                Move "True" To sText
78685>>>>>            End
78685>>>>>>
78685>>>>>            Else Begin
78686>>>>>                Move "False" To sText
78687>>>>>            End
78687>>>>>>
78687>>>>>            Send AppendTextLn (SFormat (C_$EnterKeyNavForward, sText))
78688>>>>>        End
78688>>>>>>
78688>>>>>    End_Procedure
78689>>>>>
78689>>>>>    //****************************************************************************
78689>>>>>    // $Module type: PROCEDURE
78689>>>>>    // $Module name: Add_Focus
78689>>>>>    // $Author     : VOO
78689>>>>>    // Created     : 24-09-96 @ 19:43
78689>>>>>    //
78689>>>>>    // Description
78689>>>>>    //    During activation we will remove the old information and add the newly
78689>>>>>    //    found systeminformation
78689>>>>>    //
78689>>>>>    // $Rev History
78689>>>>>    //    24-09-96  Module header created
78689>>>>>    //****************************************************************************
78689>>>>>    Procedure Add_Focus Integer hoRoot
78691>>>>>        Forward Send Add_Focus hoRoot
78693>>>>>
78693>>>>>        Send Delete_Data
78694>>>>>
78694>>>>>        Set Changed_State To False
78695>>>>>        Set Read_Only_State To True
78696>>>>>
78696>>>>>        Send Show_ServicePack
78697>>>>>        If (ghoApplication <> 0) Begin
78699>>>>>            Send Show_WorkSpaceInformation // added To show WS info
78700>>>>>            Send Show_HelpFile
78701>>>>>            Send Show_EnterAsTab
78702>>>>>        End
78702>>>>>>
78702>>>>>        Send Show_Drivers
78703>>>>>        Send Show_Current_User
78704>>>>>        Send Show_Windows_Directory
78705>>>>>        Send Show_Current_Directory
78706>>>>>        Send Show_Filelist_Name
78707>>>>>        Send Show_Versions
78708>>>>>        Send Show_Screen_Size
78709>>>>>        Send Show_Page_Size
78710>>>>>        Send Show_Number_Format
78711>>>>>        Send Show_Date_Format
78712>>>>>        Send Show_Lock_Delay
78713>>>>>        Send Show_Lock_Timeout
78714>>>>>        Send Show_Date
78715>>>>>        Send Show_Systemresources
78716>>>>>        Send Show_Registration
78717>>>>>        Send Beginning_of_Data
78718>>>>>
78718>>>>>        Set Icon to 'default.ico'
78719>>>>>    End_Procedure
78720>>>>>End_Class
78721>>>>>
78721>>>>>//****************************************************************************
78721>>>>>// $Module type: OBJECT
78721>>>>>// $Module name: Sysinfo_Dialog
78721>>>>>// $Author     : VOO
78721>>>>>// Created     : 24-09-96 @ 18:47
78721>>>>>//
78721>>>>>// Description
78721>>>>>//    This object shows the systeminformation on the screen
78721>>>>>//
78721>>>>>// $Rev History
78721>>>>>//    24-09-96  Module header created
78721>>>>>//****************************************************************************
78721>>>>>Class SysInfoDialog Is A ModalPanel
78722>>>>>    Procedure Construct_Object
78724>>>>>        Forward Send Construct_Object
78726>>>>>
78726>>>>>        Set Label to C_$SystemInformation
78727>>>>>        Set Size to 140 267
78728>>>>>        Set piMinSize to 140 267
78729>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
78730>>>>>        Set Border_Style to Border_Thick
78731>>>>>
78731>>>>>        Object oSysinfoDisplay Is A SysInfoDisplay
78733>>>>>            Set peAnchors to anAll
78734>>>>>        End_Object
78735>>>>>
78735>>>>>        Object oCloseButton Is A Button
78737>>>>>            Set Label To C_$Close
78738>>>>>            Set Location To 120 210
78739>>>>>            Set Message Item 0 To (Refproc (Close_Panel))
78740>>>>>            Set Default_State To True
78741>>>>>            Set peAnchors to anBottomRight
78742>>>>>        End_Object
78743>>>>>
78743>>>>>        On_Key kCancel Send Close_Panel
78744>>>>>    End_Procedure
78745>>>>>End_Class
78746>>>>>
78746>>>>>// Purpose:
78746>>>>>//
78746>>>>>// Ken Ross 12/17/96 5:16PM
78746>>>>>//
78746>>>>>Class AboutDialog Is A ModalPanel
78747>>>>>    Procedure Construct_Object
78749>>>>>        String sVdfRootDir
78749>>>>>
78749>>>>>        Forward Send Construct_Object
78751>>>>>
78751>>>>>        Set Label To C_$About
78752>>>>>        Set Size to 89 212
78753>>>>>        Set Locate_Mode To CENTER_ON_SCREEN
78754>>>>>
78754>>>>>        Object oSysInfoDialog Is A SysInfoDialog
78756>>>>>        End_Object
78757>>>>>
78757>>>>>        Object oBox Is A Container3d
78759>>>>>            Set Border_Style To Border_StaticEdge
78760>>>>>            Set Size to 63 202
78761>>>>>            Set Location To 4 5
78762>>>>>
78762>>>>>            Object oAboutGraphic Is A BitmapContainer
78764>>>>>                Set Border_Style To Border_None
78765>>>>>                Set Bitmap_Style To Bitmap_Center
78766>>>>>                Set Size To 48 48
78767>>>>>                Set Location To 7 2
78768>>>>>            End_Object
78769>>>>>
78769>>>>>            Object oProductName Is A TextBox
78771>>>>>                Set Label To C_$ProductName
78772>>>>>                Set Size To 10 45
78773>>>>>                Set Location To 8 53
78774>>>>>            End_Object
78775>>>>>
78775>>>>>            Object oVersion Is A TextBox
78777>>>>>                Set Label To C_$Version
78778>>>>>                Set Size To 10 25
78779>>>>>                Set Location To 21 53
78780>>>>>            End_Object
78781>>>>>
78781>>>>>            Object oCopyright Is A TextBox
78783>>>>>                Set Label To C_$Copyright
78784>>>>>                Set Size To 10 31
78785>>>>>                Set Location To 34 53
78786>>>>>            End_Object
78787>>>>>
78787>>>>>            Object oAuthor Is A TextBox
78789>>>>>                Set Label To C_$Author
78790>>>>>                Set Size To 10 22
78791>>>>>                Set Location To 46 53
78792>>>>>            End_Object
78793>>>>>        End_Object
78794>>>>>
78794>>>>>        Object oOKButton Is A Button
78796>>>>>            On_Item C_$OK Send Close_Panel
78797>>>>>            Set Size To 14 50
78798>>>>>            Set Location To 71 157
78799>>>>>        End_Object
78800>>>>>
78800>>>>>        Object oSysInfoButton Is A Button
78802>>>>>            On_Item C_$SystemInfo Send Show_Sysinfo
78803>>>>>            Set Size To 14 50
78804>>>>>            Set Location To 71 101
78805>>>>>        End_Object
78806>>>>>
78806>>>>>        On_Key Kcancel Send KeyAction Of oOKButton
78807>>>>>
78807>>>>>        Set Logo To "DacAbout.bmp"  // square bitmaps Of 42x42 work best
78808>>>>>    End_Procedure
78809>>>>>
78809>>>>>    Procedure Set ProductName String sProductName
78811>>>>>        Set Label Of oProductName To sProductName
78812>>>>>    End_Procedure
78813>>>>>
78813>>>>>    Procedure Set Version String sVersion
78815>>>>>        Set Label Of oVersion To sVersion
78816>>>>>    End_Procedure
78817>>>>>
78817>>>>>    Procedure Set Copyright string sCopyright
78819>>>>>        Set Label Of oCopyright To sCopyright
78820>>>>>    End_Procedure
78821>>>>>
78821>>>>>    Procedure Set Author String sAuthor
78823>>>>>        Set Label Of oAuthor To sAuthor
78824>>>>>    End_Procedure
78825>>>>>
78825>>>>>    Procedure Set Logo string sLogo
78827>>>>>        // square bitmaps Of 42x42 work best
78827>>>>>        Set Bitmap Of oAboutGraphic To sLogo
78828>>>>>    End_Procedure
78829>>>>>
78829>>>>>    Procedure Show_Sysinfo
78831>>>>>        Send Popup_Modal Of oSysinfoDialog
78832>>>>>    End_Procedure
78833>>>>>
78833>>>>>    Procedure End_Construct_Object
78835>>>>>        Handle hoVersionInfo
78835>>>>>        Boolean bIncluded
78835>>>>>        Integer iMajor iMinor iRelease iBuild
78835>>>>>        String sLabel
78835>>>>>
78835>>>>>        Get Label Of oVersion To sLabel
78836>>>>>        If (sLabel = C_$VERSION) Begin
78838>>>>>            // set it To the version info Of the program, if available
78838>>>>>            If (ghoApplication <> 0) Begin
78840>>>>>                Get phoVersionInfo of ghoApplication to hoVersionInfo
78841>>>>>                If (hoVersionInfo <> 0) Begin
78843>>>>>                    Get pbIncluded of hoVersionInfo to bIncluded
78844>>>>>                    If (bIncluded) Begin
78846>>>>>                        Get piVersionMajor of hoVersionInfo to iMajor
78847>>>>>                        Get piVersionMinor of hoVersionInfo to iMinor
78848>>>>>                        Get piVersionRelease of hoVersionInfo to iRelease
78849>>>>>                        Get piVersionBuild of hoVersionInfo to iBuild
78850>>>>>                        Move (SFormat (C_$VERSION + ": %1.%2.%3.%4", iMajor, iMinor, iRelease, iBuild)) to sLabel
78851>>>>>                        Set Version to sLabel
78852>>>>>                    End
78852>>>>>>
78852>>>>>                End
78852>>>>>>
78852>>>>>            End
78852>>>>>>
78852>>>>>        End
78852>>>>>>
78852>>>>>
78852>>>>>        Forward Send End_Construct_Object
78854>>>>>    End_Procedure
78855>>>>>End_Class
78856>>>
78856>>>// *************************************************************************
78856>>>//  Public message. This is the default message. It is expected that you will
78856>>>//   create your own message to override this
78856>>>// *************************************************************************
78856>>>
78856>>>Procedure Activate_About
78859>>>   Send DoAbout "" "" "" "" ""
78860>>>End_Procedure
78861>>>
78861>>>// *************************************************************************
78861>>>//  Public message. It is expected that you will send this message (most
78861>>>//  likely from Activate_About. This creates an about object, activates it
78861>>>//  and destroys it when done. It is not exepected that you will augment this.
78861>>>// *************************************************************************
78861>>>
78861>>>Procedure DoAbout string sTitle string sVersion string sCopyRight string sAuthor string sBitmap
78864>>>        integer hoObj hoMain
78864>>>
78864>>>        // create object
78864>>>        Object About is an AboutDialog
78866>>>            // if no title passed use the label of the main panel
78866>>>            // (if a main panel exists).
78866>>>            if sTitle     eq '' Begin
78868>>>                Get Main_Window of desktop to hoMain
78869>>>                if hoMain Get Label of hoMain to sTitle
78872>>>            end
78872>>>>
78872>>>            set productname to sTitle
78873>>>            set version     to sVersion
78874>>>            set copyright   to sCopyRight
78875>>>            set author      to sAuthor
78876>>>            If sBitmap    ne '' ;               set logo to sBitMap // square bitmaps of 42x42 work best
78879>>>            Move self to hoObj // object Id
78880>>>        End_Object
78881>>>        Send Popup   of hoObj    // popup the about object
78882>>>        Send Destroy of hoObj // when done, it will be destroyed
78883>>>End_procedure
78884>        Use VWCADOBJETOS.vw
Including file: VWCADOBJETOS.vw    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\VWCADOBJETOS.vw)
78884>>>// Cadastro de Objetos
78884>>>//
78884>>>
78884>>>Use DFClient.pkg
78884>>>Use DFEntry.pkg
78884>>>Use cDbForm_SI.pkg
Including file: cDbForm_SI.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\cDbForm_SI.pkg)
78884>>>>>Use dfEntry.pkg
78884>>>>>Use BPCoreBase.bp
Including file: BPCoreBase.bp    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\BPCoreBase.bp)
78884>>>>>>>Use Batchdd.pkg
78884>>>>>>>
78884>>>>>>>Use gFormatNumbers.pkg
Including file: gFormatNumbers.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\gFormatNumbers.pkg)
78884>>>>>>>>>//****************************************************************************//
78884>>>>>>>>>//                                                                            //
78884>>>>>>>>>// $File name  : gFormatNumbers.pkg                                           //
78884>>>>>>>>>// $File title : Globals for formating numbers and currency                   //
78884>>>>>>>>>// Notice      :                                                              //
78884>>>>>>>>>// $Author(s)  : John Tuohy                                                   //
78884>>>>>>>>>//                                                                            //
78884>>>>>>>>>// Confidential Trade Secret.                                                 //
78884>>>>>>>>>// Copyright 1999 Data Access Corporation, Miami FL, USA                      //
78884>>>>>>>>>// All Rights reserved                                                        //
78884>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.             //
78884>>>>>>>>>// $Rev History                                                               //
78884>>>>>>>>>//                                                                            //
78884>>>>>>>>>// 25.08.99 Created                                                           //
78884>>>>>>>>>//****************************************************************************//
78884>>>>>>>>>
78884>>>>>>>>>Use cFormatter.pkg
Including file: cFormatter.pkg    (C:\Program Files (x86)\DataFlex 18.1\Pkg\cFormatter.pkg)
78884>>>>>>>>>>>//****************************************************************************//
78884>>>>>>>>>>>//                                                                            //
78884>>>>>>>>>>>// $File name  : cFormatter.pkg                                               //
78884>>>>>>>>>>>// $File title : cFormatter class (private class)                             //
78884>>>>>>>>>>>// $Author(s)  : John Tuohy                                                   //
78884>>>>>>>>>>>//                                                                            //
78884>>>>>>>>>>>// Confidential Trade Secret.                                                 //
78884>>>>>>>>>>>// Copyright 1999 Data Access Corporation, Miami FL, USA                      //
78884>>>>>>>>>>>// All Rights reserved                                                        //
78884>>>>>>>>>>>// DataFlex is a registered trademark of Data Access Corporation.             //
78884>>>>>>>>>>>//                                                                            //
78884>>>>>>>>>>>// $Rev History                                                               //
78884>>>>>>>>>>>//                                                                            //
78884>>>>>>>>>>>// 25.08.99 Created                                                           //
78884>>>>>>>>>>>//****************************************************************************//
78884>>>>>>>>>>>use VDFBase.pkg
78884>>>>>>>>>>>
78884>>>>>>>>>>>Class cFormatter is an cObject
78885>>>>>>>>>>>
78885>>>>>>>>>>>    Procedure Construct_object
78887>>>>>>>>>>>        Integer iCh
78887>>>>>>>>>>>        forward send construct_object
78889>>>>>>>>>>>        Property String  psCurrencySymbol
78890>>>>>>>>>>>        Set psCurrencySymbol to (Default_Currency_Symbol())
78891>>>>>>>>>>>
78891>>>>>>>>>>>        Property string  psLeft
78892>>>>>>>>>>>        Property string  psright
78893>>>>>>>>>>>        Property integer pbThousandsSep
78894>>>>>>>>>>>        Property integer piPoints
78895>>>>>>>>>>>
78895>>>>>>>>>>>        Property string  psCurPosLeft
78896>>>>>>>>>>>        Property string  psCurPosright
78897>>>>>>>>>>>        Property integer pbCurPosThousandsSep
78898>>>>>>>>>>>        Property integer piCurPosPoints
78899>>>>>>>>>>>
78899>>>>>>>>>>>        Property string  psCurNegLeft
78900>>>>>>>>>>>        Property string  psCurNegright
78901>>>>>>>>>>>        Property integer pbCurNegThousandsSep
78902>>>>>>>>>>>        Property integer piCurNegPoints
78903>>>>>>>>>>>
78903>>>>>>>>>>>        Property string  psNumPosLeft
78904>>>>>>>>>>>        Property string  psNumPosright
78905>>>>>>>>>>>        Property integer pbNumPosThousandsSep
78906>>>>>>>>>>>        Property integer piNumPosPoints
78907>>>>>>>>>>>
78907>>>>>>>>>>>        Property string  psNumNegLeft
78908>>>>>>>>>>>        Property string  psNumNegright
78909>>>>>>>>>>>        Property integer pbNumNegThousandsSep
78910>>>>>>>>>>>        Property integer piNumNegPoints
78911>>>>>>>>>>>
78911>>>>>>>>>>>        Send SetFormat "$,#.##;($,#.##)" true  // currency
78912>>>>>>>>>>>        Send SetFormat  ",#.*"           false // numeric
78913>>>>>>>>>>>
78913>>>>>>>>>>>    end_procedure
78914>>>>>>>>>>>
78914>>>>>>>>>>>    // internal
78914>>>>>>>>>>>    // parse passed format string and set temporary properties with result
78914>>>>>>>>>>>    //
78914>>>>>>>>>>>    Procedure ParseFormat string sFmt
78916>>>>>>>>>>>
78916>>>>>>>>>>>        string sLeft sRight sDigit
78916>>>>>>>>>>>        integer bSep iPos i iDigits
78916>>>>>>>>>>>
78916>>>>>>>>>>>        // replace any literals. A "/" followed by anything.
78916>>>>>>>>>>>        // some literals are special. $ . , / #
78916>>>>>>>>>>>        Move (Replaces("/$",sFmt,Character(1)))    to sFmt
78917>>>>>>>>>>>        Move (Replaces("/.",sFmt,Character(2)))    to sFmt
78918>>>>>>>>>>>        Move (Replaces("/,",sFmt,Character(3)))    to sFmt
78919>>>>>>>>>>>        Move (Replaces("/"+"/",sFmt,Character(4))) to sFmt
78920>>>>>>>>>>>        Move (Replaces("/#",sFmt,Character(5)))    to sFmt
78921>>>>>>>>>>>        Move (Character(9)) to sDigit
78922>>>>>>>>>>>        Move (Replaces("#",sFmt,sDigit))           to sFmt
78923>>>>>>>>>>>        Move (Replaces("/",sFmt,""))               to sFmt // replace all others
78924>>>>>>>>>>>
78924>>>>>>>>>>>        Move (Pos(",",sFmt))                 to bSep // if we have any , we use thousand seps
78925>>>>>>>>>>>        If bSep Move (Replaces(",",sFmt,"")) to sFmt // remove all ,
78928>>>>>>>>>>>
78928>>>>>>>>>>>        Move (Replaces("$",sFmt,psCurrencySymbol(self))) to sFmt // replace any $ with currency symbol
78929>>>>>>>>>>>
78929>>>>>>>>>>>        Move (Pos(".",sFmt)) to iPos                 // position of decimal
78930>>>>>>>>>>>
78930>>>>>>>>>>>        // Move all the special literals back into place before parsing
78930>>>>>>>>>>>        Move (Replaces(Character(1),sFmt,"$")) to sFmt
78931>>>>>>>>>>>        Move (Replaces(Character(2),sFmt,".")) to sFmt
78932>>>>>>>>>>>        Move (Replaces(Character(3),sFmt,",")) to sFmt
78933>>>>>>>>>>>        Move (Replaces(Character(4),sFmt,"/")) to sFmt
78934>>>>>>>>>>>        Move (Replaces(Character(5),sFmt,"#")) to sFmt
78935>>>>>>>>>>>
78935>>>>>>>>>>>        If (iPos>0) Begin                      // if we have a decimanl point
78937>>>>>>>>>>>            Move 1 to i                        // look for first non # to right and count the #s
78938>>>>>>>>>>>            If (mid(sFmt,1,iPos+i)="*") Begin  // the "*" is special. It means as many as you want
78940>>>>>>>>>>>               Move -2 to iDigits
78941>>>>>>>>>>>               increment i
78942>>>>>>>>>>>            end
78942>>>>>>>>>>>>
78942>>>>>>>>>>>            While (mid(sFmt,1,iPos+i)=sDigit)
78946>>>>>>>>>>>                 Increment i
78947>>>>>>>>>>>            end
78948>>>>>>>>>>>>
78948>>>>>>>>>>>            Move (Mid(sFmt,255,iPos+i)) to sRight // everything to the right of the last # is format stuff
78949>>>>>>>>>>>            If (iDigits=0) Move (i-1) to iDigits
78952>>>>>>>>>>>            //
78952>>>>>>>>>>>            Move 1 to i                           // find the first non-# to the left of the point
78953>>>>>>>>>>>            While (mid(sFmt,1,iPos-i)=sDigit)     // everything to the left is format stuff
78957>>>>>>>>>>>                 increment i
78958>>>>>>>>>>>            end
78959>>>>>>>>>>>>
78959>>>>>>>>>>>            Move (left(sFmt,iPos-i)) to sLeft
78960>>>>>>>>>>>        end
78960>>>>>>>>>>>>
78960>>>>>>>>>>>        else begin                             // we have no decinal
78961>>>>>>>>>>>            Move 0 to iDigits                  // so points is none
78962>>>>>>>>>>>            Move (Pos(sDigit,sFmt)) to iPos    // find first #.
78963>>>>>>>>>>>            If (iPos=0) Begin                  // if none, entire string is left format stuff..wierd!
78965>>>>>>>>>>>                Move sFmt to sLeft
78966>>>>>>>>>>>                Move ""   to sRight
78967>>>>>>>>>>>            end
78967>>>>>>>>>>>>
78967>>>>>>>>>>>            else begin
78968>>>>>>>>>>>                Move (left(sFmt,iPos-1)) to sLeft // all char to left of first # is left format stuff
78969>>>>>>>>>>>                Move 1 to i
78970>>>>>>>>>>>                While (mid(sFmt,1,iPos+i)=sDigit) // find last #, all char to right is right format
78974>>>>>>>>>>>                    Increment i
78975>>>>>>>>>>>                end
78976>>>>>>>>>>>>
78976>>>>>>>>>>>                Move (Mid(sFmt,255,i+iPos)) to sRight
78977>>>>>>>>>>>            end
78977>>>>>>>>>>>>
78977>>>>>>>>>>>        end
78977>>>>>>>>>>>>
78977>>>>>>>>>>>        // set temporary format properties and exit
78977>>>>>>>>>>>        Set pbThousandsSep to bSep
78978>>>>>>>>>>>        set psLeft         to sLeft
78979>>>>>>>>>>>        set psRight        to sRight
78980>>>>>>>>>>>        Set piPoints       to iDigits
78981>>>>>>>>>>>     End_procedure
78982>>>>>>>>>>>
78982>>>>>>>>>>>    // Public: Sets a format string. Pass full format for Positve and negative in sFmt. Pass
78982>>>>>>>>>>>    //         bCurrency true is this is a currency format, false if a numeric format
78982>>>>>>>>>>>    //
78982>>>>>>>>>>>    //  e.g. Send SetFormat "$,#.##;($,#.##)" True
78982>>>>>>>>>>>    //
78982>>>>>>>>>>>    Procedure SetFormat string sFmt integer bCurrency
78984>>>>>>>>>>>        string sPos sNeg
78984>>>>>>>>>>>        integer iPos
78984>>>>>>>>>>>
78984>>>>>>>>>>>        Move (Pos(";",sFmt)) to iPos
78985>>>>>>>>>>>        If iPos begin
78987>>>>>>>>>>>            Move (left(sFmt,iPos-1))    to sPos
78988>>>>>>>>>>>            Move (mid(sFmt,255,iPos+1)) to sNeg
78989>>>>>>>>>>>        end
78989>>>>>>>>>>>>
78989>>>>>>>>>>>        else Begin
78990>>>>>>>>>>>            Move sFmt         to sPos
78991>>>>>>>>>>>            Move ("-" + sFmt) to sNeg
78992>>>>>>>>>>>        end
78992>>>>>>>>>>>>
78992>>>>>>>>>>>        Send ParseFormat sPos
78993>>>>>>>>>>>        If bCurrency begin
78995>>>>>>>>>>>            Set pbCurPosThousandsSep to (pbThousandsSep(self))
78996>>>>>>>>>>>            set psCurPosLeft         to (psLeft(self))
78997>>>>>>>>>>>            set psCurPosRight        to (psRight(self))
78998>>>>>>>>>>>            Set piCurPosPoints       to (piPoints(self))
78999>>>>>>>>>>>        End
78999>>>>>>>>>>>>
78999>>>>>>>>>>>        else Begin
79000>>>>>>>>>>>            Set pbNumPosThousandsSep to (pbThousandsSep(self))
79001>>>>>>>>>>>            set psNumPosLeft         to (psLeft(self))
79002>>>>>>>>>>>            set psNumPosRight        to (psRight(self))
79003>>>>>>>>>>>            Set piNumPosPoints       to (piPoints(self))
79004>>>>>>>>>>>        end
79004>>>>>>>>>>>>
79004>>>>>>>>>>>
79004>>>>>>>>>>>        Send ParseFormat sNeg
79005>>>>>>>>>>>        If bCurrency begin
79007>>>>>>>>>>>            Set pbCurNegThousandsSep to (pbThousandsSep(self))
79008>>>>>>>>>>>            set psCurNegLeft         to (psLeft(self))
79009>>>>>>>>>>>            set psCurNegRight        to (psRight(self))
79010>>>>>>>>>>>            Set piCurNegPoints       to (piPoints(self))
79011>>>>>>>>>>>        End
79011>>>>>>>>>>>>
79011>>>>>>>>>>>        else Begin
79012>>>>>>>>>>>            Set pbNumNegThousandsSep to (pbThousandsSep(self))
79013>>>>>>>>>>>            set psNumNegLeft         to (psLeft(self))
79014>>>>>>>>>>>            set psNumNegRight        to (psRight(self))
79015>>>>>>>>>>>            Set piNumNegPoints       to (piPoints(self))
79016>>>>>>>>>>>        end
79016>>>>>>>>>>>>
79016>>>>>>>>>>>    End_procedure
79017>>>>>>>>>>>
79017>>>>>>>>>>>    // low level formatting. Pass parameters
79017>>>>>>>>>>>    Function Format_Num number nNumber integer iPoints integer bSep ;                       string sPrefix string sSuffix returns string
79019>>>>>>>>>>>        string  sLeft sRight sNumber sSep sDec
79019>>>>>>>>>>>        integer bIsNegative iDec iLen iCh
79019>>>>>>>>>>>
79019>>>>>>>>>>>        Get_Attribute DF_DECIMAL_SEPARATOR to iCh
79022>>>>>>>>>>>        Move (Character(iCh)) to sDec
79023>>>>>>>>>>>
79023>>>>>>>>>>>        Move (abs(nNumber)) to sNumber
79024>>>>>>>>>>>        Move (Pos(sDec,sNumber)) to iDec
79025>>>>>>>>>>>        Move (If(iDec=0, sNumber, left(sNumber,iDec-1))) to sLeft
79026>>>>>>>>>>>        Move (If(iDec=0, "", mid(sNumber,255,iDec+1)))   to sRight
79027>>>>>>>>>>>        // format for decimal separator
79027>>>>>>>>>>>        If (iPoints>=0) ; // if -2, leave it alone, it should not be -1            Move (left(sRight+repeat("0",iPoints),iPoints)) to sRight
79030>>>>>>>>>>>
79030>>>>>>>>>>>        // format for thousand sep.
79030>>>>>>>>>>>        If bSep Begin
79032>>>>>>>>>>>            Get_Attribute DF_THOUSANDS_SEPARATOR to iCh
79035>>>>>>>>>>>            Move (Character(iCh)) to sSep
79036>>>>>>>>>>>            Move (Length(sLeft)) to iLen
79037>>>>>>>>>>>            While (iLen>3)
79041>>>>>>>>>>>                Move (insert(sSep,sLeft,iLen-2)) to sLeft
79042>>>>>>>>>>>                Move (iLen-3) to iLen
79043>>>>>>>>>>>            End
79044>>>>>>>>>>>>
79044>>>>>>>>>>>        End
79044>>>>>>>>>>>>
79044>>>>>>>>>>>        // if decimal points or -2 (allow anything) and there are points to show
79044>>>>>>>>>>>        If (iPoints>0 OR (iPoints=-2 AND sRight<>"")) ;            Move (sLeft + sDec + sright) to sLeft
79047>>>>>>>>>>>        Function_return (sPrefix + sLeft+ sSuffix)
79048>>>>>>>>>>>    End_Function
79049>>>>>>>>>>>
79049>>>>>>>>>>>    // Public: Format for currency
79049>>>>>>>>>>>    //
79049>>>>>>>>>>>    Function FormatCur number nNumber integer iPoints returns string
79051>>>>>>>>>>>        string  sLeft sRight
79051>>>>>>>>>>>        integer bSep
79051>>>>>>>>>>>        If (nNumber<0) Begin
79053>>>>>>>>>>>            get pbCurNegThousandsSep to bSep
79054>>>>>>>>>>>            get psCurNegLeft         to sLeft
79055>>>>>>>>>>>            get psCurNegRight        to sRight
79056>>>>>>>>>>>            If (iPoints=-1) get piCurNegPoints       to iPoints
79059>>>>>>>>>>>        end
79059>>>>>>>>>>>>
79059>>>>>>>>>>>        Else Begin
79060>>>>>>>>>>>            get pbCurPosThousandsSep to bSep
79061>>>>>>>>>>>            get psCurPosLeft         to sLeft
79062>>>>>>>>>>>            get psCurPosRight        to sRight
79063>>>>>>>>>>>            If (iPoints=-1) get piCurPosPoints       to iPoints
79066>>>>>>>>>>>        end
79066>>>>>>>>>>>>
79066>>>>>>>>>>>        Function_return (Format_Num(self, nNumber,iPoints,bSep,sLeft,sRight))
79067>>>>>>>>>>>    End_function
79068>>>>>>>>>>>
79068>>>>>>>>>>>    // Public: Format for numeric
79068>>>>>>>>>>>    //
79068>>>>>>>>>>>    Function FormatNum number nNumber integer iPoints returns string
79070>>>>>>>>>>>        string  sLeft sRight
79070>>>>>>>>>>>        integer bSep
79070>>>>>>>>>>>        If (nNumber<0) Begin
79072>>>>>>>>>>>            get pbNumNegThousandsSep to bSep
79073>>>>>>>>>>>            get psNumNegLeft         to sLeft
79074>>>>>>>>>>>            get psNumNegRight        to sRight
79075>>>>>>>>>>>            If (iPoints=-1) get piNumNegPoints       to iPoints
79078>>>>>>>>>>>        end
79078>>>>>>>>>>>>
79078>>>>>>>>>>>        Else Begin
79079>>>>>>>>>>>            get pbNumPosThousandsSep to bSep
79080>>>>>>>>>>>            get psNumPosLeft         to sLeft
79081>>>>>>>>>>>            get psNumPosRight        to sRight
79082>>>>>>>>>>>            If (iPoints=-1) get piNumPosPoints       to iPoints
79085>>>>>>>>>>>        end
79085>>>>>>>>>>>>
79085>>>>>>>>>>>        Function_return (Format_Num(self, nNumber,iPoints,bSep,sLeft,sRight))
79086>>>>>>>>>>>    End_function
79087>>>>>>>>>>>
79087>>>>>>>>>>>
79087>>>>>>>>>>>    // Public: Format passing format string
79087>>>>>>>>>>>    //
79087>>>>>>>>>>>    Function FormatVal number nNumber string sFmt returns string
79089>>>>>>>>>>>        integer iPos bIsNeg
79089>>>>>>>>>>>        string  sLeft sRight
79089>>>>>>>>>>>        integer iPoints bSep
79089>>>>>>>>>>>        Move (nNumber<0) to bIsNeg
79090>>>>>>>>>>>        Move (Pos(";",sFmt)) to iPos
79091>>>>>>>>>>>        Case Begin
79091>>>>>>>>>>>            Case (iPos and Not(bIsNeg))      Move (left(sFmt,iPos-1))    to sFmt
79094>>>>>>>>>>>            Case (iPos and bIsNeg)           Move (mid(sFmt,255,iPos+1)) to sFmt
79098>>>>>>>>>>>            Case (not(iPos) and not(bIsNeg)) Move sFmt                   to sFmt
79102>>>>>>>>>>>            Case else                        Move ("-" + sFmt)           to sFmt
79104>>>>>>>>>>>        case end
79104>>>>>>>>>>>        Send ParseFormat sFmt
79105>>>>>>>>>>>        get pbThousandsSep to bSep
79106>>>>>>>>>>>        get psLeft         to sLeft
79107>>>>>>>>>>>        get psRight        to sRight
79108>>>>>>>>>>>        get piPoints       to iPoints
79109>>>>>>>>>>>        Function_return (Format_Num(self, nNumber,iPoints,bSep,sLeft,sRight))
79110>>>>>>>>>>>    end_function
79111>>>>>>>>>>>
79111>>>>>>>>>>>End_Class
79112>>>>>>>>>
79112>>>>>>>>>// for now, this object is private. All access is through the following
79112>>>>>>>>>// global functions
79112>>>>>>>>>
79112>>>>>>>>>//Object oFmt is a cFormatter
79112>>>>>>>>>//end_object
79112>>>>>>>>>
79112>>>>>>>>>Global_variable handle ghoFormatter
79112>>>>>>>>>Get Create of desktop U_cFormatter to ghoFormatter
79113>>>>>>>>>
79113>>>>>>>>>Function FormatNumber Global number nNum integer iPoints returns string
79115>>>>>>>>>    Function_return (FormatNum(ghoFormatter, nNum,iPoints))
79116>>>>>>>>>end_function
79117>>>>>>>>>
79117>>>>>>>>>Function FormatCurrency Global number nNum integer iPoints returns string
79119>>>>>>>>>    Function_return (FormatCur(ghoFormatter, nNum,iPoints))
79120>>>>>>>>>end_function
79121>>>>>>>>>
79121>>>>>>>>>Function FormatValue Global number nNum string sFmt returns string
79123>>>>>>>>>    Function_return (FormatVal(ghoFormatter, nNum,sFmt))
79124>>>>>>>>>end_function
79125>>>>>>>>>
79125>>>>>>>>>Procedure SetCurrencyFormat Global string sFmt
79127>>>>>>>>>    Send SetFormat of ghoFormatter sFmt True
79128>>>>>>>>>end_function
79129>>>>>>>>>
79129>>>>>>>>>Procedure SetNumberFormat Global string sFmt
79131>>>>>>>>>    Send SetFormat of ghoFormatter sFmt False
79132>>>>>>>>>end_function
79133>>>>>>>>>
79133>>>>>>>Use GCIDADES.dd
Including file: GCIDADES.dd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GCIDADES.dd)
79133>>>>>>>>>Use DataDict.pkg
79133>>>>>>>>>
79133>>>>>>>>>Open GCIDADES
Including file: GCIDADES.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GCIDADES.fd)
79135>>>>>>>>>
79135>>>>>>>>>Class GCIDADESDataDictionary is a DataDictionary
79136>>>>>>>>>    
79136>>>>>>>>>    Procedure Construct_Object
79138>>>>>>>>>        Forward Send Construct_Object
79140>>>>>>>>>        Set Main_File to GCIDADES.File_Number
79141>>>>>>>>>
79141>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79142>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79143>>>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79144>>>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79145>>>>>>>>>
79145>>>>>>>>>        Set Field_Option Field GCIDADES.CODIGO DD_AUTOFIND to True
79146>>>>>>>>>        Set Key_Field_State Field GCIDADES.CODIGO to True
79147>>>>>>>>>        Set Field_Option Field GCIDADES.CODIGO DD_CAPSLOCK to True
79148>>>>>>>>>
79148>>>>>>>>>    End_Procedure
79149>>>>>>>>>
79149>>>>>>>>>End_Class
79150>>>>>>>Use GQUERIES.dd
Including file: GQUERIES.dd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GQUERIES.dd)
79150>>>>>>>>>Use DataDict.pkg
79150>>>>>>>>>
79150>>>>>>>>>Open GQUERIES
79152>>>>>>>>>
79152>>>>>>>>>Register_Object oSLGQUERIES
79152>>>>>>>>>
79152>>>>>>>>>Class GQUERIESDataDictionary is a DataDictionary
79153>>>>>>>>>    
79153>>>>>>>>>    Procedure Construct_Object
79155>>>>>>>>>        Forward Send Construct_Object
79157>>>>>>>>>        Set Main_File to GQUERIES.File_Number
79158>>>>>>>>>
79158>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79159>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79160>>>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79161>>>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79162>>>>>>>>>
79162>>>>>>>>>        Set Field_Option Field GQUERIES.CODIGO DD_AUTOFIND to True
79163>>>>>>>>>        Set Field_Option Field GQUERIES.CODIGO DD_CAPSLOCK to True
79164>>>>>>>>>        Set Field_Prompt_Object Field GQUERIES.CODIGO to oSLGQUERIES
79165>>>>>>>>>        Set Key_Field_State Field GQUERIES.CODIGO to True
79166>>>>>>>>>
79166>>>>>>>>>    End_Procedure
79167>>>>>>>>>
79167>>>>>>>>>End_Class
79168>>>>>>>>>
79168>>>>>>>>>Use SLGQUERIES.sl
Including file: SLGQUERIES.sl    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\SLGQUERIES.sl)
79168>>>>>>>>>>>// SLGQUERIES.sl
79168>>>>>>>>>>>// Consulta queries
79168>>>>>>>>>>>
79168>>>>>>>>>>>Use DFClient.pkg
79168>>>>>>>>>>>Use cDbCJGridPromptList.pkg
79168>>>>>>>>>>>Use cDbCJGridColumn.pkg
79168>>>>>>>>>>>Use Windows.pkg
79168>>>>>>>>>>>
79168>>>>>>>>>>>Use GQUERIES.dd
79168>>>>>>>>>>>
79168>>>>>>>>>>>CD_Popup_Object oSLGQUERIES is a dbModalPanel
79186>>>>>>>>>>>>
79186>>>>>>>>>>>    Set Location to 5 5
79187>>>>>>>>>>>    Set Size to 228 438
79188>>>>>>>>>>>    Set Label To "Consulta queries"
79189>>>>>>>>>>>    Set Border_Style to Border_Thick
79190>>>>>>>>>>>    Set Minimize_Icon to False
79191>>>>>>>>>>>
79191>>>>>>>>>>>
79191>>>>>>>>>>>    Object oGQUERIES_DD is a GQUERIESDataDictionary
79193>>>>>>>>>>>    End_Object 
79194>>>>>>>>>>>
79194>>>>>>>>>>>    Set Main_DD To oGQUERIES_DD
79195>>>>>>>>>>>    Set Server  To oGQUERIES_DD
79196>>>>>>>>>>>
79196>>>>>>>>>>>
79196>>>>>>>>>>>
79196>>>>>>>>>>>    Object oSelList is a cDbCJGridPromptList
79198>>>>>>>>>>>        Set Size to 199 428
79199>>>>>>>>>>>        Set Location to 5 5
79200>>>>>>>>>>>        Set peAnchors to anAll
79201>>>>>>>>>>>        Set psLayoutSection to "oSLGQUERIES_oSelList"
79202>>>>>>>>>>>        Set Ordering to 1
79203>>>>>>>>>>>        Set pbAutoServer to True
79204>>>>>>>>>>>
79204>>>>>>>>>>>        Object oGQUERIES_CODIGO is a cDbCJGridColumn
79206>>>>>>>>>>>            Entry_Item GQUERIES.CODIGO
79207>>>>>>>>>>>            Set piWidth to 374
79208>>>>>>>>>>>            Set psCaption to "C¢digo"
79209>>>>>>>>>>>        End_Object 
79210>>>>>>>>>>>
79210>>>>>>>>>>>        Object oGQUERIES_DESCRICAO is a cDbCJGridColumn
79212>>>>>>>>>>>            Entry_Item GQUERIES.DESCRICAO
79213>>>>>>>>>>>            Set piWidth to 375
79214>>>>>>>>>>>            Set psCaption to "Descri‡Æo"
79215>>>>>>>>>>>        End_Object 
79216>>>>>>>>>>>
79216>>>>>>>>>>>
79216>>>>>>>>>>>    End_Object 
79217>>>>>>>>>>>
79217>>>>>>>>>>>    Object oOk_bn is a Button
79219>>>>>>>>>>>        Set Label to "&Ok"
79220>>>>>>>>>>>        Set Location to 209 275
79221>>>>>>>>>>>        Set peAnchors to anBottomRight
79222>>>>>>>>>>>
79222>>>>>>>>>>>        Procedure OnClick
79225>>>>>>>>>>>            Send OK of oSelList
79226>>>>>>>>>>>        End_Procedure
79227>>>>>>>>>>>
79227>>>>>>>>>>>    End_Object 
79228>>>>>>>>>>>
79228>>>>>>>>>>>    Object oCancel_bn is a Button
79230>>>>>>>>>>>        Set Label to "&Cancel"
79231>>>>>>>>>>>        Set Location to 209 329
79232>>>>>>>>>>>        Set peAnchors to anBottomRight
79233>>>>>>>>>>>
79233>>>>>>>>>>>        Procedure OnClick
79236>>>>>>>>>>>            Send Cancel of oSelList
79237>>>>>>>>>>>        End_Procedure
79238>>>>>>>>>>>
79238>>>>>>>>>>>    End_Object 
79239>>>>>>>>>>>
79239>>>>>>>>>>>    Object oSearch_bn is a Button
79241>>>>>>>>>>>        Set Label to "&Search..."
79242>>>>>>>>>>>        Set Location to 209 383
79243>>>>>>>>>>>        Set peAnchors to anBottomRight
79244>>>>>>>>>>>
79244>>>>>>>>>>>        Procedure OnClick
79247>>>>>>>>>>>            Send Search of oSelList
79248>>>>>>>>>>>        End_Procedure
79249>>>>>>>>>>>
79249>>>>>>>>>>>    End_Object 
79250>>>>>>>>>>>
79250>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
79251>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
79252>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
79253>>>>>>>>>>>
79253>>>>>>>>>>>
79253>>>>>>>>>>>CD_End_Object // oSLGQUERIES
79255>>>>>>>>>>>>
79255>>>>>>>Use GPARAM.dd
Including file: GPARAM.dd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GPARAM.dd)
79255>>>>>>>>>Use DataDict.pkg
79255>>>>>>>>>
79255>>>>>>>>>Open GPARAM
Including file: GPARAM.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GPARAM.fd)
79257>>>>>>>>>
79257>>>>>>>>>Register_Object oSLGPARAM
79257>>>>>>>>>
79257>>>>>>>>>Class GPARAMDataDictionary is a DataDictionary
79258>>>>>>>>>    
79258>>>>>>>>>    Procedure Construct_Object
79260>>>>>>>>>        Forward Send Construct_Object
79262>>>>>>>>>        Set Main_File to GPARAM.File_Number
79263>>>>>>>>>
79263>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79264>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79265>>>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79266>>>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79267>>>>>>>>>
79267>>>>>>>>>        Set Field_Option Field GPARAM.NOME DD_AUTOFIND to True
79268>>>>>>>>>        Set Field_Label_Long Field GPARAM.NOME to "Nome"
79269>>>>>>>>>        Set Field_Label_Short Field GPARAM.NOME to "Nome"
79270>>>>>>>>>        Set Field_Prompt_Object Field GPARAM.NOME to oSLGPARAM
79271>>>>>>>>>        Set Key_Field_State Field GPARAM.NOME to True
79272>>>>>>>>>
79272>>>>>>>>>        Set Field_Label_Long Field GPARAM.VALOR to "Valor"
79273>>>>>>>>>        Set Field_Label_Short Field GPARAM.VALOR to "Valor"
79274>>>>>>>>>
79274>>>>>>>>>        Set Field_Label_Long Field GPARAM.OBSERVACAO to "Observa‡Æo"
79275>>>>>>>>>        Set Field_Label_Short Field GPARAM.OBSERVACAO to "Observa‡Æo"
79276>>>>>>>>>
79276>>>>>>>>>        Set Field_Label_Long Field GPARAM.DATA_C to "Data de Cria‡Æo"
79277>>>>>>>>>        Set Field_Label_Short Field GPARAM.DATA_C to "Data Cria‡Æo"
79278>>>>>>>>>
79278>>>>>>>>>        Set Field_Label_Long Field GPARAM.DATA_M to "Data de Modifica‡Æo"
79279>>>>>>>>>        Set Field_Label_Short Field GPARAM.DATA_M to "Data Modifica‡Æo"
79280>>>>>>>>>
79280>>>>>>>>>    End_Procedure
79281>>>>>>>>>
79281>>>>>>>>>    Procedure Update
79283>>>>>>>>>        Forward Send Update
79285>>>>>>>>>        Move (CurrentDateTime()) to GPARAM.DATA_M
79286>>>>>>>>>        
79286>>>>>>>>>        If (Trim(GPARAM.DATA_C) = "") Move (CurrentDateTime()) to GPARAM.DATA_C
79289>>>>>>>>>        
79289>>>>>>>>>        Move (trim(GPARAM.OBSERVACAO)) to GPARAM.OBSERVACAO
79290>>>>>>>>>    End_Procedure
79291>>>>>>>>>
79291>>>>>>>>>End_Class
79292>>>>>>>>>
79292>>>>>>>>>Use SLGPARAM.sl
Including file: SLGPARAM.sl    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\SLGPARAM.sl)
79292>>>>>>>>>>>// SLGPARAM.sl
79292>>>>>>>>>>>// Consulta de parƒmetros
79292>>>>>>>>>>>
79292>>>>>>>>>>>Use DFClient.pkg
79292>>>>>>>>>>>Use cDbCJGridPromptList.pkg
79292>>>>>>>>>>>Use cDbCJGridColumn.pkg
79292>>>>>>>>>>>Use Windows.pkg
79292>>>>>>>>>>>
79292>>>>>>>>>>>Use GPARAM.dd
79292>>>>>>>>>>>
79292>>>>>>>>>>>CD_Popup_Object oSLGPARAM is a dbModalPanel
79310>>>>>>>>>>>>
79310>>>>>>>>>>>    Set Location to 5 5
79311>>>>>>>>>>>    Set Size to 156 469
79312>>>>>>>>>>>    Set Label To "Consulta de parƒmetros"
79313>>>>>>>>>>>    Set Border_Style to Border_Thick
79314>>>>>>>>>>>    Set Minimize_Icon to False
79315>>>>>>>>>>>
79315>>>>>>>>>>>
79315>>>>>>>>>>>    Object oGPARAM_DD is a GPARAMDataDictionary
79317>>>>>>>>>>>    End_Object 
79318>>>>>>>>>>>
79318>>>>>>>>>>>    Set Main_DD To oGPARAM_DD
79319>>>>>>>>>>>    Set Server  To oGPARAM_DD
79320>>>>>>>>>>>
79320>>>>>>>>>>>
79320>>>>>>>>>>>
79320>>>>>>>>>>>    Object oSelList is a cDbCJGridPromptList
79322>>>>>>>>>>>        Set Size to 127 459
79323>>>>>>>>>>>        Set Location to 5 5
79324>>>>>>>>>>>        Set peAnchors to anAll
79325>>>>>>>>>>>        Set psLayoutSection to "oSLGPARAM_oSelList"
79326>>>>>>>>>>>        Set Ordering to 1
79327>>>>>>>>>>>        Set pbAutoServer to True
79328>>>>>>>>>>>        Set pbAutoColumnSizing to False
79329>>>>>>>>>>>
79329>>>>>>>>>>>        Object oGPARAM_NOME is a cDbCJGridColumn
79331>>>>>>>>>>>            Entry_Item GPARAM.NOME
79332>>>>>>>>>>>            Set piWidth to 622
79333>>>>>>>>>>>            Set psCaption to "Nome"
79334>>>>>>>>>>>        End_Object 
79335>>>>>>>>>>>
79335>>>>>>>>>>>        Object oGPARAM_VALOR is a cDbCJGridColumn
79337>>>>>>>>>>>            Entry_Item GPARAM.VALOR
79338>>>>>>>>>>>            Set piWidth to 181
79339>>>>>>>>>>>            Set psCaption to "Valor"
79340>>>>>>>>>>>        End_Object 
79341>>>>>>>>>>>
79341>>>>>>>>>>>
79341>>>>>>>>>>>    End_Object 
79342>>>>>>>>>>>
79342>>>>>>>>>>>    Object oOk_bn is a Button
79344>>>>>>>>>>>        Set Label to "&Ok"
79345>>>>>>>>>>>        Set Location to 137 306
79346>>>>>>>>>>>        Set peAnchors to anBottomRight
79347>>>>>>>>>>>
79347>>>>>>>>>>>        Procedure OnClick
79350>>>>>>>>>>>            Send OK of oSelList
79351>>>>>>>>>>>        End_Procedure
79352>>>>>>>>>>>
79352>>>>>>>>>>>    End_Object 
79353>>>>>>>>>>>
79353>>>>>>>>>>>    Object oCancel_bn is a Button
79355>>>>>>>>>>>        Set Label to "&Cancel"
79356>>>>>>>>>>>        Set Location to 137 360
79357>>>>>>>>>>>        Set peAnchors to anBottomRight
79358>>>>>>>>>>>
79358>>>>>>>>>>>        Procedure OnClick
79361>>>>>>>>>>>            Send Cancel of oSelList
79362>>>>>>>>>>>        End_Procedure
79363>>>>>>>>>>>
79363>>>>>>>>>>>    End_Object 
79364>>>>>>>>>>>
79364>>>>>>>>>>>    Object oSearch_bn is a Button
79366>>>>>>>>>>>        Set Label to "&Search..."
79367>>>>>>>>>>>        Set Location to 137 414
79368>>>>>>>>>>>        Set peAnchors to anBottomRight
79369>>>>>>>>>>>
79369>>>>>>>>>>>        Procedure OnClick
79372>>>>>>>>>>>            Send Search of oSelList
79373>>>>>>>>>>>        End_Procedure
79374>>>>>>>>>>>
79374>>>>>>>>>>>    End_Object 
79375>>>>>>>>>>>
79375>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
79376>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
79377>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
79378>>>>>>>>>>>
79378>>>>>>>>>>>
79378>>>>>>>>>>>CD_End_Object // oSLGPARAM
79380>>>>>>>>>>>>
79380>>>>>>>Use GUSER.dd
Including file: GUSER.dd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GUSER.dd)
79380>>>>>>>>>Use DataDict.pkg
79380>>>>>>>>>Use BPCoreBase.bp
79380>>>>>>>>>
79380>>>>>>>>>Open GUSER
Including file: GUSER.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GUSER.fd)
79382>>>>>>>>>
79382>>>>>>>>>Register_Object oSLGUSER
79382>>>>>>>>>
79382>>>>>>>>>Class GUSERDataDictionary is a DataDictionary
79383>>>>>>>>>    
79383>>>>>>>>>    Procedure Construct_Object
79385>>>>>>>>>        Forward Send Construct_Object
79387>>>>>>>>>        Set Main_File to GUSER.File_Number
79388>>>>>>>>>
79388>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79389>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79390>>>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79391>>>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79392>>>>>>>>>
79392>>>>>>>>>        Set Field_Prompt_Object Field GUSER.ID to oSLGUSER
79393>>>>>>>>>        Set Field_Option Field GUSER.ID DD_AUTOFIND to True
79394>>>>>>>>>        Set Key_Field_State Field GUSER.ID to True
79395>>>>>>>>>        
79395>>>>>>>>>//        Set Field_Value_Table Field GUSER.ATIVO to oStatusUSER
79395>>>>>>>>>
79395>>>>>>>>>    End_Procedure
79396>>>>>>>>>
79396>>>>>>>>>    Procedure Field_Defaults
79398>>>>>>>>>        Forward Send Field_Defaults
79400>>>>>>>>>        Set Field_Changed_Value Field GUSER.ATIVO to 1
79401>>>>>>>>>    End_Procedure
79402>>>>>>>>>
79402>>>>>>>>>    Procedure Update
79404>>>>>>>>>        Forward Send Update
79406>>>>>>>>>    End_Procedure
79407>>>>>>>>>
79407>>>>>>>>>End_Class
79408>>>>>>>>>
79408>>>>>>>>>Use SLGUSER.sl
Including file: SLGUSER.sl    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\SLGUSER.sl)
79408>>>>>>>>>>>// SLGUSER.sl
79408>>>>>>>>>>>// Consulta de Usu rios
79408>>>>>>>>>>>
79408>>>>>>>>>>>Use DFClient.pkg
79408>>>>>>>>>>>Use cDbCJGridPromptList.pkg
79408>>>>>>>>>>>Use cDbCJGridColumn.pkg
79408>>>>>>>>>>>Use Windows.pkg
79408>>>>>>>>>>>
79408>>>>>>>>>>>Use GUSER.dd
79408>>>>>>>>>>>
79408>>>>>>>>>>>CD_Popup_Object oSLGUSER is a dbModalPanel
79426>>>>>>>>>>>>
79426>>>>>>>>>>>    Set Location to 5 5
79427>>>>>>>>>>>    Set Size to 134 326
79428>>>>>>>>>>>    Set Label To "Consulta de Usu rios"
79429>>>>>>>>>>>    Set Border_Style to Border_Thick
79430>>>>>>>>>>>    Set Minimize_Icon to False
79431>>>>>>>>>>>
79431>>>>>>>>>>>
79431>>>>>>>>>>>    Object oGUSER_DD is a GUSERDataDictionary
79433>>>>>>>>>>>    End_Object 
79434>>>>>>>>>>>
79434>>>>>>>>>>>    Set Main_DD To oGUSER_DD
79435>>>>>>>>>>>    Set Server  To oGUSER_DD
79436>>>>>>>>>>>
79436>>>>>>>>>>>
79436>>>>>>>>>>>
79436>>>>>>>>>>>    Object oSelList is a cDbCJGridPromptList
79438>>>>>>>>>>>        Set Size to 105 316
79439>>>>>>>>>>>        Set Location to 5 5
79440>>>>>>>>>>>        Set peAnchors to anAll
79441>>>>>>>>>>>        Set psLayoutSection to "oSLGUSER_oSelList"
79442>>>>>>>>>>>        Set Ordering to 1
79443>>>>>>>>>>>        Set pbAutoServer to True
79444>>>>>>>>>>>
79444>>>>>>>>>>>        Object oGUSER_ID is a cDbCJGridColumn
79446>>>>>>>>>>>            Entry_Item GUSER.ID
79447>>>>>>>>>>>            Set piWidth to 217
79448>>>>>>>>>>>            Set psCaption to "Id"
79449>>>>>>>>>>>        End_Object 
79450>>>>>>>>>>>
79450>>>>>>>>>>>        Object oGUSER_NOME is a cDbCJGridColumn
79452>>>>>>>>>>>            Entry_Item GUSER.NOME
79453>>>>>>>>>>>            Set piWidth to 248
79454>>>>>>>>>>>            Set psCaption to "Nome"
79455>>>>>>>>>>>        End_Object 
79456>>>>>>>>>>>
79456>>>>>>>>>>>        Object oGUSER_ATIVO is a cDbCJGridColumn
79458>>>>>>>>>>>            Entry_Item GUSER.ATIVO
79459>>>>>>>>>>>            Set piWidth to 88
79460>>>>>>>>>>>            Set psCaption to "Situa‡Æo"
79461>>>>>>>>>>>        End_Object 
79462>>>>>>>>>>>
79462>>>>>>>>>>>
79462>>>>>>>>>>>    End_Object 
79463>>>>>>>>>>>
79463>>>>>>>>>>>    Object oOk_bn is a Button
79465>>>>>>>>>>>        Set Label to "&Ok"
79466>>>>>>>>>>>        Set Location to 115 163
79467>>>>>>>>>>>        Set peAnchors to anBottomRight
79468>>>>>>>>>>>
79468>>>>>>>>>>>        Procedure OnClick
79471>>>>>>>>>>>            Send OK of oSelList
79472>>>>>>>>>>>        End_Procedure
79473>>>>>>>>>>>
79473>>>>>>>>>>>    End_Object 
79474>>>>>>>>>>>
79474>>>>>>>>>>>    Object oCancel_bn is a Button
79476>>>>>>>>>>>        Set Label to "&Cancel"
79477>>>>>>>>>>>        Set Location to 115 217
79478>>>>>>>>>>>        Set peAnchors to anBottomRight
79479>>>>>>>>>>>
79479>>>>>>>>>>>        Procedure OnClick
79482>>>>>>>>>>>            Send Cancel of oSelList
79483>>>>>>>>>>>        End_Procedure
79484>>>>>>>>>>>
79484>>>>>>>>>>>    End_Object 
79485>>>>>>>>>>>
79485>>>>>>>>>>>    Object oSearch_bn is a Button
79487>>>>>>>>>>>        Set Label to "&Search..."
79488>>>>>>>>>>>        Set Location to 115 271
79489>>>>>>>>>>>        Set peAnchors to anBottomRight
79490>>>>>>>>>>>
79490>>>>>>>>>>>        Procedure OnClick
79493>>>>>>>>>>>            Send Search of oSelList
79494>>>>>>>>>>>        End_Procedure
79495>>>>>>>>>>>
79495>>>>>>>>>>>    End_Object 
79496>>>>>>>>>>>
79496>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
79497>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
79498>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
79499>>>>>>>>>>>
79499>>>>>>>>>>>
79499>>>>>>>>>>>CD_End_Object // oSLGUSER
79501>>>>>>>>>>>>
79501>>>>>>>Use GOBJETOH.dd
Including file: GOBJETOH.dd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GOBJETOH.dd)
79501>>>>>>>>>Use DataDict.pkg
79501>>>>>>>>>Use ListValidationTable.pkg
Including file: ListValidationTable.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\ListValidationTable.pkg)
79501>>>>>>>>>>>//FRDVH
79501>>>>>>>>>>>//Object oListaMesRDV is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Janeiro"
79501>>>>>>>>>>>//        Send Add_Table_Value "2" "Fevereiro"
79501>>>>>>>>>>>//        Send Add_Table_Value "3" "Mar‡o"
79501>>>>>>>>>>>//        Send Add_Table_Value "4" "Abril"
79501>>>>>>>>>>>//        Send Add_Table_Value "5" "Maio"
79501>>>>>>>>>>>//        Send Add_Table_Value "6" "Junho"
79501>>>>>>>>>>>//        Send Add_Table_Value "7" "Julho"
79501>>>>>>>>>>>//        Send Add_Table_Value "8" "Agosto"
79501>>>>>>>>>>>//        Send Add_Table_Value "9" "Setembro"
79501>>>>>>>>>>>//        Send Add_Table_Value "10" "Outubro"
79501>>>>>>>>>>>//        Send Add_Table_Value "11" "Novembro"
79501>>>>>>>>>>>//        Send Add_Table_Value "12" "Dezembro"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//Object oStatusRDV is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Aberto"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Fechado"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//Object oTipoCalcRDV is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "L¡quido"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Bruto"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//FRDVDESP
79501>>>>>>>>>>>//Object oListaTiposRDVDESP is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Adto."
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Sal rio"
79501>>>>>>>>>>>//        Send Add_Table_Value "2" "Desp. Pe‡as"
79501>>>>>>>>>>>//        Send Add_Table_Value "3" "Abast. Ext."
79501>>>>>>>>>>>//        Send Add_Table_Value "4" "Desp. Diversas"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//GFILTREL
79501>>>>>>>>>>>//Object oTipoFILTREL is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Igual"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Inicial/Final"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//Object oTipoControleFILTREL is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Form"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "ComboForm"
79501>>>>>>>>>>>//        Send Add_Table_Value "2" "CheckBox"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//GUSER
79501>>>>>>>>>>>//Object oStatusUSER is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Inativo"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Ativo"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//GVIEWUSER
79501>>>>>>>>>>>//Se alterar essa lista, alterar tamb‚m na GWVIEWS.dd
79501>>>>>>>>>>>//Object oStatusVIEW is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Inabilitado"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Habilitado"
79501>>>>>>>>>>>//        Send Add_Table_Value "2" "Leitura"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//GWVIEW
79501>>>>>>>>>>>//Se alterar essa lista, alterar tamb‚m na GVIEWUSER.dd E GWVIEWUSE.DD
79501>>>>>>>>>>>//Object oStatusWVIEW is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Inabilitado"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Habilitado"
79501>>>>>>>>>>>//        Send Add_Table_Value "2" "Leitura"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>>>
79501>>>>>>>>>>>//GWVIEWUSE
79501>>>>>>>>>>>//Se alterar essa lista, alterar tamb‚m na GVIEWUSER.dd E GWVIEWS.DD
79501>>>>>>>>>>>//Object oStatusWVIEWUSE is a DescriptionValidationTable
79501>>>>>>>>>>>//    Procedure Fill_List
79501>>>>>>>>>>>//        Forward Send Fill_List
79501>>>>>>>>>>>//        Send Add_Table_Value "0" "Inabilitado"
79501>>>>>>>>>>>//        Send Add_Table_Value "1" "Habilitado"
79501>>>>>>>>>>>//        Send Add_Table_Value "2" "Leitura"
79501>>>>>>>>>>>//    End_Procedure
79501>>>>>>>>>>>//End_Object
79501>>>>>>>>>
79501>>>>>>>>>Open GOBJETOH
Including file: GOBJETOH.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GOBJETOH.fd)
79503>>>>>>>>>Open GOBJETOI
Including file: GOBJETOI.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GOBJETOI.fd)
79505>>>>>>>>>
79505>>>>>>>>>Register_Object oSLOBJETOS
79505>>>>>>>>>
79505>>>>>>>>>Class GOBJETOHDataDictionary is a DataDictionary
79506>>>>>>>>>    
79506>>>>>>>>>    Procedure Construct_Object
79508>>>>>>>>>        Forward Send Construct_Object
79510>>>>>>>>>        Set Main_File to GOBJETOH.File_Number
79511>>>>>>>>>
79511>>>>>>>>>        Set Add_Client_File to GOBJETOI.File_Number
79512>>>>>>>>>
79512>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79513>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79514>>>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79515>>>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79516>>>>>>>>>
79516>>>>>>>>>        Set Field_Option Field GOBJETOH.OBJETO DD_AUTOFIND to True
79517>>>>>>>>>        Set Key_Field_State Field GOBJETOH.OBJETO to True
79518>>>>>>>>>        Set Field_Prompt_Object Field GOBJETOH.OBJETO to oSLOBJETOS
79519>>>>>>>>>
79519>>>>>>>>>    End_Procedure
79520>>>>>>>>>
79520>>>>>>>>>End_Class
79521>>>>>>>>>
79521>>>>>>>>>Use SLOBJETOS.sl
Including file: SLOBJETOS.sl    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\SLOBJETOS.sl)
79521>>>>>>>>>>>// SLOBJETOS.sl
79521>>>>>>>>>>>// Consulta de Objetos
79521>>>>>>>>>>>
79521>>>>>>>>>>>Use DFClient.pkg
79521>>>>>>>>>>>Use cDbCJGridPromptList.pkg
79521>>>>>>>>>>>Use cDbCJGridColumn.pkg
79521>>>>>>>>>>>Use Windows.pkg
79521>>>>>>>>>>>
79521>>>>>>>>>>>Use GOBJETOH.dd
79521>>>>>>>>>>>
79521>>>>>>>>>>>CD_Popup_Object oSLOBJETOS is a dbModalPanel
79539>>>>>>>>>>>>
79539>>>>>>>>>>>    Set Location to 5 5
79540>>>>>>>>>>>    Set Size to 134 440
79541>>>>>>>>>>>    Set Label To "Consulta de Objetos"
79542>>>>>>>>>>>    Set Border_Style to Border_Thick
79543>>>>>>>>>>>    Set Minimize_Icon to False
79544>>>>>>>>>>>
79544>>>>>>>>>>>
79544>>>>>>>>>>>    Object oGOBJETOH_DD is a GOBJETOHDataDictionary
79546>>>>>>>>>>>    End_Object 
79547>>>>>>>>>>>
79547>>>>>>>>>>>    Set Main_DD To oGOBJETOH_DD
79548>>>>>>>>>>>    Set Server  To oGOBJETOH_DD
79549>>>>>>>>>>>
79549>>>>>>>>>>>
79549>>>>>>>>>>>
79549>>>>>>>>>>>    Object oSelList is a cDbCJGridPromptList
79551>>>>>>>>>>>        Set Size to 105 430
79552>>>>>>>>>>>        Set Location to 5 5
79553>>>>>>>>>>>        Set peAnchors to anAll
79554>>>>>>>>>>>        Set psLayoutSection to "oSLOBJETOS_oSelList"
79555>>>>>>>>>>>        Set Ordering to 1
79556>>>>>>>>>>>        Set pbAutoServer to True
79557>>>>>>>>>>>
79557>>>>>>>>>>>        Object oGOBJETOH_OBJETO is a cDbCJGridColumn
79559>>>>>>>>>>>            Entry_Item GOBJETOH.OBJETO
79560>>>>>>>>>>>            Set piWidth to 262
79561>>>>>>>>>>>            Set psCaption to "Objeto"
79562>>>>>>>>>>>        End_Object 
79563>>>>>>>>>>>
79563>>>>>>>>>>>        Object oGOBJETOH_LABEL_LONG is a cDbCJGridColumn
79565>>>>>>>>>>>            Entry_Item GOBJETOH.LABEL_LONG
79566>>>>>>>>>>>            Set piWidth to 262
79567>>>>>>>>>>>            Set psCaption to "Label Long"
79568>>>>>>>>>>>        End_Object 
79569>>>>>>>>>>>
79569>>>>>>>>>>>        Object oGOBJETOH_LABEL_SHORT is a cDbCJGridColumn
79571>>>>>>>>>>>            Entry_Item GOBJETOH.LABEL_SHORT
79572>>>>>>>>>>>            Set piWidth to 210
79573>>>>>>>>>>>            Set psCaption to "Label Short"
79574>>>>>>>>>>>        End_Object 
79575>>>>>>>>>>>
79575>>>>>>>>>>>
79575>>>>>>>>>>>    End_Object 
79576>>>>>>>>>>>
79576>>>>>>>>>>>    Object oOk_bn is a Button
79578>>>>>>>>>>>        Set Label to "&Ok"
79579>>>>>>>>>>>        Set Location to 115 277
79580>>>>>>>>>>>        Set peAnchors to anBottomRight
79581>>>>>>>>>>>
79581>>>>>>>>>>>        Procedure OnClick
79584>>>>>>>>>>>            Send OK of oSelList
79585>>>>>>>>>>>        End_Procedure
79586>>>>>>>>>>>
79586>>>>>>>>>>>    End_Object 
79587>>>>>>>>>>>
79587>>>>>>>>>>>    Object oCancel_bn is a Button
79589>>>>>>>>>>>        Set Label to "&Cancel"
79590>>>>>>>>>>>        Set Location to 115 331
79591>>>>>>>>>>>        Set peAnchors to anBottomRight
79592>>>>>>>>>>>
79592>>>>>>>>>>>        Procedure OnClick
79595>>>>>>>>>>>            Send Cancel of oSelList
79596>>>>>>>>>>>        End_Procedure
79597>>>>>>>>>>>
79597>>>>>>>>>>>    End_Object 
79598>>>>>>>>>>>
79598>>>>>>>>>>>    Object oSearch_bn is a Button
79600>>>>>>>>>>>        Set Label to "&Search..."
79601>>>>>>>>>>>        Set Location to 115 385
79602>>>>>>>>>>>        Set peAnchors to anBottomRight
79603>>>>>>>>>>>
79603>>>>>>>>>>>        Procedure OnClick
79606>>>>>>>>>>>            Send Search of oSelList
79607>>>>>>>>>>>        End_Procedure
79608>>>>>>>>>>>
79608>>>>>>>>>>>    End_Object 
79609>>>>>>>>>>>
79609>>>>>>>>>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_bn
79610>>>>>>>>>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_bn
79611>>>>>>>>>>>    On_Key Key_Alt+Key_S Send KeyAction of oSearch_bn
79612>>>>>>>>>>>
79612>>>>>>>>>>>
79612>>>>>>>>>>>CD_End_Object // oSLOBJETOS
79614>>>>>>>>>>>>
79614>>>>>>>Use GOBJETOI.dd
Including file: GOBJETOI.dd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GOBJETOI.dd)
79614>>>>>>>>>Use DataDict.pkg
79614>>>>>>>>>
79614>>>>>>>>>Open GOBJETOI
79616>>>>>>>>>Open GOBJETOH
79618>>>>>>>>>
79618>>>>>>>>>Class GOBJETOIDataDictionary is a DataDictionary
79619>>>>>>>>>    
79619>>>>>>>>>    Procedure Construct_Object
79621>>>>>>>>>        Forward Send Construct_Object
79623>>>>>>>>>        Set Main_File to GOBJETOI.File_Number
79624>>>>>>>>>
79624>>>>>>>>>        Set Add_Server_File to GOBJETOH.File_Number
79625>>>>>>>>>
79625>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
79626>>>>>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
79627>>>>>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
79628>>>>>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
79629>>>>>>>>>
79629>>>>>>>>>        Set Field_Option Field GOBJETOI.OBJETO DD_AUTOFIND to True
79630>>>>>>>>>        Set Key_Field_State Field GOBJETOI.OBJETO to True
79631>>>>>>>>>
79631>>>>>>>>>        Set Field_Option Field GOBJETOI.SEQ DD_AUTOFIND to True
79632>>>>>>>>>        Set Key_Field_State Field GOBJETOI.SEQ to True
79633>>>>>>>>>
79633>>>>>>>>>    End_Procedure
79634>>>>>>>>>
79634>>>>>>>>>End_Class
79635>>>>>>>
79635>>>>>>>Object oBPCoreBase is a BusinessProcess
79637>>>>>>>    Open GCIDADES
79639>>>>>>>    Open GQUERIES
79641>>>>>>>    Open GPARAM
79643>>>>>>>    Open GUSER
79645>>>>>>>    Open GOBJETOH
79647>>>>>>>    Open GOBJETOI
79649>>>>>>>    
79649>>>>>>>    // Send DoProcess to this BPO to start the business process
79649>>>>>>>    // DoProcess is a predefined method in the BusinessProcess class
79649>>>>>>>    // Send DoProcess of oNewBusinessProcess
79649>>>>>>>
79649>>>>>>>    // OnProcess
79649>>>>>>>    // ---------
79649>>>>>>>    // Place your processing code into Procedure OnProcess
79649>>>>>>>    // OnProcess is a predefined method in the BusinessProcess class
79649>>>>>>>
79649>>>>>>>    Procedure OnProcess
79652>>>>>>>    End_Procedure
79653>>>>>>>    
79653>>>>>>>    Function Salva_Header_Geral Integer iDD Returns Integer
79656>>>>>>>        Integer Rec Changed Srvr
79656>>>>>>>    
79656>>>>>>>        //Get Server of to Srvr                      // qual o ddo principal
79656>>>>>>>        Get Current_Record  of iDD to Rec       // qual o registro corrente.
79657>>>>>>>        Get Should_Save     of iDD to Changed              // houve mudancas?
79658>>>>>>>    
79658>>>>>>>        // se nao existe registro ativo retorna erro
79658>>>>>>>        If (Rec=0 and Changed=0) Begin // sem registro        
79660>>>>>>>            Send Stop_Box 'Entre com dados no arquivo principal' 'Erro'
79661>>>>>>>            Function_Return 1
79662>>>>>>>        End
79662>>>>>>>>
79662>>>>>>>    
79662>>>>>>>        // Salva o registro da Header
79662>>>>>>>        //request_save_no_clear salva mais nao limpa o buffer
79662>>>>>>>        Send request_save_no_clear  of iDD
79663>>>>>>>        Get Should_Save             of iDD to Changed
79664>>>>>>>        Get Current_record of iDD to Rec
79665>>>>>>>        //If (Rec=0 or Changed) Function_Return 1
79665>>>>>>>        If (Rec=0) Function_Return 1
79668>>>>>>>    End_Function
79669>>>>>>>    
79669>>>>>>>    Function StringToArray String sSrc String sDelim Returns String[]
79672>>>>>>>        Integer iPos iCtr
79672>>>>>>>        String[] sData
79673>>>>>>>        String sWordDiv
79673>>>>>>>    
79673>>>>>>>        Move (Trim(sDelim)) to sDelim
79674>>>>>>>        Move (Trim(sSrc)) to sSrc
79675>>>>>>>        Move (Character(10) + Character(13) + " ;") to sWordDiv
79676>>>>>>>    
79676>>>>>>>        Repeat
79676>>>>>>>>
79676>>>>>>>            Move (Pos(Uppercase(sDelim), Uppercase(sSrc), iPos)) to iPos
79677>>>>>>>            If (iPos > 0) Begin
79679>>>>>>>                Move (Mid(sSrc, Length(sDelim), iPos)) to sDelim
79680>>>>>>>                If (sWordDiv contains Mid(sSrc, 1, iPos - 1) and ;                   (sWordDiv contains Mid(sSrc, 1, iPos + Length(sDelim)) or ;                   (iPos + Length(sDelim) - 1) = Length(sSrc))) Begin
79682>>>>>>>                    Move (Left(sSrc, (iPos-1))) to sData[iCtr]
79683>>>>>>>                    Move (Replace(sData[iCtr], sSrc, '')) to sSrc
79684>>>>>>>                    Move (Replace(sDelim, sSrc, '')) to sSrc
79685>>>>>>>                    Increment iCtr
79686>>>>>>>                    Move 0 to iPos
79687>>>>>>>                End
79687>>>>>>>>
79687>>>>>>>                Else Move (iPos + Length(sDelim)) to iPos
79689>>>>>>>            End
79689>>>>>>>>
79689>>>>>>>            Else Break
79691>>>>>>>        Loop
79692>>>>>>>>
79692>>>>>>>    
79692>>>>>>>        If (Length(Trim(sSrc)) > 0) Begin
79694>>>>>>>            Move sSrc to sData[iCtr]
79695>>>>>>>        End
79695>>>>>>>>
79695>>>>>>>    
79695>>>>>>>        Function_Return sData
79696>>>>>>>    End_Function
79697>>>>>>>    
79697>>>>>>>    Function HowManyWords String src# String dlm# Returns Integer
79700>>>>>>>      local Integer count# Pos# in_item# len#
79700>>>>>>>      local String atom#
79700>>>>>>>      Move 0 to count#
79701>>>>>>>      Move 0 to in_item#
79702>>>>>>>      Move (Length(src#)) to len#
79703>>>>>>>      For Pos# from 1 to len#
79709>>>>>>>>
79709>>>>>>>        Mid src# to atom# 1 Pos#
79712>>>>>>>>
79712>>>>>>>        If in_item# Begin
79714>>>>>>>          If atom# in dlm# Move 0 to in_item#
79717>>>>>>>        End
79717>>>>>>>>
79717>>>>>>>        Else Begin
79718>>>>>>>          ifnot atom# in dlm# Begin
79720>>>>>>>            Increment count#
79721>>>>>>>            Move 1 to in_item#
79722>>>>>>>          End
79722>>>>>>>>
79722>>>>>>>        End
79722>>>>>>>>
79722>>>>>>>      Loop
79723>>>>>>>>
79723>>>>>>>      Function_Return count#
79724>>>>>>>    End_Function
79725>>>>>>>
79725>>>>>>>    Function ExtractWord2 String src# String dlm# Integer itm# Returns String
79728>>>>>>>      local Integer count# Pos# len#
79728>>>>>>>      local String rval# Char#
79728>>>>>>>      Move "" to rval#
79729>>>>>>>      Move 1 to count#
79730>>>>>>>      Move (Length(src#)) to len#
79731>>>>>>>      For Pos# from 1 to len#
79737>>>>>>>>
79737>>>>>>>        Mid src# to Char# 1 Pos#
79740>>>>>>>>
79740>>>>>>>        If Char# in dlm# Begin
79742>>>>>>>          If itm# eq count# Function_Return rval#
79745>>>>>>>          Increment count#
79746>>>>>>>        End
79746>>>>>>>>
79746>>>>>>>        Else If itm# eq count# Move (rval#+Char#) to rval#
79750>>>>>>>      Loop
79751>>>>>>>>
79751>>>>>>>      Function_Return rval#
79752>>>>>>>    End_Function
79753>>>>>>>    
79753>>>>>>>    Function ExtractWord String src# String dlm# Integer itm# Returns String
79756>>>>>>>      local Integer count# Pos# in_item# len#
79756>>>>>>>      local String rval# atom#
79756>>>>>>>      Move "" to rval#
79757>>>>>>>      Move 0 to count#
79758>>>>>>>      Move 0 to in_item#
79759>>>>>>>      Move (Length(src#)) to len#
79760>>>>>>>      For Pos# from 1 to len#
79766>>>>>>>>
79766>>>>>>>        Mid src# to atom# 1 Pos#
79769>>>>>>>>
79769>>>>>>>        If in_item# Begin
79771>>>>>>>          If atom# in dlm# Move 0 to in_item#
79774>>>>>>>          Else If count# eq itm# Append rval# atom#
79778>>>>>>>        End
79778>>>>>>>>
79778>>>>>>>        Else Begin
79779>>>>>>>          ifnot atom# in dlm# Begin
79781>>>>>>>            Increment count#
79782>>>>>>>            Move 1 to in_item#
79783>>>>>>>            If count# eq itm# Move atom# to rval#
79786>>>>>>>          End
79786>>>>>>>>
79786>>>>>>>        End
79786>>>>>>>>
79786>>>>>>>      Loop
79787>>>>>>>>
79787>>>>>>>      Function_Return rval#
79788>>>>>>>    End_Function
79789>>>>>>>    
79789>>>>>>>    Procedure pCarregaDadosERP String teste
79792>>>>>>>    End_Procedure
79793>>>>>>>    
79793>>>>>>>    Procedure Execute_ScriptSQL String sCodigoQuery String sParametros Integer iStatusPanel String sMsgPanel Handle hArray Boolean bNewConn
79796>>>>>>>        Handle  hSQL hstmt
79796>>>>>>>        Integer iQtdeParam iLoop iNumColumns iFetchResult iPosicao iContaColuna iChanel iApp iResult 
79796>>>>>>>        Integer iColType iColSize iMaxSize
79796>>>>>>>        Boolean bTemQueryPlus
79796>>>>>>>        
79796>>>>>>>        Get_Argument_Size to iMaxSize
79797>>>>>>>        
79797>>>>>>>        //Set_Argument_Size 100000
79797>>>>>>>        
79797>>>>>>>        String sQuery sVariavel sParametro sQueryAntes sValue sDataPath sSufixoCustom sCodigoQueryUpper
79797>>>>>>>        
79797>>>>>>>        Move (UpperCase(Trim(sCodigoQuery))) to sCodigoQueryUpper
79798>>>>>>>        
79798>>>>>>>        //Move sCodigoQuery to gsExecScript
79798>>>>>>>        
79798>>>>>>>        Clear GQUERIES
79799>>>>>>>        Move sCodigoQueryUpper to GQUERIES.CODIGO
79800>>>>>>>        Find eq GQUERIES by Index.1
79801>>>>>>>>
79801>>>>>>>    
79801>>>>>>>        // SETA O STATUS PANEL
79801>>>>>>>        If (iStatusPanel>0) Begin
79803>>>>>>>            If ((Found) and (Trim(GQUERIES.DESCRICAO)) ne "") Send Update_statuspanel of iStatusPanel  (Trim(GQUERIES.DESCRICAO))
79806>>>>>>>            Else Begin
79807>>>>>>>                If ((Trim(sMsgPanel)) = "") Send Update_statuspanel of iStatusPanel "Processando..."
79810>>>>>>>                Else Send Update_statuspanel of iStatusPanel  sMsgPanel 
79812>>>>>>>            End
79812>>>>>>>>
79812>>>>>>>        End    
79812>>>>>>>>
79812>>>>>>>    
79812>>>>>>>        Get phoWorkspace of (oApplication(Self)) to iApp
79813>>>>>>>        Get psDataPath   of iApp to sDataPath            // Pega o diretorio data onde serao guardados os querys SQL
79814>>>>>>>    
79814>>>>>>>//        If (gsWriteQuery = "S" and gbWriteQuery) Begin
79814>>>>>>>        File_Exist (sDataPath + "\SQL") iResult    // Testa se o diret¢tio existe, senao ele cria
79815>>>>>>>        If (not(iResult)) Begin
79817>>>>>>>            Make_Directory ( sDataPath+"\SQL")
79818>>>>>>>        End
79818>>>>>>>>
79818>>>>>>>//        End
79818>>>>>>>        
79818>>>>>>>        // VERIFICA SE  UM SELECT CADASTRADO OU NAO
79818>>>>>>>        //
79818>>>>>>>        Move '_CUSTOM' to sSufixoCustom
79819>>>>>>>        If (Uppercase(sParametros) <> 'NOFIND')  Begin
79821>>>>>>>        
79821>>>>>>>            Get HowManyWords of (oBPCoreBase(Self)) sParametros ";" to iQtdeParam
79822>>>>>>>        
79822>>>>>>>            Clear GQUERIES
79823>>>>>>>            Move (Trim(sCodigoQuery) + Trim(sSufixoCustom)) to GQUERIES.CODIGO
79824>>>>>>>            Find eq GQUERIES by Index.1
79825>>>>>>>>
79825>>>>>>>            If (not (Found)) Begin
79827>>>>>>>                Clear GQUERIES
79828>>>>>>>                Move sCodigoQuery to GQUERIES.CODIGO
79829>>>>>>>                Find eq GQUERIES by Index.1
79830>>>>>>>>
79830>>>>>>>            End
79830>>>>>>>>
79830>>>>>>>            If (Found) Begin
79832>>>>>>>                Move (Trim(GQUERIES.QUERY)) to sQuery
79833>>>>>>>    
79833>>>>>>>                // Numero de parametros precisa ser "PAR"
79833>>>>>>>                //
79833>>>>>>>                If (Mod( iQtdeParam ,2)<>0) Begin
79835>>>>>>>                    Send Stop_Box ("N£mero de parƒmetros inv lidos" + " - "+sCodigoQuery) "Aten‡Æo"
79836>>>>>>>                    //Move "" to gsExecScript
79836>>>>>>>                    Procedure_Return
79837>>>>>>>                End
79837>>>>>>>>
79837>>>>>>>        
79837>>>>>>>                For iLoop from 1 to (iQtdeParam/2)
79843>>>>>>>>
79843>>>>>>>                    Get ExtractWord of (oBPCoreBase(Self)) sParametros ";" ((iLoop*2)-1)    to sVariavel
79844>>>>>>>                    Get ExtractWord of (oBPCoreBase(Self)) sParametros ";" (iLoop*2)        to sParametro
79845>>>>>>>                    Move sQuery to sQueryAntes
79846>>>>>>>    
79846>>>>>>>                    Move (Replaces(sVariavel,sQuery,sParametro)) to sQuery
79847>>>>>>>                    
79847>>>>>>>                Loop
79848>>>>>>>>
79848>>>>>>>                                   
79848>>>>>>>//                If (gsWriteQuery = "S" and gbWriteQuery) Begin
79848>>>>>>>                    Get Seq_New_Channel to iChanel
79849>>>>>>>                    Direct_Output channel iChanel (sDataPath +'\SQL\'+  sCodigoQuery + '_' + Trim(Uppercase(gsCodUser)) + ".sql.txt")
79851>>>>>>>                    Writeln channel iChanel sQuery
79854>>>>>>>                    Close_Output channel iChanel
79856>>>>>>>                    Send Seq_Release_Channel iChanel
79857>>>>>>>//                End
79857>>>>>>>                
79857>>>>>>>                // Tira os CR+ENTER do query
79857>>>>>>>                //
79857>>>>>>>                //Move (Character(13) + Character(10))    to sCRLF
79857>>>>>>>                //Move (Replaces(sCRLF, sQuery, " "))     to sQuery
79857>>>>>>>             
79857>>>>>>>            End
79857>>>>>>>>
79857>>>>>>>            
79857>>>>>>>        End
79857>>>>>>>>
79857>>>>>>>        Else Begin
79858>>>>>>>    
79858>>>>>>>            // Se for apenas um query fixo passado ele converte aqui
79858>>>>>>>            //
79858>>>>>>>            Clear GQUERIES
79859>>>>>>>            Move (Trim(sCodigoQuery) + Trim(sSufixoCustom)) to GQUERIES.CODIGO
79860>>>>>>>            Find eq GQUERIES by Index.1
79861>>>>>>>>
79861>>>>>>>            If (not (Found)) Begin
79863>>>>>>>                Clear GQUERIES
79864>>>>>>>                Move sCodigoQuery to GQUERIES.CODIGO
79865>>>>>>>                Find eq GQUERIES by Index.1
79866>>>>>>>>
79866>>>>>>>            End
79866>>>>>>>>
79866>>>>>>>            If (Found) Begin
79868>>>>>>>                Move (Trim(GQUERIES.QUERY)) to sQuery
79869>>>>>>>            End
79869>>>>>>>>
79869>>>>>>>            Else Begin
79870>>>>>>>                Move sCodigoQuery to sQuery
79871>>>>>>>            End
79871>>>>>>>>
79871>>>>>>>            
79871>>>>>>>            Get Seq_New_Channel to iChanel
79872>>>>>>>            Direct_Output channel iChanel (sDataPath +'\SQL\'+ Trim(Uppercase(gsCodUser)) + '_ultimaquery' + ".sql.txt")
79874>>>>>>>            Writeln channel iChanel sQuery
79877>>>>>>>            Close_Output channel iChanel
79879>>>>>>>            Send Seq_Release_Channel iChanel
79880>>>>>>>        End
79880>>>>>>>>
79880>>>>>>>        
79880>>>>>>>        // ABRE A CONEXAO
79880>>>>>>>        // Cria handle antes da execu‡Æo
79880>>>>>>>        Move giDBCSqlcon to hSQL
79881>>>>>>>        If (Num_Arguments = 6) Begin
79883>>>>>>>            If (bNewConn) Get SQLFileConnect of ghSQLMngr GQUERIES.File_Number to hSQL
79886>>>>>>>        End
79886>>>>>>>>
79886>>>>>>>        Get SQLOpen of hSQL to hstmt
79887>>>>>>>        
79887>>>>>>>//        If (gsIgnoraGO='') Move 'N' to gsIgnoraGO
79887>>>>>>>//        
79887>>>>>>>//        If (gsIgnoraGO='S') Begin
79887>>>>>>>//            Send SQLPrepare of hstmt (ToANSI(sQuery))
79887>>>>>>>//            Send SQLExecute of hstmt        
79887>>>>>>>//        End
79887>>>>>>>//        Else Begin
79887>>>>>>>            Integer iCount iSize
79887>>>>>>>            String[] sScripts
79888>>>>>>>              
79888>>>>>>>           
79888>>>>>>>            Get StringToArray sQuery "GO" to sScripts
79889>>>>>>>            Move (SizeOfArray(sScripts)) to iSize
79890>>>>>>>            
79890>>>>>>>            For iCount from 0 to (iSize-1)
79896>>>>>>>>
79896>>>>>>>                If (not(Uppercase(sScripts[iCount]) contains "CREATE ")) ;                    Move ("SET NOCOUNT ON" + Character(10) + Character(13) + sScripts[iCount] + Character(10) + Character(13) + "SET NOCOUNT OFF") to sScripts[iCount]
79899>>>>>>>        
79899>>>>>>>                Send SQLPrepare of hstmt (ToANSI(sScripts[iCount]))
79900>>>>>>>                Send SQLExecute of hstmt    
79901>>>>>>>            Loop       
79902>>>>>>>>
79902>>>>>>>//        End    
79902>>>>>>>    
79902>>>>>>>        //SQLExecDirect hstmt sQuery
79902>>>>>>>        
79902>>>>>>>        // FER - 14/02/2006 - se foi passado algum array no parametro, ele vai pegar o resultado da query e copiar para dentro desse array
79902>>>>>>>        //
79902>>>>>>>        If (hArray<>0) Begin
79904>>>>>>>        
79904>>>>>>>            Send Delete_data of hArray
79905>>>>>>>            
79905>>>>>>>            Get SQLStmtAttribute of hstmt SQLSTMTATTRIB_COLUMNCOUNT to iNumColumns
79906>>>>>>>                
79906>>>>>>>            If (iNumColumns>0) Begin
79908>>>>>>>                Move 0 to iPosicao
79909>>>>>>>                Repeat
79909>>>>>>>>
79909>>>>>>>                    Get SQLFetch of hstmt to iFetchResult
79910>>>>>>>                    If (iFetchResult <> 0) Begin
79912>>>>>>>                        // Coluna Tipo -152 ‚ XML no SQL
79912>>>>>>>                        For iContaColuna from 1 to iNumColumns
79918>>>>>>>>
79918>>>>>>>                            Get SQLColAttribute of hstmt iContaColuna SQLCOLATTRIB_SQLTYPE to iColType
79919>>>>>>>                            Get SQLColAttribute of hstmt iContaColuna SQLCOLATTRIB_SIZE to iColSize
79920>>>>>>>                            If (iColType = SQL_LONGVARCHAR or iColType = SQL_BINARY or ;                                iColType = SQL_VARBINARY or iColType = SQL_LONGVARBINARY or ;                                iColType = -152 or iColType = SQL_WLONGVARCHAR or ;                                (iColType = SQL_VARCHAR and iColSize <= 0)) ;                                    Get SQLGetData of hstmt iContaColuna iMaxSize to sValue
79923>>>>>>>                            Else Get SQLColumnValue of hstmt iContaColuna to sValue
79925>>>>>>>                            Set Value of hArray iPosicao to (ToOEM(sValue))
79926>>>>>>>                            Increment iPosicao
79927>>>>>>>                        Loop
79928>>>>>>>>
79928>>>>>>>                    End
79928>>>>>>>>
79928>>>>>>>                Until (iFetchResult = 0)
79930>>>>>>>            End
79930>>>>>>>>
79930>>>>>>>            Else Begin
79931>>>>>>>                // Se nao achou nada ele seta com "" a primeira posicao do array
79931>>>>>>>                //
79931>>>>>>>                Set Value of hArray 0 to '' 
79932>>>>>>>            End        
79932>>>>>>>>
79932>>>>>>>            
79932>>>>>>>        End
79932>>>>>>>>
79932>>>>>>>        
79932>>>>>>>        Send SQLClose of hstmt
79933>>>>>>>        If (Num_Arguments = 6) Begin
79935>>>>>>>            If (bNewConn) Send SQLDisconnect of hSQL
79938>>>>>>>        End
79938>>>>>>>>
79938>>>>>>>    
79938>>>>>>>        Set_Argument_Size iMaxSize
79939>>>>>>>>
79939>>>>>>>    
79939>>>>>>>//        Move "" to gsExecScript
79939>>>>>>>    End_Procedure
79940>>>>>>>    
79940>>>>>>>    Function Consulta_ScriptSQL Global String sCodigoQuery String sParametros Integer iStatusPanel String sMsgPanel Boolean bNewConn Returns String
79942>>>>>>>        String sRet 
79942>>>>>>>        Integer iItems
79942>>>>>>>       
79942>>>>>>>        Send Execute_ScriptSQL sCodigoQuery (If(sParametros='','NOFIND',sParametros)) iStatusPanel sMsgPanel giArrayQuery False
79943>>>>>>>        
79943>>>>>>>        Get Item_count of giArrayQuery to iItems
79944>>>>>>>        If (iItems>0) Get value of giArrayQuery 0 to sRet           
79947>>>>>>>        
79947>>>>>>>        Function_Return sRet    
79948>>>>>>>    End_Function
79949>>>>>>>    
79949>>>>>>>    Function Number_Format_2D Global String sValue Returns String
79951>>>>>>>        Move (Replaces('-',sValue,'')) to sValue
79952>>>>>>>        Move (Replaces('.',sValue,',')) to sValue
79953>>>>>>>        Move (FormatValue(sValue,'#.##')) to sValue
79954>>>>>>>        Function_Return sValue
79955>>>>>>>    End_Function
79956>>>>>>>    
79956>>>>>>>    Function Update_Footer String sSQLAgregador String sCampo String sTabela String sSQLFiltro Handle hoColumn Returns String
79959>>>>>>>        String sRetorno
79959>>>>>>>        If (eval(rtrim(sTabela)+'.Recnum')=0) Begin
79961>>>>>>>            If (Uppercase(sSQLAgregador)='SUM') Move 'R$ 0,00'  to sRetorno
79964>>>>>>>            Else Move '0 itens' to sRetorno
79966>>>>>>>            If (hoColumn<>0) Set psFooterText of hoColumn to sRetorno
79969>>>>>>>            Function_Return sRetorno
79970>>>>>>>        End
79970>>>>>>>>
79970>>>>>>>        Get Consulta_ScriptSQL of (oBPCoreBase(Self)) ("select "+sSQLAgregador+"("+sCampo+") from "+sTabela+;                           " WHERE "+ sSQLFiltro) "" 0 "" False to sRetorno
79971>>>>>>>        If (Uppercase(sSQLAgregador)='COUNT') Begin
79973>>>>>>>            If (sRetorno='1') Move (sRetorno+" item")  to sRetorno
79976>>>>>>>            Else              Move (sRetorno+" itens") to sRetorno
79978>>>>>>>        End
79978>>>>>>>>
79978>>>>>>>        If (Uppercase(sSQLAgregador)='SUM') Begin
79980>>>>>>>            Move (Number_Format_2D(sRetorno)) to sRetorno
79981>>>>>>>            Move ("R$ "+sRetorno) to sRetorno
79982>>>>>>>        End
79982>>>>>>>>
79982>>>>>>>        If (hoColumn<>0) Set psFooterText of hoColumn to sRetorno
79985>>>>>>>        Function_Return sRetorno
79986>>>>>>>    End_Function // Update_Footer
79987>>>>>>>    
79987>>>>>>>    Procedure Aplica_FiltroSQL Global Handle hDD Integer iFile String sFilter
79989>>>>>>>        String sSelecaoUser
79989>>>>>>>        Boolean bUserFilter
79989>>>>>>>        
79989>>>>>>>        // Tratativa para filtros dentro de processos que abortam
79989>>>>>>>//        If (ghoActiveProcess) Begin
79989>>>>>>>//            String sOldFilter
79989>>>>>>>//            Handle hoFilters
79989>>>>>>>//            
79989>>>>>>>//            Get_Attribute DF_FILE_SQL_FILTER of iFile to sOldFilter
79989>>>>>>>//            Get psFilters of ghoActiveProcess to hoFilters
79989>>>>>>>//    
79989>>>>>>>//            Send AddValue of hoFilters (String(iFile)) sOldFilter
79989>>>>>>>//        End
79989>>>>>>>        
79989>>>>>>>//        If (hDD) Get pbEnableUserFilter of hDD to bUserFilter
79989>>>>>>>//        Else Move True to bUserFilter
79989>>>>>>>        
79989>>>>>>>//        If (bUserFilter) Get Monta_Selecao_File iFile to sSelecaoUser
79989>>>>>>>//        Send ApplyGlobalFilter hDD iFile (&sFilter)
79989>>>>>>>        
79989>>>>>>>        //PEGA O FILTRO QUE E PASSADO PRA A VARIAVEL NOS EVENTOS PROMPT
79989>>>>>>>        If (Trim(sFilter) <> "") Begin
79991>>>>>>>//            If (Trim(sSelecaoUser) <> "") Move (sFilter + " AND " + sSelecaoUser) to sSelecaoUser
79991>>>>>>>//            Else Move sFilter to sSelecaoUser
79991>>>>>>>            Move sFilter to sSelecaoUser
79992>>>>>>>        End
79992>>>>>>>>
79992>>>>>>>    
79992>>>>>>>        Set_Attribute DF_FILE_SQL_FILTER of iFile to sSelecaoUser
79995>>>>>>>    
79995>>>>>>>        If (sSelecaoUser <> "") Set_Attribute DF_FILE_SQL_FILTER_ACTIVE of iFile to True
80000>>>>>>>        Else Set_Attribute DF_FILE_SQL_FILTER_ACTIVE of iFile to False
80004>>>>>>>    End_Procedure
80005>>>>>>>    
80005>>>>>>>    Function Server_Param String sParamName Returns String
80008>>>>>>>        Clear GPARAM
80009>>>>>>>        Move (Trim(sParamName)) to GPARAM.NOME
80010>>>>>>>        Find eq GPARAM by Index.1
80011>>>>>>>>
80011>>>>>>>        If (Found) Begin
80013>>>>>>>            Function_Return (Trim(GPARAM.VALOR))
80014>>>>>>>        End
80014>>>>>>>>
80014>>>>>>>        Function_Return ""
80015>>>>>>>    End_Function
80016>>>>>>>    
80016>>>>>>>    Function Valida_User String sUser String sSenha Returns Boolean
80019>>>>>>>        String sSenhaCript
80019>>>>>>>        Clear GUSER
80020>>>>>>>        Move (Trim(sUser)) to GUSER.ID
80021>>>>>>>        Find EQ GUSER by index.1
80022>>>>>>>>
80022>>>>>>>        If (Found) Begin
80024>>>>>>>            Get CriptpwdBD sSenha 0 to sSenhaCript
80025>>>>>>>            If (Trim(sSenhaCript) = Trim(GUSER.SENHA)) Function_Return True
80028>>>>>>>            Else Function_Return False
80030>>>>>>>        End
80030>>>>>>>>
80030>>>>>>>        Function_Return False
80031>>>>>>>    End_Function
80032>>>>>>>    
80032>>>>>>>    Procedure Sincroniza_Dados_PSGA
80035>>>>>>>        Send Execute_ScriptSQL "SINCRONIZA_CTE" "NOFIND" 0 "" 0 False
80036>>>>>>>        Send Execute_ScriptSQL "SINCRONIZA_CCUSTO" "NOFIND" 0 "" 0 False
80037>>>>>>>        
80037>>>>>>>    End_Procedure
80038>>>>>>>    
80038>>>>>>>    Function GetPath_WS Global String sTipoPath Returns String
80040>>>>>>>        String sWork
80040>>>>>>>        Handle hoWorkspace 
80040>>>>>>>    
80040>>>>>>>        Get phoWorkspace    of oApplication to hoWorkspace 
80041>>>>>>>        If (Uppercase(sTipoPath) ="DATA");            Get psDataPath      of hoWorkspace  to sWork    
80044>>>>>>>        If (Uppercase(sTipoPath) ="HELP");            Get psHelpPath      of hoWorkspace  to sWork    
80047>>>>>>>        If (Uppercase(sTipoPath) ="BITMAPS");            Get psBitmapPath      of hoWorkspace  to sWork        
80050>>>>>>>        If (Uppercase(sTipoPath) ="PROGRAMS");            Get psProgramPath      of hoWorkspace  to sWork
80053>>>>>>>        If (Uppercase(sTipoPath) ="APPHTML");            Get psAppHtmlPath      of hoWorkspace  to sWork                            
80056>>>>>>>        If (Uppercase(sTipoPath) ="APPSRC");            Get psAppSrcPath       of hoWorkspace  to sWork                                
80059>>>>>>>        If (Uppercase(sTipoPath) ="PERSONALIZADO");            Get PathPersonalizado to sWork
80062>>>>>>>                            
80062>>>>>>>        Function_Return (Uppercase(sWork))
80063>>>>>>>    End_Function
80064>>>>>>>    
80064>>>>>>>    Function PathPersonalizado Returns String
80067>>>>>>>        String  sPath sFile
80067>>>>>>>        Integer iSize
80067>>>>>>>    
80067>>>>>>>        Get GetPath_WS "PROGRAMS" to sPath
80068>>>>>>>    
80068>>>>>>>        // Tira o "\programs"
80068>>>>>>>        Move (Length(sPath)) to iSize
80069>>>>>>>        Move (Remove(sPath, (iSize - 9 + 1), 9)) to sPath
80070>>>>>>>        Append sPath "\Personalizado"
80071>>>>>>>    
80071>>>>>>>        Function_Return sPath
80072>>>>>>>    End_Function
80073>>>>>>>    
80073>>>>>>>    Function Open_File Integer iFile Returns Handle
80076>>>>>>>        Integer iOpenFile
80076>>>>>>>        Handle hTable
80076>>>>>>>        
80076>>>>>>>        Get_Attribute DF_FILE_OPENED of iFile to iOpenfile
80079>>>>>>>        If (not(iOpenfile)) Open iFile as hTable
80083>>>>>>>        Else Move iFile to hTable
80085>>>>>>>        
80085>>>>>>>        Function_Return hTable
80086>>>>>>>    End_Procedure
80087>>>>>>>    
80087>>>>>>>    Procedure Open_file Integer iFile
80090>>>>>>>        Integer iOpenFile
80090>>>>>>>        
80090>>>>>>>        Get_Attribute DF_FILE_OPENED of iFile to iOpenfile
80093>>>>>>>        If (not(iOpenfile)) Open iFile
80097>>>>>>>    End_Procedure
80098>>>>>>>
80098>>>>>>>    //iTipoRet: C_GETDESC_LABEL_LONG
80098>>>>>>>    //          C_GETDESC_LABEL_SHORT
80098>>>>>>>    //          C_GETDESC_STATUS_HELP
80098>>>>>>>    Function Get_Description String sObj Integer iTipoRet Returns String
80101>>>>>>>        Clear GOBJETOH
80102>>>>>>>        Move (Trim(sObj)) to GOBJETOH.OBJETO
80103>>>>>>>        Find EQ GOBJETOH by Index.1
80104>>>>>>>>
80104>>>>>>>        If (Found) Begin
80106>>>>>>>            If (iTipoRet = C_GETDESC_LABEL_SHORT) Function_Return (Trim(GOBJETOH.LABEL_SHORT))
80109>>>>>>>            If (iTipoRet = C_GETDESC_LABEL_LONG) Function_Return (Trim(GOBJETOH.LABEL_LONG))
80112>>>>>>>            If (iTipoRet = C_GETDESC_STATUS_HELP) Function_Return (Trim(GOBJETOH.STATUS_HELP))
80115>>>>>>>        End
80115>>>>>>>>
80115>>>>>>>        Function_Return ""
80116>>>>>>>    End_Function
80117>>>>>>>    
80117>>>>>>>
80117>>>>>>>    // iTipoFind:   C_FINDTYPE_DESCRIPTIONITENS_SEQ
80117>>>>>>>    //              C_FINDTYPE_DESCRIPTIONITENS_LABEL
80117>>>>>>>    //              C_FINDTYPE_DESCRIPTIONITENS_BOTH
80117>>>>>>>    // iTipoRet:    C_RETURNTYPE_DESCRIPTIONITENS_SEQ
80117>>>>>>>    //              C_RETURNTYPE_DESCRIPTIONITENS_LABEL
80117>>>>>>>    //              C_RETURNTYPE_DESCRIPTIONITENS_BOTH
80117>>>>>>>    Function Get_Description_Items String sObj String  sVelueFind Integer iTipoFind Integer iTipoRet Returns String
80120>>>>>>>        String sRetorno
80120>>>>>>>        If (iTipoRet = C_RETURNTYPE_DESCRIPTIONITENS_SEQ) Move "GOBJETOI.SEQ" to sRetorno
80123>>>>>>>        If (iTipoRet = C_RETURNTYPE_DESCRIPTIONITENS_LABEL) Move "GOBJETOI.LABEL" to sRetorno
80126>>>>>>>        If (iTipoRet = C_RETURNTYPE_DESCRIPTIONITENS_BOTH) Move ("(TRIM(GOBJETOI.SEQ)+' - '+TRIM(GOBJETOI.LABEL))") to sRetorno
80129>>>>>>>        
80129>>>>>>>        If (iTipoFind = C_FINDTYPE_DESCRIPTIONITENS_SEQ) Begin
80131>>>>>>>            Clear GOBJETOI
80132>>>>>>>            Move (Trim(sObj))   to GOBJETOI.OBJETO
80133>>>>>>>            Move sVelueFind     to GOBJETOI.SEQ
80134>>>>>>>            Find EQ GOBJETOI by Index.1
80135>>>>>>>>
80135>>>>>>>            If (Found) Begin
80137>>>>>>>                Function_Return (Eval(sRetorno))
80138>>>>>>>            End
80138>>>>>>>>
80138>>>>>>>        End
80138>>>>>>>>
80138>>>>>>>        If (iTipoFind = C_FINDTYPE_DESCRIPTIONITENS_LABEL) Begin
80140>>>>>>>            Clear GOBJETOI
80141>>>>>>>            Move (Trim(sObj)) to GOBJETOI.OBJETO
80142>>>>>>>            Move -1 to GOBJETOI.SEQ
80143>>>>>>>            Repeat 
80143>>>>>>>>
80143>>>>>>>                Find gt GOBJETOI by Index.1
80144>>>>>>>>
80144>>>>>>>                If ((Found) and ((Trim(sObj)) = Trim(GOBJETOI.OBJETO))) Begin
80146>>>>>>>                    If (Trim(Uppercase(sVelueFind)) = Trim(Uppercase(GOBJETOI.LABEL))) Function_Return (Eval(sRetorno))
80149>>>>>>>                End
80149>>>>>>>>
80149>>>>>>>                Else Break
80151>>>>>>>            Loop
80152>>>>>>>>
80152>>>>>>>        End
80152>>>>>>>>
80152>>>>>>>        If (iTipoFind = C_FINDTYPE_DESCRIPTIONITENS_BOTH) Begin
80154>>>>>>>            Clear GOBJETOI
80155>>>>>>>            Move (Trim(sObj)) to GOBJETOI.OBJETO
80156>>>>>>>            Move -1 to GOBJETOI.SEQ
80157>>>>>>>            Repeat 
80157>>>>>>>>
80157>>>>>>>                Find gt GOBJETOI by Index.1
80158>>>>>>>>
80158>>>>>>>                If ((Found) and ((Trim(sObj)) = Trim(GOBJETOI.OBJETO))) Begin
80160>>>>>>>                    If (Trim(Uppercase(sVelueFind)) = (Trim(Uppercase(GOBJETOI.SEQ))+' - '+Trim(Uppercase(GOBJETOI.LABEL)))) Function_Return (Eval(sRetorno))
80163>>>>>>>                End
80163>>>>>>>>
80163>>>>>>>                Else Break
80165>>>>>>>            Loop
80166>>>>>>>>
80166>>>>>>>        End
80166>>>>>>>>
80166>>>>>>>        Function_Return ""
80167>>>>>>>    End_Function
80168>>>>>>>    
80168>>>>>>>    Function Get_List_Object_Array String sObj Returns String[][2]
80171>>>>>>>        String[][2] sArrayRet
80172>>>>>>>        Integer i
80172>>>>>>>        
80172>>>>>>>        Move 0 to i
80173>>>>>>>        Clear GOBJETOI
80174>>>>>>>        Move (Trim(sObj)) to GOBJETOI.OBJETO
80175>>>>>>>        Move -1 to GOBJETOI.SEQ //Faz isso para pegar os campos seq = 0
80176>>>>>>>        Repeat
80176>>>>>>>>
80176>>>>>>>            Find gt GOBJETOI by Index.1
80177>>>>>>>>
80177>>>>>>>            If ((Found) and ((Trim(sObj)) = Trim(GOBJETOI.OBJETO))) Begin
80179>>>>>>>                Move GOBJETOI.SEQ to sArrayRet[i][0]
80180>>>>>>>                Move (Trim(GOBJETOI.LABEL)) to sArrayRet[i][1]
80181>>>>>>>                Increment i
80182>>>>>>>            End
80182>>>>>>>>
80182>>>>>>>            Else Break
80184>>>>>>>        Loop
80185>>>>>>>>
80185>>>>>>>        Function_Return sArrayRet
80186>>>>>>>    End_Function
80187>>>>>>>    
80187>>>>>>>    
80187>>>>>>>    //Retorna o nome do arquivo ou do campo ou dos dois
80187>>>>>>>    //Constantes    C_GETNAME_FILE
80187>>>>>>>    //              C_GETNAME_FIELD
80187>>>>>>>    //              C_GETNAME_BOTH
80187>>>>>>>    //              C_GETNAME_FIELDNUMBER
80187>>>>>>>    Function Get_Names Global Integer iFile Integer iField Integer iTipo Returns String   
80189>>>>>>>        String sFile sField sValue    
80189>>>>>>>        Integer iFieldNumber
80189>>>>>>>        
80189>>>>>>>        Get_Attribute DF_FIELD_NAME         of iFile iField to sField
80192>>>>>>>        //Get_Attribute DF_FILE_LOGICAL_NAME  of iFile        to sFile#
80192>>>>>>>        Get_Attribute DF_FILE_ROOT_NAME     of iFile        to sFile
80195>>>>>>>        Get_Attribute DF_FIELD_NUMBER       of iFile iField to iFieldNumber
80198>>>>>>>    
80198>>>>>>>        If (Pos('.',sFile)) Move (Mid (sFile, (Pos('.',sFile)-1),1)) to sFile
80201>>>>>>>        
80201>>>>>>>        If (iTipo eq C_GETNAME_FILE) Move sFile                     to sValue       // Pega o arquivo
80204>>>>>>>        If (iTipo eq C_GETNAME_FIELD) Move sField                   to sValue       // Pega o campo
80207>>>>>>>        If (iTipo eq C_GETNAME_BOTH) Move (sFile + "." + sField)    to sValue
80210>>>>>>>        If (iTipo eq C_GETNAME_FIELDNUMBER) Move iFieldNumber       to sValue
80213>>>>>>>    
80213>>>>>>>        Function_Return sValue
80214>>>>>>>    End_Function
80215>>>>>>>    
80215>>>>>>>    Procedure LoadValidationTables Handle hDD Integer iFile
80218>>>>>>>        Integer iFields iFieldNumber iSizeArray iCont iCont2
80218>>>>>>>        String  sFile sCampo sObjeto
80218>>>>>>>        String[][2]  sArrayItens
80219>>>>>>>        Handle  hoFile hVT
80219>>>>>>>        
80219>>>>>>>        Get_Attribute DF_FILE_ROOT_NAME     of iFile        to sFile
80222>>>>>>>    
80222>>>>>>>        If (Pos('.',sFile)) Move (Mid (sFile, (Pos('.',sFile)-1),1)) to sFile
80225>>>>>>>        
80225>>>>>>>        Get Open_File of (oBPCoreBase(Self)) iFile to hoFile
80226>>>>>>>        
80226>>>>>>>        Get_Attribute DF_FILE_NUMBER_FIELDS of hoFile to iFields
80229>>>>>>>        
80229>>>>>>>        For iCont from 1 to iFields
80235>>>>>>>>
80235>>>>>>>            Get_Attribute DF_FIELD_NAME         of hoFile iCont to sCampo
80238>>>>>>>            Get_Attribute DF_FIELD_NUMBER       of hoFile iCont to iFieldNumber
80241>>>>>>>            Move (Trim(sFile)+'.'+Trim(sCampo)) to sObjeto
80242>>>>>>>            Get Get_List_Object_Array sObjeto to sArrayItens
80243>>>>>>>            Move (SizeOfArray(sArrayItens)) to iSizeArray
80244>>>>>>>            If (iSizeArray > 0) Begin
80246>>>>>>>                Get CreateNamed (RefClass(DescriptionValidationTable)) ("oVT"+sObjeto) to hVT
80247>>>>>>>                For iCont2 from 0 to (iSizeArray-1)
80253>>>>>>>>
80253>>>>>>>                    Send Add_Table_Value of hVT (Trim(sArrayItens[iCont2][0])) (Trim(sArrayItens[iCont2][1]))
80254>>>>>>>                Loop
80255>>>>>>>>
80255>>>>>>>                Send Fill_List of hVT
80256>>>>>>>                Set Field_Value_Table of hDD iFieldNumber to hVT
80257>>>>>>>            End
80257>>>>>>>>
80257>>>>>>>        Loop        
80258>>>>>>>>
80258>>>>>>>    End_Procedure
80259>>>>>>>    
80259>>>>>>>    Function VerifyValidationObjectInField Handle hDD Integer iField Returns Boolean
80262>>>>>>>        Integer iType
80262>>>>>>>        Get Field_Validation_Type of hDD iField to iType
80263>>>>>>>        If (iType = FA_VALIDATION_TYPE_TABLE) Function_Return True
80266>>>>>>>        Else Function_Return False
80268>>>>>>>    End_Function
80269>>>>>>>    
80269>>>>>>>    Function RetornaSinalFiltro Integer iConstFilter Returns String
80272>>>>>>>        If (iConstFilter = C_FILTERTYPE_EQ) Function_Return " = "
80275>>>>>>>        If (iConstFilter = C_FILTERTYPE_GE) Function_Return " >= "
80278>>>>>>>        If (iConstFilter = C_FILTERTYPE_LE) Function_Return " <= "
80281>>>>>>>        Function_Return " = "
80282>>>>>>>    End_Function
80283>>>>>>>    
80283>>>>>>>End_Object
80284>>>>>>>
80284>>>>>
80284>>>>>//#IFDEF iDDO#
80284>>>>>//#ELSE
80284>>>>>//    Integer iDDO# iDDField# 
80284>>>>>//#ENDIF
80284>>>>>//#IFDEF iVisible# 
80284>>>>>//#ELSE
80284>>>>>//    Integer iVisible# 
80284>>>>>//#ENDIF
80284>>>>>//#IFDEF iServer#
80284>>>>>//#ELSE
80284>>>>>//    Integer iServer#
80284>>>>>//#ENDIF
80284>>>>>
80284>>>>>// Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:50
80284>>>>>Class cDbForm_SI is a dbForm
80285>>>>>    
80285>>>>>    Procedure Construct_Object       
80287>>>>>        Integer iColor iCorSeq iCorSel
80287>>>>>        String sLabelAnt sPrefixo sSufixo sCorSeq sCorSel
80287>>>>>        Forward Send Construct_Object
80289>>>>>        
80289>>>>>        Get Color to iColor
80290>>>>>        Get Label to sLabelAnt
80291>>>>>        
80291>>>>>        Property Boolean pbSequenciaAuto False
80292>>>>>        
80292>>>>>        Property Integer piColorAnt iColor
80293>>>>>        
80293>>>>>        Property String psLabelAnt sLabelAnt
80294>>>>>        
80294>>>>>        Property String psPrefixo ""
80295>>>>>        
80295>>>>>        Property String psSufixo ""
80296>>>>>        
80296>>>>>        Property Integer piColorSeq     //10550453
80297>>>>>        
80297>>>>>        Property Integer piColorSel 
80298>>>>>        
80298>>>>>        Get Server_Param of (oBPCoreBase(Self)) "P_PREFIXO_LABEL_SEL"       to sPrefixo
80299>>>>>        Get Server_Param of (oBPCoreBase(Self)) "P_SUFIXO_LABEL_SEL"        to sSufixo
80300>>>>>        Get Server_Param of (oBPCoreBase(Self)) "P_COR_PADRAO_SEQ_AUTO"     to sCorSeq
80301>>>>>        Get Server_Param of (oBPCoreBase(Self)) "P_COR_PADRAO_CAMPO_SEL"    to sCorSel
80302>>>>>        
80302>>>>>        Move (Eval(sCorSeq)) to iCorSeq
80303>>>>>        Move (Eval(sCorSel)) to iCorSel
80304>>>>>    
80304>>>>>        Set psPrefixo   to sPrefixo
80305>>>>>        Set psSufixo    to sSufixo
80306>>>>>        Set piColorSeq  to iCorSeq
80307>>>>>        Set piColorSel  to iCorSel
80308>>>>>        
80308>>>>>        // Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:51
80308>>>>>        Property Integer Label_Col_Offset 0
80309>>>>>        // Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:51
80309>>>>>        Property Integer Label_Justification_Mode jMode_Top jMode_Top jMode_Left jMode_Right
80310>>>>>        Property Boolean Check_Visible False
80311>>>>>
80311>>>>>        //Set Form_Border item 0 to Border_Normal         
80311>>>>>        Set Form_Button 0 to Form_Button_Prompt
80312>>>>>        Set Form_Button_Bitmap 0 to "find.bmp"
80313>>>>>    End_Procedure // Construct_Object
80314>>>>>
80314>>>>>    Procedure End_Construct_Object
80316>>>>>        Boolean bSeqAuto
80316>>>>>        Integer iCorSeq
80316>>>>>        Forward Send End_Construct_Object   
80318>>>>>        
80318>>>>>        Get pbSequenciaAuto to bSeqAuto
80319>>>>>        
80319>>>>>        If (bSeqAuto) Begin 
80321>>>>>            Get piColorSeq to iCorSeq   //Pega a cor configurada no parametro para campos seq auto
80322>>>>>            Set Color to iCorSeq
80323>>>>>            Set piColorAnt to iCorSeq
80324>>>>>            Set FontWeight to FW_BOLD
80325>>>>>        End
80325>>>>>>
80325>>>>>
80325>>>>>    End_Procedure // Construct_Object
80326>>>>>    
80326>>>>>    Procedure Locate_Label
80328>>>>>        Forward Send Locate_Label
80330>>>>>        Integer iAtivo
80330>>>>>        String sLabel
80330>>>>>        Get enabled_state to iAtivo
80331>>>>>        Get Label to sLabel
80332>>>>>        If (iAtivo and Trim(sLabel)<>"") Set Transparent_state of (Label_Object(Self)) to True   // psdbform   
80335>>>>>    End_Procedure
80336>>>>>    
80336>>>>>    Procedure OnSetFocus
80338>>>>>        Integer iColorPad iCorSel
80338>>>>>        Boolean bSeqAuto
80338>>>>>        String sLabel sPrefixo sSufixo
80338>>>>>        
80338>>>>>        Forward Send OnSetFocus
80340>>>>>        
80340>>>>>        Get pbSequenciaAuto to bSeqAuto
80341>>>>>        
80341>>>>>        If (not(bSeqAuto)) Begin 
80343>>>>>            Get Color to iColorPad      //Pega cor padrao configurada para o componente
80344>>>>>            Set piColorAnt to iColorPad 
80345>>>>>            Get piColorSel to iCorSel   //Pega cor padrao configurada para componentes selecionados
80346>>>>>            Set Color to iCorSel
80347>>>>>        End
80347>>>>>>
80347>>>>>        
80347>>>>>        Get psPrefixo to sPrefixo
80348>>>>>        Get psSufixo  to sSufixo
80349>>>>>        
80349>>>>>        Get Label to sLabel
80350>>>>>        Set psLabelAnt to sLabel
80351>>>>>        Set Label to (Trim(sPrefixo)+Trim(sLabel)+Trim(sSufixo))
80352>>>>>        Set Label_FontWeight to FW_BOLD
80353>>>>>        
80353>>>>>    End_Procedure
80354>>>>>
80354>>>>>    Procedure OnKillFocus
80356>>>>>        Integer iColorPad
80356>>>>>        Boolean bSeqAuto
80356>>>>>        String sLabel
80356>>>>>        
80356>>>>>        Forward Send OnKillFocus
80358>>>>>        
80358>>>>>        Get pbSequenciaAuto to bSeqAuto
80359>>>>>        
80359>>>>>        If (not(bSeqAuto)) Begin 
80361>>>>>            Get piColorAnt to iColorPad 
80362>>>>>            Set Color to iColorPad
80363>>>>>        End
80363>>>>>>
80363>>>>>        
80363>>>>>        Get psLabelAnt to sLabel
80364>>>>>        Set Label to sLabel
80365>>>>>        
80365>>>>>        Set Label_FontWeight to FW_NORMAL
80366>>>>>    End_Procedure
80367>>>>>
80367>>>>>End_Class
80368>>>>>
80368>>>>>
80368>>>>>
80368>>>>>
80368>>>Use cDbCJGrid_SI.pkg
Including file: cDbCJGrid_SI.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\cDbCJGrid_SI.pkg)
80368>>>>>Use cDbCJGrid.pkg
80368>>>>>Use cCJGridColumn.pkg
80368>>>>>
80368>>>>>Class cDbCJGrid_SI is a cDbCJGrid
80369>>>>>    Procedure Construct_Object     
80371>>>>>        Forward Send Construct_Object
80373>>>>>
80373>>>>>        Property Boolean pbDisableChanged False
80374>>>>>        Property Boolean pbOriginalState True
80375>>>>>        Property Boolean pbIdleState False
80376>>>>>        Property Boolean pbActivated False
80377>>>>>        Property Boolean pbRefreshOnActivate False
80378>>>>>        Property String psRegKeySufix ""
80379>>>>>
80379>>>>>        On_Key Key_F7         Send NONE 
80380>>>>>        On_Key Key_F8         Send NONE 
80381>>>>>
80381>>>>>        // TODO: Verificar questoes de duplicidade
80381>>>>>        //String sLabel
80381>>>>>        //Get Object_Label to sLabel
80381>>>>>        //Set pbRestoreLayout to False
80381>>>>>        //Set psLayoutSection to sLabel
80381>>>>>        //Set piLayoutBuild to 6
80381>>>>>        //Set pbHeaderPrompts to True
80381>>>>>        Set pbHeaderReorders to True
80382>>>>>        Set pbHeaderTogglesDirection to True
80383>>>>>        Set pbAutoColumnSizing to False
80384>>>>>        Set pbFullColumnScrolling to True // Resolve problema de scroll
80385>>>>>        // Atributos para estilo antigo de edicao
80385>>>>>        Set pbAllowInsertRow to False
80386>>>>>        //Set pbEditOnKeyNavigation to True
80386>>>>>        //Set pbEditOnClick to True
80386>>>>>        Set peRequestFindMode to rfmFindMainSuper
80387>>>>>    End_Procedure
80388>>>>>
80388>>>>>    Procedure End_Construct_Object
80390>>>>>        Forward Send End_Construct_Object
80392>>>>>
80392>>>>>        If (pbSelectionEnable(Self)) Begin
80394>>>>>            // Compatibilidade com psdbGrid
80394>>>>>            Set piSelectedRowBackColor to 16448949
80395>>>>>            Set piSelectedRowForeColor to clBlack
80396>>>>>            Set piFocusCellBackColor to clAqua
80397>>>>>            Set piFocusCellForeColor to clBlack
80398>>>>>            Set piHighlightBackColor to 16448949
80399>>>>>            Set piHighlightForeColor to clBlack
80400>>>>>        End
80400>>>>>>
80400>>>>>    End_Procedure // Construct_Object
80401>>>>>    
80401>>>>>    Procedure OnCreateGridControl
80403>>>>>        Forward Send OnCreateGridControl                
80405>>>>>    
80405>>>>>    End_Procedure
80406>>>>>
80406>>>>>    Procedure Activating
80408>>>>>        Forward Send Activating
80410>>>>>        
80410>>>>>        Set pbActivated to True
80411>>>>>
80411>>>>>        If ((pbRefreshOnActivate(Self))) Begin
80413>>>>>            Send MovetoFirstRow
80414>>>>>            Set pbRefreshOnActivate to False
80415>>>>>        End        
80415>>>>>>
80415>>>>>    End_Procedure
80416>>>>>
80416>>>>>    Procedure Deactivating
80418>>>>>        Forward Send Deactivating
80420>>>>>
80420>>>>>        Set pbActivated to False
80421>>>>>    End_Procedure
80422>>>>>
80422>>>>>    // Necess rio para gravar estado anterior
80422>>>>>    Procedure Set pbAllowEdit Boolean bValue
80424>>>>>        If (not(pbIdleState(Self))) Set pbOriginalState to bValue
80427>>>>>        Move (bValue and pbOriginalState(Self)) to bValue
80428>>>>>
80428>>>>>        Set private_pbAllowEdit to bValue
80429>>>>>        If (IsComObjectCreated(Self)) Begin
80431>>>>>            Set ComAllowEdit to bValue
80432>>>>>        End
80432>>>>>>
80432>>>>>    End_Procedure
80433>>>>>
80433>>>>>    // Verifica‡Æo para desativar grid caso header seja modificado
80433>>>>>    Procedure OnIdle
80435>>>>>        Forward Send OnIdle
80437>>>>>        
80437>>>>>        Handle hoSrvr
80437>>>>>        Boolean bChanged bRec
80437>>>>>
80437>>>>>        If (pbDisableChanged(Self)) Begin
80439>>>>>            Delegate Get Server to hoSrvr // O DDO do Header.
80441>>>>>            Get Should_Save of hoSrvr to bChanged // Header foi modificado?
80442>>>>>            Get HasRecord of hoSrvr to bRec // Existe registro posicionado?
80443>>>>>            
80443>>>>>            Set pbIdleState to True
80444>>>>>            Set pbAllowEdit to (not(bChanged) and bRec)
80445>>>>>            Set pbIdleState to False
80446>>>>>        End
80446>>>>>>
80446>>>>>    End_Procedure
80447>>>>>
80447>>>>>    // Ativar o OnPostEntering somente em determiandas circunstƒncias
80447>>>>>    Procedure OnEntering
80449>>>>>        Handle hoSrvr
80449>>>>>        Boolean bChanged
80449>>>>>        Integer iRecord
80449>>>>>        Delegate Get Server to hoSrvr // O DDO do Header.
80451>>>>>        Get Should_Save of hoSrvr to bChanged // Header foi modificado?
80452>>>>>        Get Current_Record of hoSrvr to iRecord // Existe registro posicionado?
80453>>>>>        If (bChanged or (iRecord = 0)) Begin
80455>>>>>            Set pbNeedPostEntering to True
80456>>>>>        End
80456>>>>>>
80456>>>>>    End_Procedure
80457>>>>>    
80457>>>>>    // Entrada para customiza‡Æo das colunas por grid e nÆo por coluna (Usar classe psdbCJGridColumnCustom nas colunas)
80457>>>>>    Procedure OnSetColumnMetrics Handle hoGridItemMetrics Integer iRow String ByRef sValue
80459>>>>>    End_Procedure
80460>>>>>
80460>>>>>    Procedure MovetoFirstRow
80462>>>>>        If ((pbActivated(Self))) Forward Send MovetoFirstRow
80466>>>>>        Else Set pbRefreshOnActivate to True
80468>>>>>    End_Procedure
80469>>>>>
80469>>>>>    Procedure MovetoLastRow
80471>>>>>        If ((pbActivated(Self))) Forward Send MovetoLastRow
80475>>>>>        Else Set pbRefreshOnActivate to True
80477>>>>>    End_Procedure
80478>>>>>    
80478>>>>>    //JCO - Captura o evento Exit das colunas
80478>>>>>    Procedure OnColumnExit Handle hoColumn Integer iRow
80480>>>>>    End_Procedure
80481>>>>>    
80481>>>>>    Function OnPostEntering Returns Boolean
80483>>>>>        Boolean bRetVal
80483>>>>>        Integer rval
80483>>>>>        Forward Get OnPostEntering to bRetVal
80485>>>>>        
80485>>>>>        Get Salva_Header_Geral of (oBPCoreBase(Self)) (main_dd(Self))  to rval
80486>>>>>        If (rval = 0) Get Should_Save of (main_dd(Self)) to bRetVal
80489>>>>>        Else Move rval to bRetVal
80491>>>>>        Function_Return bRetVal
80492>>>>>    End_Function
80493>>>>>    
80493>>>>>End_Class
80494>>>Use cDbCJGridColumn_SI.pkg
Including file: cDbCJGridColumn_SI.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\cDbCJGridColumn_SI.pkg)
80494>>>>>Use cDbCJGridColumn.pkg
80494>>>>>Use BPCoreBase.bp
80494>>>>>
80494>>>>>Class cDbCJGridColumn_SI is a cDbCJGridColumn
80495>>>>>    
80495>>>>>    Procedure Construct_Object
80497>>>>>        Forward Send Construct_Object
80499>>>>>        
80499>>>>>        Property Boolean pbForceFillList False
80500>>>>>
80500>>>>>    End_Procedure
80501>>>>>
80501>>>>>    Procedure End_Construct_Object
80503>>>>>        Forward Send End_Construct_Object
80505>>>>>
80505>>>>>    End_Procedure
80506>>>>>    
80506>>>>>    Procedure OnSetDisplayMetrics Handle hoGridItemMetrics Integer iRow String  ByRef sValue
80508>>>>>        String sFileField sResult
80508>>>>>        Integer iDDO iDDField
80508>>>>>        Boolean bCombo bForceFillList bLoadByVT
80508>>>>>        Handle hoSrvr
80508>>>>>        Forward Send OnSetDisplayMetrics hoGridItemMetrics iRow (&sValue)
80510>>>>>        
80510>>>>>        Get pbComboButton to bCombo
80511>>>>>        Get pbForceFillList  to bForceFillList
80512>>>>>        
80512>>>>>        Get piBindingTable to iDDO
80513>>>>>        Get piBindingColumn to iDDField
80514>>>>>        Get Server to hoSrvr
80515>>>>>        
80515>>>>>        If (not(bForceFillList)) Get VerifyValidationObjectInField of oBPCoreBase hoSrvr iDDField to bLoadByVT
80518>>>>>        Else Move False to bLoadByVT
80520>>>>>        
80520>>>>>        If (bCombo and (not(bLoadByVT))) Begin
80522>>>>>
80522>>>>>            Get Get_Names of (oBPCoreBase(Self)) iDDO iDDField C_GETNAME_BOTH to sFileField
80523>>>>>            
80523>>>>>            Get Get_Description_Items of (oBPCoreBase(Self)) sFileField sValue ;                 C_FINDTYPE_DESCRIPTIONITENS_SEQ C_RETURNTYPE_DESCRIPTIONITENS_LABEL to sResult
80524>>>>>            Move sResult to sValue
80525>>>>>        End
80525>>>>>>
80525>>>>>        
80525>>>>>    End_Procedure
80526>>>>>
80526>>>>>    Procedure ComboFillList
80528>>>>>        Integer iFile iField eDisplayMode iCountArray iLoop
80528>>>>>        Handle  hoSrvr hoTable
80528>>>>>        Boolean bEntry bAllowBlank bForceFillList bLoadByVT
80528>>>>>        String[][2] sArrayList
80529>>>>>        String sFileField
80529>>>>>        tComboItemData[] AComboData
80529>>>>>        tComboItemData[] AComboData
80530>>>>>        
80530>>>>>        Get pbForceFillList  to bForceFillList
80531>>>>>        If (not(bForceFillList)) Forward Send ComboFillList
80535>>>>>
80535>>>>>        Get Server to hoSrvr
80536>>>>>        Get piBindingTable  to iFile
80537>>>>>        Get piBindingColumn to iField
80538>>>>>        If (hoSrvr and iFile) Begin
80540>>>>>            If (not(bForceFillList)) Get VerifyValidationObjectInField of oBPCoreBase hoSrvr iField to bLoadByVT
80543>>>>>            Else Move False to bLoadByVT
80545>>>>>            
80545>>>>>            If (not(bLoadByVT)) Begin
80547>>>>>            
80547>>>>>                Get Get_Names of (oBPCoreBase(Self)) iFile iField C_GETNAME_BOTH to sFileField
80548>>>>>                
80548>>>>>                Get Get_List_Object_Array of (oBPCoreBase(Self)) (Trim(sFileField)) to sArrayList
80549>>>>>            
80549>>>>>                Move (SizeOfArray(sArrayList)) to iCountArray
80550>>>>>                For iLoop from 0 to (iCountArray-1)
80556>>>>>>
80556>>>>>                    Move (Trim(sArrayList[iLoop][1])) to AComboData[iLoop].sCaption 
80557>>>>>                    Move (Trim(sArrayList[iLoop][0])) to AComboData[iLoop].iData
80558>>>>>                Loop    
80559>>>>>>
80559>>>>>                Set pComboItemData to AComboData
80560>>>>>            End
80560>>>>>>
80560>>>>>        End
80560>>>>>>
80560>>>>>    End_Procedure
80561>>>>>    
80561>>>>>    
80561>>>>>//    Procedure OnExit
80561>>>>>//        Forward Send OnExit
80561>>>>>//        Integer iRow
80561>>>>>//        Handle hoDataSource
80561>>>>>//
80561>>>>>//        Get phoDataSource of (Parent(Self)) to hoDataSource
80561>>>>>//        Get SelectedRow of hoDataSource     to iRow
80561>>>>>//        Send OnColumnExit of (Parent(Self)) Self iRow
80561>>>>>//    End_Procedure
80561>>>>>
80561>>>>>End_Class
80562>>>
80562>>>Use GOBJETOH.dd
80562>>>Use GOBJETOI.dd
80562>>>
80562>>>ACTIVATE_VIEW Activate_oVWCADOBJETOS FOR oVWCADOBJETOS
80572>>>>
80572>>>Object oVWCADOBJETOS is a dbView
80574>>>    Set Location to 5 5
80575>>>    Set Size to 244 441
80576>>>    Set Label To "Cadastro de Objetos"
80577>>>    Set Border_Style to Border_Thick
80578>>>
80578>>>
80578>>>    Object oGOBJETOH_DD is a GOBJETOHDataDictionary
80580>>>        // this lets you save a new parent DD from within child DD
80580>>>        Set Allow_Foreign_New_Save_State to True
80581>>>    End_Object 
80582>>>
80582>>>    Object oGOBJETOI_DD is a GOBJETOIDataDictionary
80584>>>        Set DDO_Server To oGOBJETOH_DD
80585>>>        Set Constrain_File To GOBJETOH.File_Number
80586>>>    End_Object 
80587>>>
80587>>>    Set Main_DD To oGOBJETOH_DD
80588>>>    Set Server  To oGOBJETOH_DD
80589>>>
80589>>>
80589>>>
80589>>>    Object oGOBJETOHOBJETO is a cDbForm_SI
80591>>>        Entry_Item GOBJETOH.OBJETO
80592>>>        Set Size to 13 395
80593>>>        Set Location to 5 41
80594>>>        Set peAnchors to anLeftRight
80595>>>        Set Label to "Objeto"
80596>>>        Set Label_Justification_mode to jMode_Left
80597>>>        Set Label_Col_Offset to 36
80598>>>        Set Label_row_Offset to 0
80599>>>    End_Object 
80600>>>
80600>>>    Object oGOBJETOHLABEL_LONG is a cDbForm_SI
80602>>>        Entry_Item GOBJETOH.LABEL_LONG
80603>>>        Set Size to 13 395
80604>>>        Set Location to 20 41
80605>>>        Set peAnchors to anLeftRight
80606>>>        Set Label to "Label Long"
80607>>>        Set Label_Justification_mode to jMode_Left
80608>>>        Set Label_Col_Offset to 36
80609>>>        Set Label_row_Offset to 0
80610>>>    End_Object 
80611>>>
80611>>>    Object oGOBJETOHLABEL_SHORT is a cDbForm_SI
80613>>>        Entry_Item GOBJETOH.LABEL_SHORT
80614>>>        Set Size to 13 271
80615>>>        Set Location to 35 41
80616>>>        Set peAnchors to anLeftRight
80617>>>        Set Label to "Label Short"
80618>>>        Set Label_Justification_mode to jMode_Left
80619>>>        Set Label_Col_Offset to 36
80620>>>        Set Label_row_Offset to 0
80621>>>    End_Object 
80622>>>
80622>>>    Object oGOBJETOHSTATUS_HELP is a cDbForm_SI
80624>>>        Entry_Item GOBJETOH.STATUS_HELP
80625>>>        Set Size to 13 395
80626>>>        Set Location to 50 41
80627>>>        Set peAnchors to anLeftRight
80628>>>        Set Label to "Status Help"
80629>>>        Set Label_Justification_mode to jMode_Left
80630>>>        Set Label_Col_Offset to 36
80631>>>        Set Label_row_Offset to 0
80632>>>    End_Object 
80633>>>
80633>>>    Object oDetailGrid is a cDbCJGrid_SI
80635>>>        Set Size to 166 430
80636>>>        Set Location to 73 5
80637>>>        Set Server to oGOBJETOI_DD
80638>>>        Set Ordering to 1
80639>>>        Set peAnchors to anAll
80640>>>        Set psLayoutSection to "oCADOBJETOS_oDetailGrid"
80641>>>        Set pbAllowInsertRow to False
80642>>>        Set pbHeaderPrompts to True
80643>>>
80643>>>        Object oGOBJETOI_SEQ is a cDbCJGridColumn_SI
80645>>>            Entry_Item GOBJETOI.SEQ
80646>>>            Set piWidth to 115
80647>>>            Set psCaption to "SEQ"
80648>>>        End_Object 
80649>>>
80649>>>        Object oGOBJETOI_LABEL is a cDbCJGridColumn_SI
80651>>>            Entry_Item GOBJETOI.LABEL
80652>>>            Set piWidth to 637
80653>>>            Set psCaption to "LABEL"
80654>>>        End_Object 
80655>>>
80655>>>    End_Object 
80656>>>
80656>>>    //-----------------------------------------------------------------------
80656>>>    // Create custom confirmation messages for save and delete
80656>>>    // We must create the new functions and assign verify messages
80656>>>    // to them.
80656>>>    //-----------------------------------------------------------------------
80656>>>
80656>>>    Function ConfirmDeleteHeader Returns Boolean
80659>>>        Boolean bFail
80659>>>        Get Confirm "Delete Entire Header and all detail?" to bFail
80660>>>        Function_Return bFail
80661>>>    End_Function 
80662>>>
80662>>>    // Only confirm on the saving of new records
80662>>>    Function ConfirmSaveHeader Returns Boolean
80665>>>        Boolean bNoSave bHasRecord
80665>>>        Handle  hoSrvr
80665>>>        Get Server to hoSrvr
80666>>>        Get HasRecord of hoSrvr to bHasRecord
80667>>>        If not bHasRecord Begin
80669>>>            Get Confirm "Save this NEW header?" to bNoSave
80670>>>        End
80670>>>>
80670>>>        Function_Return bNoSave
80671>>>    End_Function 
80672>>>
80672>>>    // Define alternate confirmation Messages
80672>>>    Set Verify_Save_MSG       to (RefFunc(ConfirmSaveHeader))
80673>>>    Set Verify_Delete_MSG     to (RefFunc(ConfirmDeleteHeader))
80674>>>    // Saves in header should not clear the view
80674>>>    Set Auto_Clear_Deo_State to False
80675>>>
80675>>>
80675>>>End_Object 
80676>        Use VWEMPRESA.vw
Including file: VWEMPRESA.vw    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\VWEMPRESA.vw)
80676>>>// Cadastro da empresa
80676>>>//
80676>>>
80676>>>Use DFClient.pkg
80676>>>Use DFEntry.pkg
80676>>>
80676>>>Use GEMPRESA.dd
Including file: GEMPRESA.dd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GEMPRESA.dd)
80676>>>>>Use DataDict.pkg
80676>>>>>
80676>>>>>Open GEMPRESA
Including file: GEMPRESA.fd    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\DDSrc\GEMPRESA.fd)
80678>>>>>
80678>>>>>Class GEMPRESADataDictionary is a DataDictionary
80679>>>>>    
80679>>>>>    Procedure Construct_Object
80681>>>>>        Forward Send Construct_Object
80683>>>>>        Set Main_File to GEMPRESA.File_Number
80684>>>>>
80684>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_NOPUT to True
80685>>>>>        Set Foreign_Field_Option DD_KEYFIELD DD_FINDREQ to True
80686>>>>>        Set Foreign_Field_Option DD_INDEXFIELD DD_NOPUT to True
80687>>>>>        Set Foreign_Field_Option DD_DEFAULT DD_DISPLAYONLY to True
80688>>>>>
80688>>>>>        Set Field_Option Field GEMPRESA.CNPJ_CPF DD_AUTOFIND to True
80689>>>>>        Set Field_Label_Long Field GEMPRESA.CNPJ_CPF to "CNPJ/CPF"
80690>>>>>        Set Field_Label_Short Field GEMPRESA.CNPJ_CPF to "CNPJ/CPF"
80691>>>>>
80691>>>>>        Set Field_Label_Long Field GEMPRESA.TIPO to "Tipo"
80692>>>>>        Set Field_Label_Short Field GEMPRESA.TIPO to "Tipo"
80693>>>>>
80693>>>>>        Set Field_Label_Long Field GEMPRESA.RAZAO_SOCIAL to "RazÆo Social"
80694>>>>>        Set Field_Label_Short Field GEMPRESA.RAZAO_SOCIAL to "RazÆo Social"
80695>>>>>        Set Field_Option Field GEMPRESA.RAZAO_SOCIAL DD_CAPSLOCK to True
80696>>>>>
80696>>>>>        Set Field_Label_Long Field GEMPRESA.NOME_FANTASIA to "Nome Fantasia"
80697>>>>>        Set Field_Label_Short Field GEMPRESA.NOME_FANTASIA to "Nome Fantasia"
80698>>>>>        Set Field_Option Field GEMPRESA.NOME_FANTASIA DD_CAPSLOCK to True
80699>>>>>
80699>>>>>        Set Field_Label_Long Field GEMPRESA.LOGO_MARCA to "Logo Marca"
80700>>>>>        Set Field_Label_Short Field GEMPRESA.LOGO_MARCA to "Logo Marca"
80701>>>>>
80701>>>>>    End_Procedure
80702>>>>>
80702>>>>>End_Class
80703>>>Use dbBitmap.pkg
80703>>>Use cDbForm_SI.pkg
80703>>>Use cDbComboForm_SI.pkg
Including file: cDbComboForm_SI.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\cDbComboForm_SI.pkg)
80703>>>>>Use Dfcentry.pkg
80703>>>>>Use BPCoreBase.bp
80703>>>>>
80703>>>>>
80703>>>>>Class cDbComboForm_SI is a dbComboForm      
80704>>>>>    Procedure Construct_Object        
80706>>>>>        Integer iColor iCorSeq iCorSel
80706>>>>>        String sLabelAnt sPrefixo sSufixo sCorSeq sCorSel
80706>>>>>        Forward Send Construct_Object
80708>>>>>        
80708>>>>>        Get Color to iColor
80709>>>>>        Get Label to sLabelAnt
80710>>>>>        
80710>>>>>        Property Integer piColorAnt iColor
80711>>>>>        
80711>>>>>        Property String psLabelAnt sLabelAnt
80712>>>>>        
80712>>>>>        Property String psPrefixo ""
80713>>>>>        
80713>>>>>        Property String psSufixo ""
80714>>>>>        
80714>>>>>        Property Integer piColorSeq 
80715>>>>>        
80715>>>>>        Property Integer piColorSel 
80716>>>>>        
80716>>>>>        Property Boolean pbForceFillList False
80717>>>>>        
80717>>>>>        Get Server_Param of oBPCoreBase "P_PREFIXO_LABEL_SEL"       to sPrefixo
80718>>>>>        Get Server_Param of oBPCoreBase "P_SUFIXO_LABEL_SEL"        to sSufixo
80719>>>>>        Get Server_Param of oBPCoreBase "P_COR_PADRAO_SEQ_AUTO"     to sCorSeq
80720>>>>>        Get Server_Param of oBPCoreBase "P_COR_PADRAO_CAMPO_SEL"    to sCorSel
80721>>>>>        
80721>>>>>        Move (Eval(sCorSeq)) to iCorSeq
80722>>>>>        Move (Eval(sCorSel)) to iCorSel
80723>>>>>    
80723>>>>>        Set psPrefixo   to sPrefixo
80724>>>>>        Set psSufixo    to sSufixo
80725>>>>>        Set piColorSeq  to iCorSeq
80726>>>>>        Set piColorSel  to iCorSel
80727>>>>>
80727>>>>>        // Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:51
80727>>>>>        Property Integer Label_Col_Offset 0
80728>>>>>        // Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:51
80728>>>>>        Property Integer Label_Justification_Mode jMode_Top jMode_Top jMode_Left jMode_Right
80729>>>>>        // Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:51
80729>>>>>        Property Integer Code_display_Mode cb_code_display_both cb_code_display_both cb_code_display_description cb_code_display_code 
80730>>>>>        // Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:51
80730>>>>>        Property Integer Undefined_display_Mode cb_err_update_blank_value cb_err_update_blank_value cb_err_update_none cb_err_update_window_value    
80731>>>>>        Property String psNameObject ""
80732>>>>>        Property Boolean Check_Visible False
80733>>>>>
80733>>>>>        ////Set Form_Border Item 0 to Border_Normal
80733>>>>>        Set ListRowCount    to    10 // how many drop-down rows are required (0 = use size to determine number of rows)
80734>>>>>        Set ListWidth       to    10 // width of dropped-down list (0=default width of edit)    
80735>>>>>        Set Entry_State to False
80736>>>>>
80736>>>>>    End_Procedure // Construct_Object
80737>>>>>
80737>>>>>    Procedure End_Construct_Object
80739>>>>>        Forward Send End_Construct_Object   
80741>>>>>
80741>>>>>    End_Procedure
80742>>>>>//    
80742>>>>>//    Procedure onSetFocus
80742>>>>>//        Set Color     to 10550453//15784895
80742>>>>>//        Set TextColor to clWindowText
80742>>>>>//    End_Procedure
80742>>>>>//
80742>>>>>//    Procedure onKillFocus
80742>>>>>//        Set Color     to clWindow
80742>>>>>//        Set TextColor to clWindowText
80742>>>>>//    End_Procedure   
80742>>>>>    
80742>>>>>    Procedure OnSetFocus
80744>>>>>        Integer iColorPad iCorSel
80744>>>>>        String sLabel sPrefixo sSufixo
80744>>>>>        
80744>>>>>        Forward Send OnSetFocus
80746>>>>>        
80746>>>>>        
80746>>>>>        Get Color to iColorPad      //Pega cor padrao configurada para o componente
80747>>>>>        Set piColorAnt to iColorPad 
80748>>>>>        Get piColorSel to iCorSel   //Pega cor padrao configurada para componentes selecionados
80749>>>>>        Set Color to iCorSel
80750>>>>>        
80750>>>>>        Get psPrefixo to sPrefixo
80751>>>>>        Get psSufixo  to sSufixo
80752>>>>>        
80752>>>>>        Get Label to sLabel
80753>>>>>        Set psLabelAnt to sLabel
80754>>>>>        Set Label to (Trim(sPrefixo)+Trim(sLabel)+Trim(sSufixo))
80755>>>>>        Set Label_FontWeight to FW_BOLD
80756>>>>>        
80756>>>>>        Set TextColor to clWindowText
80757>>>>>        
80757>>>>>    End_Procedure
80758>>>>>
80758>>>>>    Procedure OnKillFocus
80760>>>>>        Integer iColorPad
80760>>>>>        String sLabel
80760>>>>>        
80760>>>>>        Forward Send OnKillFocus
80762>>>>>
80762>>>>>        Get piColorAnt to iColorPad 
80763>>>>>        Set Color to iColorPad
80764>>>>>        
80764>>>>>        Get psLabelAnt to sLabel
80765>>>>>        Set Label to sLabel
80766>>>>>        
80766>>>>>        Set Label_FontWeight to FW_NORMAL
80767>>>>>        
80767>>>>>        Set TextColor to clWindowText
80768>>>>>    End_Procedure
80769>>>>>    
80769>>>>>    Procedure Combo_Fill_List
80771>>>>>        String sFileField sValues sStatusHelp
80771>>>>>        String[][2] sArrayList
80772>>>>>        Integer iDDO iDDField iLoop iCountArray
80772>>>>>        Boolean bLoadByVT bForceFillList
80772>>>>>        Handle hDD
80772>>>>>        
80772>>>>>        Get pbForceFillList  to bForceFillList
80773>>>>>        If (not(bForceFillList)) Forward Send Combo_Fill_List
80777>>>>>    
80777>>>>>        Get Data_File  item 0 to iDDO
80778>>>>>        Get Data_Field item 0 to iDDField
80779>>>>>        Get Server to hDD
80780>>>>>        
80780>>>>>        If (not(bForceFillList)) Get VerifyValidationObjectInField of oBPCoreBase hDD iDDField to bLoadByVT
80783>>>>>        Else Move False to bLoadByVT
80785>>>>>        If (not(bLoadByVT)) Begin
80787>>>>>        
80787>>>>>            Send Combo_Delete_Data
80788>>>>>        
80788>>>>>            Get Get_Names of (oBPCoreBase(Self)) iDDO iDDField C_GETNAME_BOTH to sFileField
80789>>>>>    
80789>>>>>            If (Trim(sFileField) <> "") Set psNameObject to sFileField
80792>>>>>            Set Entry_State to False
80793>>>>>            Get Get_Description of (oBPCoreBase(Self)) sFileField C_GETDESC_LABEL_LONG to sValues
80794>>>>>            If (Trim(sValues) <> "") Set Label to (Trim(sValues))
80797>>>>>            Get Get_Description of (oBPCoreBase(Self)) sFileField C_GETDESC_STATUS_HELP to sStatusHelp
80798>>>>>            If (Trim(sStatusHelp) <> "") Set Status_Help to sStatusHelp
80801>>>>>            
80801>>>>>            Get Get_List_Object_Array of (oBPCoreBase(Self)) (Trim(sFileField)) to sArrayList
80802>>>>>            
80802>>>>>            Move (SizeOfArray(sArrayList)) to iCountArray
80803>>>>>            For iLoop from 0 to (iCountArray-1)
80809>>>>>>
80809>>>>>                Send Combo_Add_Item (Trim(sArrayList[iLoop][1])) (Trim(sArrayList[iLoop][0]))
80810>>>>>            Loop
80811>>>>>>
80811>>>>>        End
80811>>>>>>
80811>>>>>    End_Procedure
80812>>>>>  
80812>>>>>End_Class // 
80813>>>>>
80813>>>>>
80813>>>>>
80813>>>>>
80813>>>Use cComWebBrowser.pkg
Including file: cComWebBrowser.pkg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\cComWebBrowser.pkg)
80813>>>>>// Visual DataFlex COM proxy classes generated from C:\WINDOWS\system32\shdocvw.dll
80813>>>>>Use FlexCom20.pkg
80813>>>>>
80813>>>>>
80813>>>>>// Constants for WebBrowser CommandStateChange
80813>>>>>Define OLECommandStateChangeConstants for Integer
80813>>>>>    // Command Change
80813>>>>>    Define OLECSC_UPDATECOMMANDS for -1
80813>>>>>    // Navigate Forward
80813>>>>>    Define OLECSC_NAVIGATEFORWARD for 1
80813>>>>>    // Navigate Back
80813>>>>>    Define OLECSC_NAVIGATEBACK for 2
80813>>>>>
80813>>>>>Define OLEOLECMDID for Integer
80813>>>>>    Define OLEOLECMDID_OPEN for 1
80813>>>>>    Define OLEOLECMDID_NEW for 2
80813>>>>>    Define OLEOLECMDID_SAVE for 3
80813>>>>>    Define OLEOLECMDID_SAVEAS for 4
80813>>>>>    Define OLEOLECMDID_SAVECOPYAS for 5
80813>>>>>    Define OLEOLECMDID_PRINT for 6
80813>>>>>    Define OLEOLECMDID_PRINTPREVIEW for 7
80813>>>>>    Define OLEOLECMDID_PAGESETUP for 8
80813>>>>>    Define OLEOLECMDID_SPELL for 9
80813>>>>>    Define OLEOLECMDID_PROPERTIES for 10
80813>>>>>    Define OLEOLECMDID_CUT for 11
80813>>>>>    Define OLEOLECMDID_COPY for 12
80813>>>>>    Define OLEOLECMDID_PASTE for 13
80813>>>>>    Define OLEOLECMDID_PASTESPECIAL for 14
80813>>>>>    Define OLEOLECMDID_UNDO for 15
80813>>>>>    Define OLEOLECMDID_REDO for 16
80813>>>>>    Define OLEOLECMDID_SELECTALL for 17
80813>>>>>    Define OLEOLECMDID_CLEARSELECTION for 18
80813>>>>>    Define OLEOLECMDID_ZOOM for 19
80813>>>>>    Define OLEOLECMDID_GETZOOMRANGE for 20
80813>>>>>    Define OLEOLECMDID_UPDATECOMMANDS for 21
80813>>>>>    Define OLEOLECMDID_REFRESH for 22
80813>>>>>    Define OLEOLECMDID_STOP for 23
80813>>>>>    Define OLEOLECMDID_HIDETOOLBARS for 24
80813>>>>>    Define OLEOLECMDID_SETPROGRESSMAX for 25
80813>>>>>    Define OLEOLECMDID_SETPROGRESSPOS for 26
80813>>>>>    Define OLEOLECMDID_SETPROGRESSTEXT for 27
80813>>>>>    Define OLEOLECMDID_SETTITLE for 28
80813>>>>>    Define OLEOLECMDID_SETDOWNLOADSTATE for 29
80813>>>>>    Define OLEOLECMDID_STOPDOWNLOAD for 30
80813>>>>>    Define OLEOLECMDID_ONTOOLBARACTIVATED for 31
80813>>>>>    Define OLEOLECMDID_FIND for 32
80813>>>>>    Define OLEOLECMDID_DELETE for 33
80813>>>>>    Define OLEOLECMDID_HTTPEQUIV for 34
80813>>>>>    Define OLEOLECMDID_HTTPEQUIV_DONE for 35
80813>>>>>    Define OLEOLECMDID_ENABLE_INTERACTION for 36
80813>>>>>    Define OLEOLECMDID_ONUNLOAD for 37
80813>>>>>    Define OLEOLECMDID_PROPERTYBAG2 for 38
80813>>>>>    Define OLEOLECMDID_PREREFRESH for 39
80813>>>>>    Define OLEOLECMDID_SHOWSCRIPTERROR for 40
80813>>>>>    Define OLEOLECMDID_SHOWMESSAGE for 41
80813>>>>>    Define OLEOLECMDID_SHOWFIND for 42
80813>>>>>    Define OLEOLECMDID_SHOWPAGESETUP for 43
80813>>>>>    Define OLEOLECMDID_SHOWPRINT for 44
80813>>>>>    Define OLEOLECMDID_CLOSE for 45
80813>>>>>    Define OLEOLECMDID_ALLOWUILESSSAVEAS for 46
80813>>>>>    Define OLEOLECMDID_DONTDOWNLOADCSS for 47
80813>>>>>    Define OLEOLECMDID_UPDATEPAGESTATUS for 48
80813>>>>>    Define OLEOLECMDID_PRINT2 for 49
80813>>>>>    Define OLEOLECMDID_PRINTPREVIEW2 for 50
80813>>>>>    Define OLEOLECMDID_SETPRINTTEMPLATE for 51
80813>>>>>    Define OLEOLECMDID_GETPRINTTEMPLATE for 52
80813>>>>>    Define OLEOLECMDID_PAGEACTIONBLOCKED for 55
80813>>>>>    Define OLEOLECMDID_PAGEACTIONUIQUERY for 56
80813>>>>>    Define OLEOLECMDID_FOCUSVIEWCONTROLS for 57
80813>>>>>    Define OLEOLECMDID_FOCUSVIEWCONTROLSQUERY for 58
80813>>>>>    Define OLEOLECMDID_SHOWPAGEACTIONMENU for 59
80813>>>>>
80813>>>>>Define OLEOLECMDF for Integer
80813>>>>>    Define OLEOLECMDF_SUPPORTED for 1
80813>>>>>    Define OLEOLECMDF_ENABLED for 2
80813>>>>>    Define OLEOLECMDF_LATCHED for 4
80813>>>>>    Define OLEOLECMDF_NINCHED for 8
80813>>>>>    Define OLEOLECMDF_INVISIBLE for 16
80813>>>>>    Define OLEOLECMDF_DEFHIDEONCTXTMENU for 32
80813>>>>>
80813>>>>>Define OLEOLECMDEXECOPT for Integer
80813>>>>>    Define OLEOLECMDEXECOPT_DODEFAULT for 0
80813>>>>>    Define OLEOLECMDEXECOPT_PROMPTUSER for 1
80813>>>>>    Define OLEOLECMDEXECOPT_DONTPROMPTUSER for 2
80813>>>>>    Define OLEOLECMDEXECOPT_SHOWHELP for 3
80813>>>>>
80813>>>>>Define OLEtagREADYSTATE for Integer
80813>>>>>    Define OLEREADYSTATE_UNINITIALIZED for 0
80813>>>>>    Define OLEREADYSTATE_LOADING for 1
80813>>>>>    Define OLEREADYSTATE_LOADED for 2
80813>>>>>    Define OLEREADYSTATE_INTERACTIVE for 3
80813>>>>>    Define OLEREADYSTATE_COMPLETE for 4
80813>>>>>
80813>>>>>// Constants for WebBrowser security icon notification
80813>>>>>Define OLESecureLockIconConstants for Integer
80813>>>>>    Define OLEsecureLockIconUnsecure for 0
80813>>>>>    Define OLEsecureLockIconMixed for 1
80813>>>>>    Define OLEsecureLockIconSecureUnknownBits for 2
80813>>>>>    Define OLEsecureLockIconSecure40Bit for 3
80813>>>>>    Define OLEsecureLockIconSecure56Bit for 4
80813>>>>>    Define OLEsecureLockIconSecureFortezza for 5
80813>>>>>    Define OLEsecureLockIconSecure128Bit for 6
80813>>>>>
80813>>>>>// Constants for ShellWindows registration
80813>>>>>Define OLEShellWindowTypeConstants for Integer
80813>>>>>    // Explorer
80813>>>>>    Define OLESWC_EXPLORER for 0
80813>>>>>    // Various Browsing Windows
80813>>>>>    Define OLESWC_BROWSER for 1
80813>>>>>    // 3rd Party Browsers
80813>>>>>    Define OLESWC_3RDPARTY for 2
80813>>>>>    // Creation Callback
80813>>>>>    Define OLESWC_CALLBACK for 4
80813>>>>>
80813>>>>>// Options for ShellWindows FindWindow
80813>>>>>Define OLEShellWindowFindWindowOptions for Integer
80813>>>>>
80813>>>>>// CLSID: {D30C1661-CDAF-11D0-8A3E-00C04FC9E26E}
80813>>>>>// Web Browser Interface for IE4.
80813>>>>>Class cComIWebBrowser2 is a Mixin
80814>>>>>
80814>>>>>    // Navigates to the previous item in the history list.
80814>>>>>    Procedure ComGoBack
80816>>>>>        Handle hDispatchDriver
80816>>>>>        Get phDispatchDriver to hDispatchDriver
80817>>>>>        Send InvokeComMethod to hDispatchDriver 100 OLE_VT_VOID
80818>>>>>    End_Procedure
80819>>>>>
80819>>>>>    // Navigates to the next item in the history list.
80819>>>>>    Procedure ComGoForward
80821>>>>>        Handle hDispatchDriver
80821>>>>>        Get phDispatchDriver to hDispatchDriver
80822>>>>>        Send InvokeComMethod to hDispatchDriver 101 OLE_VT_VOID
80823>>>>>    End_Procedure
80824>>>>>
80824>>>>>    // Go home/start page.
80824>>>>>    Procedure ComGoHome
80826>>>>>        Handle hDispatchDriver
80826>>>>>        Get phDispatchDriver to hDispatchDriver
80827>>>>>        Send InvokeComMethod to hDispatchDriver 102 OLE_VT_VOID
80828>>>>>    End_Procedure
80829>>>>>
80829>>>>>    // Go Search Page.
80829>>>>>    Procedure ComGoSearch
80831>>>>>        Handle hDispatchDriver
80831>>>>>        Get phDispatchDriver to hDispatchDriver
80832>>>>>        Send InvokeComMethod to hDispatchDriver 103 OLE_VT_VOID
80833>>>>>    End_Procedure
80834>>>>>
80834>>>>>    // Navigates to a URL or file.
80834>>>>>    Procedure ComNavigate String llURL Variant llFlags Variant llTargetFrameName Variant llPostData Variant llHeaders
80836>>>>>        Handle hDispatchDriver
80836>>>>>        Get phDispatchDriver to hDispatchDriver
80837>>>>>        Send PrepareParams to hDispatchDriver 5
80838>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llURL
80839>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llFlags
80840>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llTargetFrameName
80841>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llPostData
80842>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llHeaders
80843>>>>>        Send InvokeComMethod to hDispatchDriver 104 OLE_VT_VOID
80844>>>>>    End_Procedure
80845>>>>>
80845>>>>>    // Refresh the currently viewed page.
80845>>>>>    Procedure ComRefresh
80847>>>>>        Handle hDispatchDriver
80847>>>>>        Get phDispatchDriver to hDispatchDriver
80848>>>>>        Send InvokeComMethod to hDispatchDriver -550 OLE_VT_VOID
80849>>>>>    End_Procedure
80850>>>>>
80850>>>>>    // Refresh the currently viewed page.
80850>>>>>    Procedure ComRefresh2 Variant llLevel
80852>>>>>        Handle hDispatchDriver
80852>>>>>        Get phDispatchDriver to hDispatchDriver
80853>>>>>        Send PrepareParams to hDispatchDriver 1
80854>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llLevel
80855>>>>>        Send InvokeComMethod to hDispatchDriver 105 OLE_VT_VOID
80856>>>>>    End_Procedure
80857>>>>>
80857>>>>>    // Stops opening a file.
80857>>>>>    Procedure ComStop
80859>>>>>        Handle hDispatchDriver
80859>>>>>        Get phDispatchDriver to hDispatchDriver
80860>>>>>        Send InvokeComMethod to hDispatchDriver 106 OLE_VT_VOID
80861>>>>>    End_Procedure
80862>>>>>
80862>>>>>    // Returns the application automation object if accessible, this automation object otherwise..
80862>>>>>    Function ComApplication Returns Variant
80864>>>>>        Handle hDispatchDriver
80864>>>>>        Variant retVal
80864>>>>>        Get phDispatchDriver to hDispatchDriver
80865>>>>>        Get InvokeComMethod of hDispatchDriver 200 OLE_VT_DISPATCH to retVal
80866>>>>>        Function_Return retVal
80867>>>>>    End_Function
80868>>>>>
80868>>>>>    // Returns the automation object of the container/parent if one exists or this automation object.
80868>>>>>    Function ComParent Returns Variant
80870>>>>>        Handle hDispatchDriver
80870>>>>>        Variant retVal
80870>>>>>        Get phDispatchDriver to hDispatchDriver
80871>>>>>        Get InvokeComMethod of hDispatchDriver 201 OLE_VT_DISPATCH to retVal
80872>>>>>        Function_Return retVal
80873>>>>>    End_Function
80874>>>>>
80874>>>>>    // Returns the container/parent automation object, if any.
80874>>>>>    Function ComContainer Returns Variant
80876>>>>>        Handle hDispatchDriver
80876>>>>>        Variant retVal
80876>>>>>        Get phDispatchDriver to hDispatchDriver
80877>>>>>        Get InvokeComMethod of hDispatchDriver 202 OLE_VT_DISPATCH to retVal
80878>>>>>        Function_Return retVal
80879>>>>>    End_Function
80880>>>>>
80880>>>>>    // Returns the active Document automation object, if any.
80880>>>>>    Function ComDocument Returns Variant
80882>>>>>        Handle hDispatchDriver
80882>>>>>        Variant retVal
80882>>>>>        Get phDispatchDriver to hDispatchDriver
80883>>>>>        Get InvokeComMethod of hDispatchDriver 203 OLE_VT_DISPATCH to retVal
80884>>>>>        Function_Return retVal
80885>>>>>    End_Function
80886>>>>>
80886>>>>>    // Returns True if this is the top level object.
80886>>>>>    Function ComTopLevelContainer Returns Boolean
80888>>>>>        Handle hDispatchDriver
80888>>>>>        Boolean retVal
80888>>>>>        Get phDispatchDriver to hDispatchDriver
80889>>>>>        Get InvokeComMethod of hDispatchDriver 204 OLE_VT_BOOL to retVal
80890>>>>>        Function_Return retVal
80891>>>>>    End_Function
80892>>>>>
80892>>>>>    // Returns the type of the contained document object.
80892>>>>>    Function ComType Returns String
80894>>>>>        Handle hDispatchDriver
80894>>>>>        String retVal
80894>>>>>        Get phDispatchDriver to hDispatchDriver
80895>>>>>        Get InvokeComMethod of hDispatchDriver 205 OLE_VT_BSTR to retVal
80896>>>>>        Function_Return retVal
80897>>>>>    End_Function
80898>>>>>
80898>>>>>    // The horizontal position (pixels) of the frame window relative to the screen/container.
80898>>>>>    Function ComLeft Returns Integer
80900>>>>>        Handle hDispatchDriver
80900>>>>>        Integer retVal
80900>>>>>        Get phDispatchDriver to hDispatchDriver
80901>>>>>        Get InvokeComMethod of hDispatchDriver 206 OLE_VT_I4 to retVal
80902>>>>>        Function_Return retVal
80903>>>>>    End_Function
80904>>>>>
80904>>>>>    // The horizontal position (pixels) of the frame window relative to the screen/container.
80904>>>>>    Procedure Set ComLeft Integer value
80906>>>>>        Handle hDispatchDriver
80906>>>>>        Get phDispatchDriver to hDispatchDriver
80907>>>>>        Send PrepareParams to hDispatchDriver 1
80908>>>>>        Set ComProperty of hDispatchDriver 206 OLE_VT_I4 to value
80909>>>>>    End_Procedure
80910>>>>>
80910>>>>>    // The vertical position (pixels) of the frame window relative to the screen/container.
80910>>>>>    Function ComTop Returns Integer
80912>>>>>        Handle hDispatchDriver
80912>>>>>        Integer retVal
80912>>>>>        Get phDispatchDriver to hDispatchDriver
80913>>>>>        Get InvokeComMethod of hDispatchDriver 207 OLE_VT_I4 to retVal
80914>>>>>        Function_Return retVal
80915>>>>>    End_Function
80916>>>>>
80916>>>>>    // The vertical position (pixels) of the frame window relative to the screen/container.
80916>>>>>    Procedure Set ComTop Integer value
80918>>>>>        Handle hDispatchDriver
80918>>>>>        Get phDispatchDriver to hDispatchDriver
80919>>>>>        Send PrepareParams to hDispatchDriver 1
80920>>>>>        Set ComProperty of hDispatchDriver 207 OLE_VT_I4 to value
80921>>>>>    End_Procedure
80922>>>>>
80922>>>>>    // The horizontal dimension (pixels) of the frame window/object.
80922>>>>>    Function ComWidth Returns Integer
80924>>>>>        Handle hDispatchDriver
80924>>>>>        Integer retVal
80924>>>>>        Get phDispatchDriver to hDispatchDriver
80925>>>>>        Get InvokeComMethod of hDispatchDriver 208 OLE_VT_I4 to retVal
80926>>>>>        Function_Return retVal
80927>>>>>    End_Function
80928>>>>>
80928>>>>>    // The horizontal dimension (pixels) of the frame window/object.
80928>>>>>    Procedure Set ComWidth Integer value
80930>>>>>        Handle hDispatchDriver
80930>>>>>        Get phDispatchDriver to hDispatchDriver
80931>>>>>        Send PrepareParams to hDispatchDriver 1
80932>>>>>        Set ComProperty of hDispatchDriver 208 OLE_VT_I4 to value
80933>>>>>    End_Procedure
80934>>>>>
80934>>>>>    // The vertical dimension (pixels) of the frame window/object.
80934>>>>>    Function ComHeight Returns Integer
80936>>>>>        Handle hDispatchDriver
80936>>>>>        Integer retVal
80936>>>>>        Get phDispatchDriver to hDispatchDriver
80937>>>>>        Get InvokeComMethod of hDispatchDriver 209 OLE_VT_I4 to retVal
80938>>>>>        Function_Return retVal
80939>>>>>    End_Function
80940>>>>>
80940>>>>>    // The vertical dimension (pixels) of the frame window/object.
80940>>>>>    Procedure Set ComHeight Integer value
80942>>>>>        Handle hDispatchDriver
80942>>>>>        Get phDispatchDriver to hDispatchDriver
80943>>>>>        Send PrepareParams to hDispatchDriver 1
80944>>>>>        Set ComProperty of hDispatchDriver 209 OLE_VT_I4 to value
80945>>>>>    End_Procedure
80946>>>>>
80946>>>>>    // Gets the short (UI-friendly) name of the URL/file currently viewed.
80946>>>>>    Function ComLocationName Returns String
80948>>>>>        Handle hDispatchDriver
80948>>>>>        String retVal
80948>>>>>        Get phDispatchDriver to hDispatchDriver
80949>>>>>        Get InvokeComMethod of hDispatchDriver 210 OLE_VT_BSTR to retVal
80950>>>>>        Function_Return retVal
80951>>>>>    End_Function
80952>>>>>
80952>>>>>    // Gets the full URL/path currently viewed.
80952>>>>>    Function ComLocationURL Returns String
80954>>>>>        Handle hDispatchDriver
80954>>>>>        String retVal
80954>>>>>        Get phDispatchDriver to hDispatchDriver
80955>>>>>        Get InvokeComMethod of hDispatchDriver 211 OLE_VT_BSTR to retVal
80956>>>>>        Function_Return retVal
80957>>>>>    End_Function
80958>>>>>
80958>>>>>    // Query to see if something is still in progress.
80958>>>>>    Function ComBusy Returns Boolean
80960>>>>>        Handle hDispatchDriver
80960>>>>>        Boolean retVal
80960>>>>>        Get phDispatchDriver to hDispatchDriver
80961>>>>>        Get InvokeComMethod of hDispatchDriver 212 OLE_VT_BOOL to retVal
80962>>>>>        Function_Return retVal
80963>>>>>    End_Function
80964>>>>>
80964>>>>>    // Exits application and closes the open document.
80964>>>>>    Procedure ComQuit
80966>>>>>        Handle hDispatchDriver
80966>>>>>        Get phDispatchDriver to hDispatchDriver
80967>>>>>        Send InvokeComMethod to hDispatchDriver 300 OLE_VT_VOID
80968>>>>>    End_Procedure
80969>>>>>
80969>>>>>    // Converts client sizes into window sizes.
80969>>>>>    Procedure ComClientToWindow Variant llpcx Variant llpcy
80971>>>>>        Handle hDispatchDriver
80971>>>>>        Get phDispatchDriver to hDispatchDriver
80972>>>>>        Send PrepareParams to hDispatchDriver 2
80973>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llpcx
80974>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_I4) llpcy
80975>>>>>        Send InvokeComMethod to hDispatchDriver 301 OLE_VT_VOID
80976>>>>>    End_Procedure
80977>>>>>
80977>>>>>    // Associates vtValue with the name szProperty in the context of the object.
80977>>>>>    Procedure ComPutProperty String llProperty Variant llvtValue
80979>>>>>        Handle hDispatchDriver
80979>>>>>        Get phDispatchDriver to hDispatchDriver
80980>>>>>        Send PrepareParams to hDispatchDriver 2
80981>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProperty
80982>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llvtValue
80983>>>>>        Send InvokeComMethod to hDispatchDriver 302 OLE_VT_VOID
80984>>>>>    End_Procedure
80985>>>>>
80985>>>>>    // Retrieve the Associated value for the property vtValue in the context of the object.
80985>>>>>    Function ComGetProperty String llProperty Returns Variant
80987>>>>>        Handle hDispatchDriver
80987>>>>>        Variant retVal
80987>>>>>        Get phDispatchDriver to hDispatchDriver
80988>>>>>        Send PrepareParams to hDispatchDriver 1
80989>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llProperty
80990>>>>>        Get InvokeComMethod of hDispatchDriver 303 OLE_VT_VARIANT to retVal
80991>>>>>        Function_Return retVal
80992>>>>>    End_Function
80993>>>>>
80993>>>>>    // Returns name of the application.
80993>>>>>    Function ComName Returns String
80995>>>>>        Handle hDispatchDriver
80995>>>>>        String retVal
80995>>>>>        Get phDispatchDriver to hDispatchDriver
80996>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_BSTR to retVal
80997>>>>>        Function_Return retVal
80998>>>>>    End_Function
80999>>>>>
80999>>>>>    // Returns the HWND of the current IE window.
80999>>>>>    Function ComHWND Returns Integer
81001>>>>>        Handle hDispatchDriver
81001>>>>>        Integer retVal
81001>>>>>        Get phDispatchDriver to hDispatchDriver
81002>>>>>        Get InvokeComMethod of hDispatchDriver -515 OLE_VT_I4 to retVal
81003>>>>>        Function_Return retVal
81004>>>>>    End_Function
81005>>>>>
81005>>>>>    // Returns file specification of the application, including path.
81005>>>>>    Function ComFullName Returns String
81007>>>>>        Handle hDispatchDriver
81007>>>>>        String retVal
81007>>>>>        Get phDispatchDriver to hDispatchDriver
81008>>>>>        Get InvokeComMethod of hDispatchDriver 400 OLE_VT_BSTR to retVal
81009>>>>>        Function_Return retVal
81010>>>>>    End_Function
81011>>>>>
81011>>>>>    // Returns the path to the application.
81011>>>>>    Function ComPath Returns String
81013>>>>>        Handle hDispatchDriver
81013>>>>>        String retVal
81013>>>>>        Get phDispatchDriver to hDispatchDriver
81014>>>>>        Get InvokeComMethod of hDispatchDriver 401 OLE_VT_BSTR to retVal
81015>>>>>        Function_Return retVal
81016>>>>>    End_Function
81017>>>>>
81017>>>>>    // Determines whether the application is visible or hidden.
81017>>>>>    Function ComVisible Returns Boolean
81019>>>>>        Handle hDispatchDriver
81019>>>>>        Boolean retVal
81019>>>>>        Get phDispatchDriver to hDispatchDriver
81020>>>>>        Get InvokeComMethod of hDispatchDriver 402 OLE_VT_BOOL to retVal
81021>>>>>        Function_Return retVal
81022>>>>>    End_Function
81023>>>>>
81023>>>>>    // Determines whether the application is visible or hidden.
81023>>>>>    Procedure Set ComVisible Boolean value
81025>>>>>        Handle hDispatchDriver
81025>>>>>        Get phDispatchDriver to hDispatchDriver
81026>>>>>        Send PrepareParams to hDispatchDriver 1
81027>>>>>        Set ComProperty of hDispatchDriver 402 OLE_VT_BOOL to value
81028>>>>>    End_Procedure
81029>>>>>
81029>>>>>    // Turn on or off the statusbar.
81029>>>>>    Function ComStatusBar Returns Boolean
81031>>>>>        Handle hDispatchDriver
81031>>>>>        Boolean retVal
81031>>>>>        Get phDispatchDriver to hDispatchDriver
81032>>>>>        Get InvokeComMethod of hDispatchDriver 403 OLE_VT_BOOL to retVal
81033>>>>>        Function_Return retVal
81034>>>>>    End_Function
81035>>>>>
81035>>>>>    // Turn on or off the statusbar.
81035>>>>>    Procedure Set ComStatusBar Boolean value
81037>>>>>        Handle hDispatchDriver
81037>>>>>        Get phDispatchDriver to hDispatchDriver
81038>>>>>        Send PrepareParams to hDispatchDriver 1
81039>>>>>        Set ComProperty of hDispatchDriver 403 OLE_VT_BOOL to value
81040>>>>>    End_Procedure
81041>>>>>
81041>>>>>    // Text of Status window.
81041>>>>>    Function ComStatusText Returns String
81043>>>>>        Handle hDispatchDriver
81043>>>>>        String retVal
81043>>>>>        Get phDispatchDriver to hDispatchDriver
81044>>>>>        Get InvokeComMethod of hDispatchDriver 404 OLE_VT_BSTR to retVal
81045>>>>>        Function_Return retVal
81046>>>>>    End_Function
81047>>>>>
81047>>>>>    // Text of Status window.
81047>>>>>    Procedure Set ComStatusText String value
81049>>>>>        Handle hDispatchDriver
81049>>>>>        Get phDispatchDriver to hDispatchDriver
81050>>>>>        Send PrepareParams to hDispatchDriver 1
81051>>>>>        Set ComProperty of hDispatchDriver 404 OLE_VT_BSTR to value
81052>>>>>    End_Procedure
81053>>>>>
81053>>>>>    // Controls which toolbar is shown.
81053>>>>>    Function ComToolBar Returns Integer
81055>>>>>        Handle hDispatchDriver
81055>>>>>        Integer retVal
81055>>>>>        Get phDispatchDriver to hDispatchDriver
81056>>>>>        Get InvokeComMethod of hDispatchDriver 405 OLE_VT_I4 to retVal
81057>>>>>        Function_Return retVal
81058>>>>>    End_Function
81059>>>>>
81059>>>>>    // Controls which toolbar is shown.
81059>>>>>    Procedure Set ComToolBar Integer value
81061>>>>>        Handle hDispatchDriver
81061>>>>>        Get phDispatchDriver to hDispatchDriver
81062>>>>>        Send PrepareParams to hDispatchDriver 1
81063>>>>>        Set ComProperty of hDispatchDriver 405 OLE_VT_I4 to value
81064>>>>>    End_Procedure
81065>>>>>
81065>>>>>    // Controls whether menubar is shown.
81065>>>>>    Function ComMenuBar Returns Boolean
81067>>>>>        Handle hDispatchDriver
81067>>>>>        Boolean retVal
81067>>>>>        Get phDispatchDriver to hDispatchDriver
81068>>>>>        Get InvokeComMethod of hDispatchDriver 406 OLE_VT_BOOL to retVal
81069>>>>>        Function_Return retVal
81070>>>>>    End_Function
81071>>>>>
81071>>>>>    // Controls whether menubar is shown.
81071>>>>>    Procedure Set ComMenuBar Boolean value
81073>>>>>        Handle hDispatchDriver
81073>>>>>        Get phDispatchDriver to hDispatchDriver
81074>>>>>        Send PrepareParams to hDispatchDriver 1
81075>>>>>        Set ComProperty of hDispatchDriver 406 OLE_VT_BOOL to value
81076>>>>>    End_Procedure
81077>>>>>
81077>>>>>    // Maximizes window and turns off statusbar, toolbar, menubar, and titlebar.
81077>>>>>    Function ComFullScreen Returns Boolean
81079>>>>>        Handle hDispatchDriver
81079>>>>>        Boolean retVal
81079>>>>>        Get phDispatchDriver to hDispatchDriver
81080>>>>>        Get InvokeComMethod of hDispatchDriver 407 OLE_VT_BOOL to retVal
81081>>>>>        Function_Return retVal
81082>>>>>    End_Function
81083>>>>>
81083>>>>>    // Maximizes window and turns off statusbar, toolbar, menubar, and titlebar.
81083>>>>>    Procedure Set ComFullScreen Boolean value
81085>>>>>        Handle hDispatchDriver
81085>>>>>        Get phDispatchDriver to hDispatchDriver
81086>>>>>        Send PrepareParams to hDispatchDriver 1
81087>>>>>        Set ComProperty of hDispatchDriver 407 OLE_VT_BOOL to value
81088>>>>>    End_Procedure
81089>>>>>
81089>>>>>    // Navigates to a URL or file or pidl.
81089>>>>>    Procedure ComNavigate2 Variant llURL Variant llFlags Variant llTargetFrameName Variant llPostData Variant llHeaders
81091>>>>>        Handle hDispatchDriver
81091>>>>>        Get phDispatchDriver to hDispatchDriver
81092>>>>>        Send PrepareParams to hDispatchDriver 5
81093>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llURL
81094>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llFlags
81095>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llTargetFrameName
81096>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llPostData
81097>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llHeaders
81098>>>>>        Send InvokeComMethod to hDispatchDriver 500 OLE_VT_VOID
81099>>>>>    End_Procedure
81100>>>>>
81100>>>>>    // IOleCommandTarget::QueryStatus
81100>>>>>    Function ComQueryStatusWB OLEOLECMDID llcmdID Returns OLEOLECMDF
81102>>>>>        Handle hDispatchDriver
81102>>>>>        OLEOLECMDF retVal
81102>>>>>        Get phDispatchDriver to hDispatchDriver
81103>>>>>        Send PrepareParams to hDispatchDriver 1
81104>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcmdID
81105>>>>>        Get InvokeComMethod of hDispatchDriver 501 OLE_VT_I4 to retVal
81106>>>>>        Function_Return retVal
81107>>>>>    End_Function
81108>>>>>
81108>>>>>    // IOleCommandTarget::Exec
81108>>>>>    Procedure ComExecWB OLEOLECMDID llcmdID OLEOLECMDEXECOPT llcmdexecopt Variant llpvaIn Variant llpvaOut
81110>>>>>        Handle hDispatchDriver
81110>>>>>        Get phDispatchDriver to hDispatchDriver
81111>>>>>        Send PrepareParams to hDispatchDriver 4
81112>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcmdID
81113>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 llcmdexecopt
81114>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llpvaIn
81115>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llpvaOut
81116>>>>>        Send InvokeComMethod to hDispatchDriver 502 OLE_VT_VOID
81117>>>>>    End_Procedure
81118>>>>>
81118>>>>>    // Set BrowserBar to Clsid
81118>>>>>    Procedure ComShowBrowserBar Variant llpvaClsid Variant llpvarShow Variant llpvarSize
81120>>>>>        Handle hDispatchDriver
81120>>>>>        Get phDispatchDriver to hDispatchDriver
81121>>>>>        Send PrepareParams to hDispatchDriver 3
81122>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llpvaClsid
81123>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llpvarShow
81124>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llpvarSize
81125>>>>>        Send InvokeComMethod to hDispatchDriver 503 OLE_VT_VOID
81126>>>>>    End_Procedure
81127>>>>>
81127>>>>>    Function ComReadyState Returns OLEtagREADYSTATE
81129>>>>>        Handle hDispatchDriver
81129>>>>>        OLEtagREADYSTATE retVal
81129>>>>>        Get phDispatchDriver to hDispatchDriver
81130>>>>>        Get InvokeComMethod of hDispatchDriver -525 OLE_VT_I4 to retVal
81131>>>>>        Function_Return retVal
81132>>>>>    End_Function
81133>>>>>
81133>>>>>    // Controls if the frame is offline (read from cache)
81133>>>>>    Function ComOffline Returns Boolean
81135>>>>>        Handle hDispatchDriver
81135>>>>>        Boolean retVal
81135>>>>>        Get phDispatchDriver to hDispatchDriver
81136>>>>>        Get InvokeComMethod of hDispatchDriver 550 OLE_VT_BOOL to retVal
81137>>>>>        Function_Return retVal
81138>>>>>    End_Function
81139>>>>>
81139>>>>>    // Controls if the frame is offline (read from cache)
81139>>>>>    Procedure Set ComOffline Boolean value
81141>>>>>        Handle hDispatchDriver
81141>>>>>        Get phDispatchDriver to hDispatchDriver
81142>>>>>        Send PrepareParams to hDispatchDriver 1
81143>>>>>        Set ComProperty of hDispatchDriver 550 OLE_VT_BOOL to value
81144>>>>>    End_Procedure
81145>>>>>
81145>>>>>    // Controls if any dialog boxes can be shown
81145>>>>>    Function ComSilent Returns Boolean
81147>>>>>        Handle hDispatchDriver
81147>>>>>        Boolean retVal
81147>>>>>        Get phDispatchDriver to hDispatchDriver
81148>>>>>        Get InvokeComMethod of hDispatchDriver 551 OLE_VT_BOOL to retVal
81149>>>>>        Function_Return retVal
81150>>>>>    End_Function
81151>>>>>
81151>>>>>    // Controls if any dialog boxes can be shown
81151>>>>>    Procedure Set ComSilent Boolean value
81153>>>>>        Handle hDispatchDriver
81153>>>>>        Get phDispatchDriver to hDispatchDriver
81154>>>>>        Send PrepareParams to hDispatchDriver 1
81155>>>>>        Set ComProperty of hDispatchDriver 551 OLE_VT_BOOL to value
81156>>>>>    End_Procedure
81157>>>>>
81157>>>>>    // Registers OC as a top-level browser (for target name resolution)
81157>>>>>    Function ComRegisterAsBrowser Returns Boolean
81159>>>>>        Handle hDispatchDriver
81159>>>>>        Boolean retVal
81159>>>>>        Get phDispatchDriver to hDispatchDriver
81160>>>>>        Get InvokeComMethod of hDispatchDriver 552 OLE_VT_BOOL to retVal
81161>>>>>        Function_Return retVal
81162>>>>>    End_Function
81163>>>>>
81163>>>>>    // Registers OC as a top-level browser (for target name resolution)
81163>>>>>    Procedure Set ComRegisterAsBrowser Boolean value
81165>>>>>        Handle hDispatchDriver
81165>>>>>        Get phDispatchDriver to hDispatchDriver
81166>>>>>        Send PrepareParams to hDispatchDriver 1
81167>>>>>        Set ComProperty of hDispatchDriver 552 OLE_VT_BOOL to value
81168>>>>>    End_Procedure
81169>>>>>
81169>>>>>    // Registers OC as a drop target for navigation
81169>>>>>    Function ComRegisterAsDropTarget Returns Boolean
81171>>>>>        Handle hDispatchDriver
81171>>>>>        Boolean retVal
81171>>>>>        Get phDispatchDriver to hDispatchDriver
81172>>>>>        Get InvokeComMethod of hDispatchDriver 553 OLE_VT_BOOL to retVal
81173>>>>>        Function_Return retVal
81174>>>>>    End_Function
81175>>>>>
81175>>>>>    // Registers OC as a drop target for navigation
81175>>>>>    Procedure Set ComRegisterAsDropTarget Boolean value
81177>>>>>        Handle hDispatchDriver
81177>>>>>        Get phDispatchDriver to hDispatchDriver
81178>>>>>        Send PrepareParams to hDispatchDriver 1
81179>>>>>        Set ComProperty of hDispatchDriver 553 OLE_VT_BOOL to value
81180>>>>>    End_Procedure
81181>>>>>
81181>>>>>    // Controls if the browser is in theater mode
81181>>>>>    Function ComTheaterMode Returns Boolean
81183>>>>>        Handle hDispatchDriver
81183>>>>>        Boolean retVal
81183>>>>>        Get phDispatchDriver to hDispatchDriver
81184>>>>>        Get InvokeComMethod of hDispatchDriver 554 OLE_VT_BOOL to retVal
81185>>>>>        Function_Return retVal
81186>>>>>    End_Function
81187>>>>>
81187>>>>>    // Controls if the browser is in theater mode
81187>>>>>    Procedure Set ComTheaterMode Boolean value
81189>>>>>        Handle hDispatchDriver
81189>>>>>        Get phDispatchDriver to hDispatchDriver
81190>>>>>        Send PrepareParams to hDispatchDriver 1
81191>>>>>        Set ComProperty of hDispatchDriver 554 OLE_VT_BOOL to value
81192>>>>>    End_Procedure
81193>>>>>
81193>>>>>    // Controls whether address bar is shown
81193>>>>>    Function ComAddressBar Returns Boolean
81195>>>>>        Handle hDispatchDriver
81195>>>>>        Boolean retVal
81195>>>>>        Get phDispatchDriver to hDispatchDriver
81196>>>>>        Get InvokeComMethod of hDispatchDriver 555 OLE_VT_BOOL to retVal
81197>>>>>        Function_Return retVal
81198>>>>>    End_Function
81199>>>>>
81199>>>>>    // Controls whether address bar is shown
81199>>>>>    Procedure Set ComAddressBar Boolean value
81201>>>>>        Handle hDispatchDriver
81201>>>>>        Get phDispatchDriver to hDispatchDriver
81202>>>>>        Send PrepareParams to hDispatchDriver 1
81203>>>>>        Set ComProperty of hDispatchDriver 555 OLE_VT_BOOL to value
81204>>>>>    End_Procedure
81205>>>>>
81205>>>>>    // Controls whether the window is resizable
81205>>>>>    Function ComResizable Returns Boolean
81207>>>>>        Handle hDispatchDriver
81207>>>>>        Boolean retVal
81207>>>>>        Get phDispatchDriver to hDispatchDriver
81208>>>>>        Get InvokeComMethod of hDispatchDriver 556 OLE_VT_BOOL to retVal
81209>>>>>        Function_Return retVal
81210>>>>>    End_Function
81211>>>>>
81211>>>>>    // Controls whether the window is resizable
81211>>>>>    Procedure Set ComResizable Boolean value
81213>>>>>        Handle hDispatchDriver
81213>>>>>        Get phDispatchDriver to hDispatchDriver
81214>>>>>        Send PrepareParams to hDispatchDriver 1
81215>>>>>        Set ComProperty of hDispatchDriver 556 OLE_VT_BOOL to value
81216>>>>>    End_Procedure
81217>>>>>End_Class
81218>>>>>
81218>>>>>// CLSID: {34A715A0-6587-11D0-924A-0020AFC7AC4D}
81218>>>>>// Web Browser Control events interface
81218>>>>>Class cComDWebBrowserEvents2 is a Mixin
81219>>>>>
81219>>>>>    // Statusbar text changed.
81219>>>>>    Procedure OnComStatusTextChange String llText
81221>>>>>    End_Procedure
81222>>>>>
81222>>>>>    // Fired when download progress is updated.
81222>>>>>    Procedure OnComProgressChange Integer llProgress Integer llProgressMax
81224>>>>>    End_Procedure
81225>>>>>
81225>>>>>    // The enabled state of a command changed.
81225>>>>>    Procedure OnComCommandStateChange Integer llCommand Boolean llEnable
81227>>>>>    End_Procedure
81228>>>>>
81228>>>>>    // Download of a page started.
81228>>>>>    Procedure OnComDownloadBegin
81230>>>>>    End_Procedure
81231>>>>>
81231>>>>>    // Download of page complete.
81231>>>>>    Procedure OnComDownloadComplete
81233>>>>>    End_Procedure
81234>>>>>
81234>>>>>    // Document title changed.
81234>>>>>    Procedure OnComTitleChange String llText
81236>>>>>    End_Procedure
81237>>>>>
81237>>>>>    // Fired when the PutProperty method has been called.
81237>>>>>    Procedure OnComPropertyChange String llszProperty
81239>>>>>    End_Procedure
81240>>>>>
81240>>>>>    // Fired before navigate occurs in the given WebBrowser (window or frameset element). The processing of this navigation may be modified.
81240>>>>>    Procedure OnComBeforeNavigate2 Variant llpDisp Variant llURL Variant llFlags Variant llTargetFrameName Variant llPostData Variant llHeaders Variant llCancel
81242>>>>>    End_Procedure
81243>>>>>
81243>>>>>    // A new, hidden, non-navigated WebBrowser window is needed.
81243>>>>>    Procedure OnComNewWindow2 Variant llppDisp Variant llCancel
81245>>>>>    End_Procedure
81246>>>>>
81246>>>>>    // Fired when the document being navigated to becomes visible and enters the navigation stack.
81246>>>>>    Procedure OnComNavigateComplete2 Variant llpDisp Variant llURL
81248>>>>>    End_Procedure
81249>>>>>
81249>>>>>    // Fired when the document being navigated to reaches ReadyState_Complete.
81249>>>>>    Procedure OnComDocumentComplete Variant llpDisp Variant llURL
81251>>>>>    End_Procedure
81252>>>>>
81252>>>>>    // Fired when application is quiting.
81252>>>>>    Procedure OnComQuit
81254>>>>>    End_Procedure
81255>>>>>
81255>>>>>    // Fired when the window should be shown/hidden
81255>>>>>    Procedure OnComVisible Boolean llVisible
81257>>>>>    End_Procedure
81258>>>>>
81258>>>>>    // Fired when the toolbar  should be shown/hidden
81258>>>>>    Procedure OnComToolBar Boolean llToolBar
81260>>>>>    End_Procedure
81261>>>>>
81261>>>>>    // Fired when the menubar should be shown/hidden
81261>>>>>    Procedure OnComMenuBar Boolean llMenuBar
81263>>>>>    End_Procedure
81264>>>>>
81264>>>>>    // Fired when the statusbar should be shown/hidden
81264>>>>>    Procedure OnComStatusBar Boolean llStatusBar
81266>>>>>    End_Procedure
81267>>>>>
81267>>>>>    // Fired when fullscreen mode should be on/off
81267>>>>>    Procedure OnComFullScreen Boolean llFullScreen
81269>>>>>    End_Procedure
81270>>>>>
81270>>>>>    // Fired when theater mode should be on/off
81270>>>>>    Procedure OnComTheaterMode Boolean llTheaterMode
81272>>>>>    End_Procedure
81273>>>>>
81273>>>>>    // Fired when the host window should allow/disallow resizing
81273>>>>>    Procedure OnComWindowSetResizable Boolean llResizable
81275>>>>>    End_Procedure
81276>>>>>
81276>>>>>    // Fired when the host window should change its Left coordinate
81276>>>>>    Procedure OnComWindowSetLeft Integer llLeft
81278>>>>>    End_Procedure
81279>>>>>
81279>>>>>    // Fired when the host window should change its Top coordinate
81279>>>>>    Procedure OnComWindowSetTop Integer llTop
81281>>>>>    End_Procedure
81282>>>>>
81282>>>>>    // Fired when the host window should change its width
81282>>>>>    Procedure OnComWindowSetWidth Integer llWidth
81284>>>>>    End_Procedure
81285>>>>>
81285>>>>>    // Fired when the host window should change its height
81285>>>>>    Procedure OnComWindowSetHeight Integer llHeight
81287>>>>>    End_Procedure
81288>>>>>
81288>>>>>    // Fired when the WebBrowser is about to be closed by script
81288>>>>>    Procedure OnComWindowClosing Boolean llIsChildWindow Variant llCancel
81290>>>>>    End_Procedure
81291>>>>>
81291>>>>>    // Fired to request client sizes be converted to host window sizes
81291>>>>>    Procedure OnComClientToHostWindow Variant llCX Variant llCY
81293>>>>>    End_Procedure
81294>>>>>
81294>>>>>    // Fired to indicate the security level of the current web page contents
81294>>>>>    Procedure OnComSetSecureLockIcon Integer llSecureLockIcon
81296>>>>>    End_Procedure
81297>>>>>
81297>>>>>    // Fired to indicate the File Download dialog is opening
81297>>>>>    Procedure OnComFileDownload Variant llCancel
81299>>>>>    End_Procedure
81300>>>>>
81300>>>>>    // Fired when a binding error occurs (window or frameset element).
81300>>>>>    Procedure OnComNavigateError Variant llpDisp Variant llURL Variant llFrame Variant llStatusCode Variant llCancel
81302>>>>>    End_Procedure
81303>>>>>
81303>>>>>    // Fired when a print template is instantiated.
81303>>>>>    Procedure OnComPrintTemplateInstantiation Variant llpDisp
81305>>>>>    End_Procedure
81306>>>>>
81306>>>>>    // Fired when a print template destroyed.
81306>>>>>    Procedure OnComPrintTemplateTeardown Variant llpDisp
81308>>>>>    End_Procedure
81309>>>>>
81309>>>>>    // Fired when a page is spooled. When it is fired can be changed by a custom template.
81309>>>>>    Procedure OnComUpdatePageStatus Variant llpDisp Variant llnPage Variant llfDone
81311>>>>>    End_Procedure
81312>>>>>
81312>>>>>    // Fired when the global privacy impacted state changes
81312>>>>>    Procedure OnComPrivacyImpactedStateChange Boolean llbImpacted
81314>>>>>    End_Procedure
81315>>>>>
81315>>>>>    // A new, hidden, non-navigated WebBrowser window is needed.
81315>>>>>    Procedure OnComNewWindow3 Variant llppDisp Variant llCancel UInteger lldwFlags String llbstrUrlContext String llbstrUrl
81317>>>>>    End_Procedure
81318>>>>>
81318>>>>>    Procedure RegisterComEvents
81320>>>>>        Send RegisterComEvent 102 msg_OnComStatusTextChange
81321>>>>>        Send RegisterComEvent 108 msg_OnComProgressChange
81322>>>>>        Send RegisterComEvent 105 msg_OnComCommandStateChange
81323>>>>>        Send RegisterComEvent 106 msg_OnComDownloadBegin
81324>>>>>        Send RegisterComEvent 104 msg_OnComDownloadComplete
81325>>>>>        Send RegisterComEvent 113 msg_OnComTitleChange
81326>>>>>        Send RegisterComEvent 112 msg_OnComPropertyChange
81327>>>>>        Send RegisterComEvent 250 msg_OnComBeforeNavigate2
81328>>>>>        Send RegisterComEvent 251 msg_OnComNewWindow2
81329>>>>>        Send RegisterComEvent 252 msg_OnComNavigateComplete2
81330>>>>>        Send RegisterComEvent 259 msg_OnComDocumentComplete
81331>>>>>        Send RegisterComEvent 253 msg_OnComQuit
81332>>>>>        Send RegisterComEvent 254 msg_OnComVisible
81333>>>>>        Send RegisterComEvent 255 msg_OnComToolBar
81334>>>>>        Send RegisterComEvent 256 msg_OnComMenuBar
81335>>>>>        Send RegisterComEvent 257 msg_OnComStatusBar
81336>>>>>        Send RegisterComEvent 258 msg_OnComFullScreen
81337>>>>>        Send RegisterComEvent 260 msg_OnComTheaterMode
81338>>>>>        Send RegisterComEvent 262 msg_OnComWindowSetResizable
81339>>>>>        Send RegisterComEvent 264 msg_OnComWindowSetLeft
81340>>>>>        Send RegisterComEvent 265 msg_OnComWindowSetTop
81341>>>>>        Send RegisterComEvent 266 msg_OnComWindowSetWidth
81342>>>>>        Send RegisterComEvent 267 msg_OnComWindowSetHeight
81343>>>>>        Send RegisterComEvent 263 msg_OnComWindowClosing
81344>>>>>        Send RegisterComEvent 268 msg_OnComClientToHostWindow
81345>>>>>        Send RegisterComEvent 269 msg_OnComSetSecureLockIcon
81346>>>>>        Send RegisterComEvent 270 msg_OnComFileDownload
81347>>>>>        Send RegisterComEvent 271 msg_OnComNavigateError
81348>>>>>        Send RegisterComEvent 225 msg_OnComPrintTemplateInstantiation
81349>>>>>        Send RegisterComEvent 226 msg_OnComPrintTemplateTeardown
81350>>>>>        Send RegisterComEvent 227 msg_OnComUpdatePageStatus
81351>>>>>        Send RegisterComEvent 272 msg_OnComPrivacyImpactedStateChange
81352>>>>>        Send RegisterComEvent 273 msg_OnComNewWindow3
81353>>>>>    End_Procedure
81354>>>>>End_Class
81355>>>>>
81355>>>>>// CoClass
81355>>>>>// ProgID: Shell.Explorer.2
81355>>>>>// CLSID: {8856F961-340A-11D0-A96B-00C04FD705A2}
81355>>>>>// WebBrowser Control
81355>>>>>// Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:50
81355>>>>>// Visual DataFlex 17.0 Migration Utility, added November 28, 2012: 09:32:55
81355>>>>>Class cComWebBrowser is a cComActiveXControl
81356>>>>>    Import_Class_Protocol cComIWebBrowser2
81357>>>>>    Import_Class_Protocol cComDWebBrowserEvents2
81358>>>>>
81358>>>>>    Procedure Construct_Object
81360>>>>>        Forward Send Construct_Object
81362>>>>>        Set psProgID to "{8856F961-340A-11D0-A96B-00C04FD705A2}"
81363>>>>>        Set psEventId to "{34A715A0-6587-11D0-924A-0020AFC7AC4D}"
81364>>>>>        Set peAutoCreate to acDeferredAutoCreate
81365>>>>>    End_Procedure
81366>>>>>End_Class
81367>>>>>
81367>>>>>// CoClass
81367>>>>>// ProgID: InternetExplorer.Application.1
81367>>>>>// CLSID: {0002DF01-0000-0000-C000-000000000046}
81367>>>>>// Internet Explorer Application.
81367>>>>>Class cComInternetExplorer is a cComAutomationObject
81368>>>>>    Import_Class_Protocol cComIWebBrowser2
81369>>>>>    Import_Class_Protocol cComDWebBrowserEvents2
81370>>>>>
81370>>>>>    Procedure Construct_Object
81372>>>>>        Forward Send Construct_Object
81374>>>>>        Set psProgID to "{0002DF01-0000-0000-C000-000000000046}"
81375>>>>>        Set psEventId to "{34A715A0-6587-11D0-924A-0020AFC7AC4D}"
81376>>>>>        Set peAutoCreate to acNoAutoCreate
81377>>>>>    End_Procedure
81378>>>>>End_Class
81379>>>>>
81379>>>>>// CLSID: {85CB6900-4D95-11CF-960C-0080C7F4EE85}
81379>>>>>// Definition of interface IShellWindows
81379>>>>>Class cComIShellWindows is a Mixin
81380>>>>>
81380>>>>>    // Get count of open Shell windows
81380>>>>>    Function ComCount Returns Integer
81382>>>>>        Handle hDispatchDriver
81382>>>>>        Integer retVal
81382>>>>>        Get phDispatchDriver to hDispatchDriver
81383>>>>>        Get InvokeComMethod of hDispatchDriver 1610743808 OLE_VT_I4 to retVal
81384>>>>>        Function_Return retVal
81385>>>>>    End_Function
81386>>>>>
81386>>>>>    // Return the shell window for the given index
81386>>>>>    Function ComItem Variant llindex Returns Variant
81388>>>>>        Handle hDispatchDriver
81388>>>>>        Variant retVal
81388>>>>>        Get phDispatchDriver to hDispatchDriver
81389>>>>>        Send PrepareParams to hDispatchDriver 1
81390>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llindex
81391>>>>>        Get InvokeComMethod of hDispatchDriver 0 OLE_VT_DISPATCH to retVal
81392>>>>>        Function_Return retVal
81393>>>>>    End_Function
81394>>>>>
81394>>>>>    // Enumerates the figures
81394>>>>>    Function Com_NewEnum Returns Variant
81396>>>>>        Handle hDispatchDriver
81396>>>>>        Variant retVal
81396>>>>>        Get phDispatchDriver to hDispatchDriver
81397>>>>>        Get InvokeComMethod of hDispatchDriver -4 OLE_VT_UNKNOWN to retVal
81398>>>>>        Function_Return retVal
81399>>>>>    End_Function
81400>>>>>End_Class
81401>>>>>
81401>>>>>// CLSID: {FE4106E0-399A-11D0-A48C-00A0C90A8F39}
81401>>>>>// Event interface for IShellWindows
81401>>>>>Class cComDShellWindowsEvents is a Mixin
81402>>>>>
81402>>>>>    // A new window was registered.
81402>>>>>    Procedure OnComWindowRegistered Integer lllCookie
81404>>>>>    End_Procedure
81405>>>>>
81405>>>>>    // A new window was revoked.
81405>>>>>    Procedure OnComWindowRevoked Integer lllCookie
81407>>>>>    End_Procedure
81408>>>>>
81408>>>>>    Procedure RegisterComEvents
81410>>>>>        Send RegisterComEvent 200 msg_OnComWindowRegistered
81411>>>>>        Send RegisterComEvent 201 msg_OnComWindowRevoked
81412>>>>>    End_Procedure
81413>>>>>End_Class
81414>>>>>
81414>>>>>// CoClass
81414>>>>>// CLSID: {9BA05972-F6A8-11CF-A442-00A0C90A8F39}
81414>>>>>// ShellDispatch Load in Shell Context
81414>>>>>Class cComShellWindows is a cComAutomationObject
81415>>>>>    Import_Class_Protocol cComIShellWindows
81416>>>>>    Import_Class_Protocol cComDShellWindowsEvents
81417>>>>>
81417>>>>>    Procedure Construct_Object
81419>>>>>        Forward Send Construct_Object
81421>>>>>        Set psProgID to "{9BA05972-F6A8-11CF-A442-00A0C90A8F39}"
81422>>>>>        Set psEventId to "{FE4106E0-399A-11D0-A48C-00A0C90A8F39}"
81423>>>>>        Set peAutoCreate to acNoAutoCreate
81424>>>>>    End_Procedure
81425>>>>>End_Class
81426>>>>>
81426>>>>>// CLSID: {729FE2F8-1EA8-11D1-8F85-00C04FC2FBE1}
81426>>>>>// Shell UI Helper Control Interface
81426>>>>>Class cComIShellUIHelper is a Mixin
81427>>>>>
81427>>>>>    Procedure ComAddFavorite String llURL Variant llTitle
81429>>>>>        Handle hDispatchDriver
81429>>>>>        Get phDispatchDriver to hDispatchDriver
81430>>>>>        Send PrepareParams to hDispatchDriver 2
81431>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llURL
81432>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llTitle
81433>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
81434>>>>>    End_Procedure
81435>>>>>
81435>>>>>    Procedure ComAddChannel String llURL
81437>>>>>        Handle hDispatchDriver
81437>>>>>        Get phDispatchDriver to hDispatchDriver
81438>>>>>        Send PrepareParams to hDispatchDriver 1
81439>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llURL
81440>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
81441>>>>>    End_Procedure
81442>>>>>
81442>>>>>    Procedure ComAddDesktopComponent String llURL String llType Variant llLeft Variant llTop Variant llWidth Variant llHeight
81444>>>>>        Handle hDispatchDriver
81444>>>>>        Get phDispatchDriver to hDispatchDriver
81445>>>>>        Send PrepareParams to hDispatchDriver 6
81446>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llURL
81447>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llType
81448>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llLeft
81449>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llTop
81450>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llWidth
81451>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llHeight
81452>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
81453>>>>>    End_Procedure
81454>>>>>
81454>>>>>    Function ComIsSubscribed String llURL Returns Boolean
81456>>>>>        Handle hDispatchDriver
81456>>>>>        Boolean retVal
81456>>>>>        Get phDispatchDriver to hDispatchDriver
81457>>>>>        Send PrepareParams to hDispatchDriver 1
81458>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llURL
81459>>>>>        Get InvokeComMethod of hDispatchDriver 7 OLE_VT_BOOL to retVal
81460>>>>>        Function_Return retVal
81461>>>>>    End_Function
81462>>>>>
81462>>>>>    Procedure ComNavigateAndFind String llURL String llstrQuery Variant llvarTargetFrame
81464>>>>>        Handle hDispatchDriver
81464>>>>>        Get phDispatchDriver to hDispatchDriver
81465>>>>>        Send PrepareParams to hDispatchDriver 3
81466>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llURL
81467>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstrQuery
81468>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llvarTargetFrame
81469>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
81470>>>>>    End_Procedure
81471>>>>>
81471>>>>>    Procedure ComImportExportFavorites Boolean llfImport String llstrImpExpPath
81473>>>>>        Handle hDispatchDriver
81473>>>>>        Get phDispatchDriver to hDispatchDriver
81474>>>>>        Send PrepareParams to hDispatchDriver 2
81475>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BOOL llfImport
81476>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstrImpExpPath
81477>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
81478>>>>>    End_Procedure
81479>>>>>
81479>>>>>    Procedure ComAutoCompleteSaveForm Variant llForm
81481>>>>>        Handle hDispatchDriver
81481>>>>>        Get phDispatchDriver to hDispatchDriver
81482>>>>>        Send PrepareParams to hDispatchDriver 1
81483>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llForm
81484>>>>>        Send InvokeComMethod to hDispatchDriver 10 OLE_VT_VOID
81485>>>>>    End_Procedure
81486>>>>>
81486>>>>>    Procedure ComAutoScan String llstrSearch String llstrFailureUrl Variant llpvarTargetFrame
81488>>>>>        Handle hDispatchDriver
81488>>>>>        Get phDispatchDriver to hDispatchDriver
81489>>>>>        Send PrepareParams to hDispatchDriver 3
81490>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstrSearch
81491>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstrFailureUrl
81492>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llpvarTargetFrame
81493>>>>>        Send InvokeComMethod to hDispatchDriver 11 OLE_VT_VOID
81494>>>>>    End_Procedure
81495>>>>>
81495>>>>>    Function ComShowBrowserUI String llbstrName Variant llpvarIn Returns Variant
81497>>>>>        Handle hDispatchDriver
81497>>>>>        Variant retVal
81497>>>>>        Get phDispatchDriver to hDispatchDriver
81498>>>>>        Send PrepareParams to hDispatchDriver 2
81499>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llbstrName
81500>>>>>        Send DefineParam to hDispatchDriver (OLE_VT_BYREF ior OLE_VT_VARIANT) llpvarIn
81501>>>>>        Get InvokeComMethod of hDispatchDriver 13 OLE_VT_VARIANT to retVal
81502>>>>>        Function_Return retVal
81503>>>>>    End_Function
81504>>>>>End_Class
81505>>>>>
81505>>>>>// CoClass
81505>>>>>// ProgID: Shell.UIHelper.1
81505>>>>>// CLSID: {64AB4BB7-111E-11D1-8F79-00C04FC2FBE1}
81505>>>>>Class cComShellUIHelper is a cComAutomationObject
81506>>>>>    Import_Class_Protocol cComIShellUIHelper
81507>>>>>
81507>>>>>    Procedure Construct_Object
81509>>>>>        Forward Send Construct_Object
81511>>>>>        Set psProgID to "{64AB4BB7-111E-11D1-8F79-00C04FC2FBE1}"
81512>>>>>        Set peAutoCreate to acNoAutoCreate
81513>>>>>    End_Procedure
81514>>>>>End_Class
81515>>>>>
81515>>>>>// CLSID: {E572D3C9-37BE-4AE2-825D-D521763E3108}
81515>>>>>// IShellNameSpace Interface
81515>>>>>Class cComIShellNameSpace is a Mixin
81516>>>>>
81516>>>>>    // method MoveSelectionUp
81516>>>>>    Procedure ComMoveSelectionUp
81518>>>>>        Handle hDispatchDriver
81518>>>>>        Get phDispatchDriver to hDispatchDriver
81519>>>>>        Send InvokeComMethod to hDispatchDriver 1 OLE_VT_VOID
81520>>>>>    End_Procedure
81521>>>>>
81521>>>>>    // method MoveSelectionDown
81521>>>>>    Procedure ComMoveSelectionDown
81523>>>>>        Handle hDispatchDriver
81523>>>>>        Get phDispatchDriver to hDispatchDriver
81524>>>>>        Send InvokeComMethod to hDispatchDriver 2 OLE_VT_VOID
81525>>>>>    End_Procedure
81526>>>>>
81526>>>>>    // method ResetSort
81526>>>>>    Procedure ComResetSort
81528>>>>>        Handle hDispatchDriver
81528>>>>>        Get phDispatchDriver to hDispatchDriver
81529>>>>>        Send InvokeComMethod to hDispatchDriver 3 OLE_VT_VOID
81530>>>>>    End_Procedure
81531>>>>>
81531>>>>>    // method NewFolder
81531>>>>>    Procedure ComNewFolder
81533>>>>>        Handle hDispatchDriver
81533>>>>>        Get phDispatchDriver to hDispatchDriver
81534>>>>>        Send InvokeComMethod to hDispatchDriver 4 OLE_VT_VOID
81535>>>>>    End_Procedure
81536>>>>>
81536>>>>>    // method Synchronize
81536>>>>>    Procedure ComSynchronize
81538>>>>>        Handle hDispatchDriver
81538>>>>>        Get phDispatchDriver to hDispatchDriver
81539>>>>>        Send InvokeComMethod to hDispatchDriver 5 OLE_VT_VOID
81540>>>>>    End_Procedure
81541>>>>>
81541>>>>>    // method Import
81541>>>>>    Procedure ComImport
81543>>>>>        Handle hDispatchDriver
81543>>>>>        Get phDispatchDriver to hDispatchDriver
81544>>>>>        Send InvokeComMethod to hDispatchDriver 6 OLE_VT_VOID
81545>>>>>    End_Procedure
81546>>>>>
81546>>>>>    // method Export
81546>>>>>    Procedure ComExport
81548>>>>>        Handle hDispatchDriver
81548>>>>>        Get phDispatchDriver to hDispatchDriver
81549>>>>>        Send InvokeComMethod to hDispatchDriver 7 OLE_VT_VOID
81550>>>>>    End_Procedure
81551>>>>>
81551>>>>>    // method InvokeContextMenuCommand
81551>>>>>    Procedure ComInvokeContextMenuCommand String llstrCommand
81553>>>>>        Handle hDispatchDriver
81553>>>>>        Get phDispatchDriver to hDispatchDriver
81554>>>>>        Send PrepareParams to hDispatchDriver 1
81555>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llstrCommand
81556>>>>>        Send InvokeComMethod to hDispatchDriver 8 OLE_VT_VOID
81557>>>>>    End_Procedure
81558>>>>>
81558>>>>>    // method MoveSelectionTo
81558>>>>>    Procedure ComMoveSelectionTo
81560>>>>>        Handle hDispatchDriver
81560>>>>>        Get phDispatchDriver to hDispatchDriver
81561>>>>>        Send InvokeComMethod to hDispatchDriver 9 OLE_VT_VOID
81562>>>>>    End_Procedure
81563>>>>>
81563>>>>>    // Query to see if subscriptions are enabled
81563>>>>>    Function ComSubscriptionsEnabled Returns Boolean
81565>>>>>        Handle hDispatchDriver
81565>>>>>        Boolean retVal
81565>>>>>        Get phDispatchDriver to hDispatchDriver
81566>>>>>        Get InvokeComMethod of hDispatchDriver 10 OLE_VT_BOOL to retVal
81567>>>>>        Function_Return retVal
81568>>>>>    End_Function
81569>>>>>
81569>>>>>    // method CreateSubscriptionForSelection
81569>>>>>    Function ComCreateSubscriptionForSelection Returns Boolean
81571>>>>>        Handle hDispatchDriver
81571>>>>>        Boolean retVal
81571>>>>>        Get phDispatchDriver to hDispatchDriver
81572>>>>>        Get InvokeComMethod of hDispatchDriver 11 OLE_VT_BOOL to retVal
81573>>>>>        Function_Return retVal
81574>>>>>    End_Function
81575>>>>>
81575>>>>>    // method DeleteSubscriptionForSelection
81575>>>>>    Function ComDeleteSubscriptionForSelection Returns Boolean
81577>>>>>        Handle hDispatchDriver
81577>>>>>        Boolean retVal
81577>>>>>        Get phDispatchDriver to hDispatchDriver
81578>>>>>        Get InvokeComMethod of hDispatchDriver 12 OLE_VT_BOOL to retVal
81579>>>>>        Function_Return retVal
81580>>>>>    End_Function
81581>>>>>
81581>>>>>    // old, use put_Root() instead
81581>>>>>    Procedure ComSetRoot String llbstrFullPath
81583>>>>>        Handle hDispatchDriver
81583>>>>>        Get phDispatchDriver to hDispatchDriver
81584>>>>>        Send PrepareParams to hDispatchDriver 1
81585>>>>>        Send DefineParam to hDispatchDriver OLE_VT_BSTR llbstrFullPath
81586>>>>>        Send InvokeComMethod to hDispatchDriver 13 OLE_VT_VOID
81587>>>>>    End_Procedure
81588>>>>>
81588>>>>>    // options 
81588>>>>>    Function ComEnumOptions Returns Integer
81590>>>>>        Handle hDispatchDriver
81590>>>>>        Integer retVal
81590>>>>>        Get phDispatchDriver to hDispatchDriver
81591>>>>>        Get InvokeComMethod of hDispatchDriver 14 OLE_VT_I4 to retVal
81592>>>>>        Function_Return retVal
81593>>>>>    End_Function
81594>>>>>
81594>>>>>    // options 
81594>>>>>    Procedure Set ComEnumOptions Integer value
81596>>>>>        Handle hDispatchDriver
81596>>>>>        Get phDispatchDriver to hDispatchDriver
81597>>>>>        Send PrepareParams to hDispatchDriver 1
81598>>>>>        Set ComProperty of hDispatchDriver 14 OLE_VT_I4 to value
81599>>>>>    End_Procedure
81600>>>>>
81600>>>>>    // get the selected item
81600>>>>>    Function ComSelectedItem Returns Variant
81602>>>>>        Handle hDispatchDriver
81602>>>>>        Variant retVal
81602>>>>>        Get phDispatchDriver to hDispatchDriver
81603>>>>>        Get InvokeComMethod of hDispatchDriver 15 OLE_VT_DISPATCH to retVal
81604>>>>>        Function_Return retVal
81605>>>>>    End_Function
81606>>>>>
81606>>>>>    // get the selected item
81606>>>>>    Procedure Set ComSelectedItem Variant value
81608>>>>>        Handle hDispatchDriver
81608>>>>>        Get phDispatchDriver to hDispatchDriver
81609>>>>>        Send PrepareParams to hDispatchDriver 1
81610>>>>>        Set ComProperty of hDispatchDriver 15 OLE_VT_DISPATCH to value
81611>>>>>    End_Procedure
81612>>>>>
81612>>>>>    // get the root item
81612>>>>>    Function ComRoot Returns Variant
81614>>>>>        Handle hDispatchDriver
81614>>>>>        Variant retVal
81614>>>>>        Get phDispatchDriver to hDispatchDriver
81615>>>>>        Get InvokeComMethod of hDispatchDriver 16 OLE_VT_VARIANT to retVal
81616>>>>>        Function_Return retVal
81617>>>>>    End_Function
81618>>>>>
81618>>>>>    // get the root item
81618>>>>>    Procedure Set ComRoot Variant value
81620>>>>>        Handle hDispatchDriver
81620>>>>>        Get phDispatchDriver to hDispatchDriver
81621>>>>>        Send PrepareParams to hDispatchDriver 1
81622>>>>>        Set ComProperty of hDispatchDriver 16 OLE_VT_VARIANT to value
81623>>>>>    End_Procedure
81624>>>>>
81624>>>>>    Function ComDepth Returns Integer
81626>>>>>        Handle hDispatchDriver
81626>>>>>        Integer retVal
81626>>>>>        Get phDispatchDriver to hDispatchDriver
81627>>>>>        Get InvokeComMethod of hDispatchDriver 17 OLE_VT_I4 to retVal
81628>>>>>        Function_Return retVal
81629>>>>>    End_Function
81630>>>>>
81630>>>>>    Procedure Set ComDepth Integer value
81632>>>>>        Handle hDispatchDriver
81632>>>>>        Get phDispatchDriver to hDispatchDriver
81633>>>>>        Send PrepareParams to hDispatchDriver 1
81634>>>>>        Set ComProperty of hDispatchDriver 17 OLE_VT_I4 to value
81635>>>>>    End_Procedure
81636>>>>>
81636>>>>>    Function ComMode Returns UInteger
81638>>>>>        Handle hDispatchDriver
81638>>>>>        UInteger retVal
81638>>>>>        Get phDispatchDriver to hDispatchDriver
81639>>>>>        Get InvokeComMethod of hDispatchDriver 18 OLE_VT_UI4 to retVal
81640>>>>>        Function_Return retVal
81641>>>>>    End_Function
81642>>>>>
81642>>>>>    Procedure Set ComMode UInteger value
81644>>>>>        Handle hDispatchDriver
81644>>>>>        Get phDispatchDriver to hDispatchDriver
81645>>>>>        Send PrepareParams to hDispatchDriver 1
81646>>>>>        Set ComProperty of hDispatchDriver 18 OLE_VT_UI4 to value
81647>>>>>    End_Procedure
81648>>>>>
81648>>>>>    Function ComFlags Returns UInteger
81650>>>>>        Handle hDispatchDriver
81650>>>>>        UInteger retVal
81650>>>>>        Get phDispatchDriver to hDispatchDriver
81651>>>>>        Get InvokeComMethod of hDispatchDriver 19 OLE_VT_UI4 to retVal
81652>>>>>        Function_Return retVal
81653>>>>>    End_Function
81654>>>>>
81654>>>>>    Procedure Set ComFlags UInteger value
81656>>>>>        Handle hDispatchDriver
81656>>>>>        Get phDispatchDriver to hDispatchDriver
81657>>>>>        Send PrepareParams to hDispatchDriver 1
81658>>>>>        Set ComProperty of hDispatchDriver 19 OLE_VT_UI4 to value
81659>>>>>    End_Procedure
81660>>>>>
81660>>>>>    Procedure Set ComTVFlags UInteger value
81662>>>>>        Handle hDispatchDriver
81662>>>>>        Get phDispatchDriver to hDispatchDriver
81663>>>>>        Send PrepareParams to hDispatchDriver 1
81664>>>>>        Set ComProperty of hDispatchDriver 20 OLE_VT_UI4 to value
81665>>>>>    End_Procedure
81666>>>>>
81666>>>>>    Function ComTVFlags Returns UInteger
81668>>>>>        Handle hDispatchDriver
81668>>>>>        UInteger retVal
81668>>>>>        Get phDispatchDriver to hDispatchDriver
81669>>>>>        Get InvokeComMethod of hDispatchDriver 20 OLE_VT_UI4 to retVal
81670>>>>>        Function_Return retVal
81671>>>>>    End_Function
81672>>>>>
81672>>>>>    Function ComColumns Returns String
81674>>>>>        Handle hDispatchDriver
81674>>>>>        String retVal
81674>>>>>        Get phDispatchDriver to hDispatchDriver
81675>>>>>        Get InvokeComMethod of hDispatchDriver 21 OLE_VT_BSTR to retVal
81676>>>>>        Function_Return retVal
81677>>>>>    End_Function
81678>>>>>
81678>>>>>    Procedure Set ComColumns String value
81680>>>>>        Handle hDispatchDriver
81680>>>>>        Get phDispatchDriver to hDispatchDriver
81681>>>>>        Send PrepareParams to hDispatchDriver 1
81682>>>>>        Set ComProperty of hDispatchDriver 21 OLE_VT_BSTR to value
81683>>>>>    End_Procedure
81684>>>>>
81684>>>>>    // number of view types
81684>>>>>    Function ComCountViewTypes Returns Integer
81686>>>>>        Handle hDispatchDriver
81686>>>>>        Integer retVal
81686>>>>>        Get phDispatchDriver to hDispatchDriver
81687>>>>>        Get InvokeComMethod of hDispatchDriver 22 OLE_VT_I4 to retVal
81688>>>>>        Function_Return retVal
81689>>>>>    End_Function
81690>>>>>
81690>>>>>    // set view type
81690>>>>>    Procedure ComSetViewType Integer lliType
81692>>>>>        Handle hDispatchDriver
81692>>>>>        Get phDispatchDriver to hDispatchDriver
81693>>>>>        Send PrepareParams to hDispatchDriver 1
81694>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lliType
81695>>>>>        Send InvokeComMethod to hDispatchDriver 23 OLE_VT_VOID
81696>>>>>    End_Procedure
81697>>>>>
81697>>>>>    // collection of selected items
81697>>>>>    Function ComSelectedItems Returns Variant
81699>>>>>        Handle hDispatchDriver
81699>>>>>        Variant retVal
81699>>>>>        Get phDispatchDriver to hDispatchDriver
81700>>>>>        Get InvokeComMethod of hDispatchDriver 24 OLE_VT_DISPATCH to retVal
81701>>>>>        Function_Return retVal
81702>>>>>    End_Function
81703>>>>>
81703>>>>>    // expands item specified depth
81703>>>>>    Procedure ComExpand Variant llvar Integer lliDepth
81705>>>>>        Handle hDispatchDriver
81705>>>>>        Get phDispatchDriver to hDispatchDriver
81706>>>>>        Send PrepareParams to hDispatchDriver 2
81707>>>>>        Send DefineParam to hDispatchDriver OLE_VT_VARIANT llvar
81708>>>>>        Send DefineParam to hDispatchDriver OLE_VT_I4 lliDepth
81709>>>>>        Send InvokeComMethod to hDispatchDriver 25 OLE_VT_VOID
81710>>>>>    End_Procedure
81711>>>>>
81711>>>>>    // unselects all items
81711>>>>>    Procedure ComUnselectAll
81713>>>>>        Handle hDispatchDriver
81713>>>>>        Get phDispatchDriver to hDispatchDriver
81714>>>>>        Send InvokeComMethod to hDispatchDriver 26 OLE_VT_VOID
81715>>>>>    End_Procedure
81716>>>>>End_Class
81717>>>>>
81717>>>>>// CLSID: {55136806-B2DE-11D1-B9F2-00A0C98BC547}
81717>>>>>Class cComDShellNameSpaceEvents is a Mixin
81718>>>>>
81718>>>>>    Procedure OnComFavoritesSelectionChange Integer llcItems Integer llhItem String llstrName String llstrUrl Integer llcVisits String llstrDate Integer llfAvailableOffline
81720>>>>>    End_Procedure
81721>>>>>
81721>>>>>    Procedure OnComSelectionChange
81723>>>>>    End_Procedure
81724>>>>>
81724>>>>>    Procedure OnComDoubleClick
81726>>>>>    End_Procedure
81727>>>>>
81727>>>>>    Procedure OnComInitialized
81729>>>>>    End_Procedure
81730>>>>>
81730>>>>>    Procedure RegisterComEvents
81732>>>>>        Send RegisterComEvent 1 msg_OnComFavoritesSelectionChange
81733>>>>>        Send RegisterComEvent 2 msg_OnComSelectionChange
81734>>>>>        Send RegisterComEvent 3 msg_OnComDoubleClick
81735>>>>>        Send RegisterComEvent 4 msg_OnComInitialized
81736>>>>>    End_Procedure
81737>>>>>End_Class
81738>>>>>
81738>>>>>// CoClass
81738>>>>>// ProgID: ShellNameSpace.ShellNameSpace.1
81738>>>>>// CLSID: {55136805-B2DE-11D1-B9F2-00A0C98BC547}
81738>>>>>Class cComShellNameSpace is a cComAutomationObject
81739>>>>>    Import_Class_Protocol cComIShellNameSpace
81740>>>>>    Import_Class_Protocol cComDShellNameSpaceEvents
81741>>>>>
81741>>>>>    Procedure Construct_Object
81743>>>>>        Forward Send Construct_Object
81745>>>>>        Set psProgID to "{55136805-B2DE-11D1-B9F2-00A0C98BC547}"
81746>>>>>        Set psEventId to "{55136806-B2DE-11D1-B9F2-00A0C98BC547}"
81747>>>>>        Set peAutoCreate to acNoAutoCreate
81748>>>>>    End_Procedure
81749>>>>>End_Class
81750>>>>>
81750>>>>>
81750>>>>>
81750>>>Use Windows.pkg
81750>>>Use BPCoreBase.bp
81750>>>
81750>>>ACTIVATE_VIEW Activate_oVWEMPRESA FOR oVWEMPRESA
81760>>>>
81760>>>Object oVWEMPRESA is a dbView
81762>>>    Set Location to 5 5
81763>>>    Set Size to 239 351
81764>>>    Set Label To "Cadastro da empresa"
81765>>>    Set Border_Style to Border_Thick
81766>>>
81766>>>
81766>>>    Object oGEMPRESA_DD is a GEMPRESADataDictionary
81768>>>    End_Object 
81769>>>
81769>>>    Set Main_DD To oGEMPRESA_DD
81770>>>    Set Server  To oGEMPRESA_DD
81771>>>
81771>>>    Object oIdleRefresh is a cIdleHandler
81773>>>        Procedure OnIdle
81776>>>            Set pbEnabled to False
81777>>>            
81777>>>            // Lˆ o arquivo da logomarca
81777>>>            Boolean bFileExists bComCreated
81777>>>            String sFileOut sFile sExtensao sPath
81777>>>            Integer iPosExt
81777>>>            
81777>>>            Get GetPath_WS of oBPCoreBase "BITMAPS" to sPath
81778>>>            
81778>>>            // Pega apenas o nome do arquivo com a extensÆo    
81778>>>            Move (Left(Trim(sPath), (Pos(";", Trim(sPath), 0)) - 1) + "\logo_" + Trim(GEMPRESA.CNPJ_CPF)) to sFileOut
81779>>>            Direct_Input ("dir: " + sFileOut + ".*")
81780>>>            Readln sFile
81781>>>            
81781>>>            // Pega a extensÆo do arquivo
81781>>>            Move (RightPos("." , sFile)) to iPosExt
81782>>>            If (iPosExt) Move ("." + Right(sFile, Length(sFile) - iPosExt)) to sExtensao
81785>>>            
81785>>>            //Concatena o caminho + o nome do arquivo com a extensÆo
81785>>>            Move (Trim(sFileOut) + Trim(sExtensao)) to sFileOut
81786>>>
81786>>>            File_Exist sFileOut bFileExists
81787>>>            Get IsComObjectCreated of (oBMPLogomarca(Self)) to bComCreated
81788>>>            If (bComCreated) Begin
81790>>>                If (bFileExists) Send ComNavigate of (oBMPLogomarca(Self)) sFileOut 0 0 0 0
81793>>>                Else Send ComNavigate of (oBMPLogomarca(Self)) "about:blank" 0 0 0 0
81795>>>            End
81795>>>>
81795>>>            
81795>>>        End_Procedure
81796>>>    End_Object
81797>>>
81797>>>    Object oGEMPRESACNPJ_CPF is a cDbForm_SI
81799>>>        Entry_Item GEMPRESA.CNPJ_CPF
81800>>>        Set Size to 13 134
81801>>>        Set Location to 9 51
81802>>>        Set peAnchors to anNone
81803>>>        Set Label to "CNPJ/CPF"
81804>>>        Set Label_Justification_mode to jMode_Left
81805>>>        Set Label_Col_Offset to 47
81806>>>        Set Label_row_Offset to 0
81807>>>
81807>>>        Procedure Refresh Integer notifyMode
81810>>>            Forward Send Refresh notifyMode
81812>>>            
81812>>>            Set pbEnabled of oIdleRefresh to True
81813>>>        End_Procedure
81814>>>    End_Object 
81815>>>
81815>>>    Object oGEMPRESATIPO is a cDbComboForm_SI
81817>>>        Entry_Item GEMPRESA.TIPO
81818>>>        Set Size to 13 57
81819>>>        Set Location to 24 51
81820>>>        Set peAnchors to anNone
81821>>>        Set Label to "Tipo"
81822>>>        Set Label_Justification_mode to jMode_Left
81823>>>        Set Label_Col_Offset to 47
81824>>>        Set Label_row_Offset to 0
81825>>>    End_Object 
81826>>>
81826>>>    Object oGEMPRESARAZAO_SOCIAL is a cDbForm_SI
81828>>>        Entry_Item GEMPRESA.RAZAO_SOCIAL
81829>>>        Set Size to 13 294
81830>>>        Set Location to 39 51
81831>>>        Set peAnchors to anNone
81832>>>        Set Label to "RazÆo Social"
81833>>>        Set Label_Justification_mode to jMode_Left
81834>>>        Set Label_Col_Offset to 47
81835>>>        Set Label_row_Offset to 0
81836>>>    End_Object 
81837>>>
81837>>>    Object oGEMPRESANOME_FANTASIA is a cDbForm_SI
81839>>>        Entry_Item GEMPRESA.NOME_FANTASIA
81840>>>        Set Size to 13 294
81841>>>        Set Location to 54 51
81842>>>        Set peAnchors to anNone
81843>>>        Set Label to "Nome Fantasia"
81844>>>        Set Label_Justification_mode to jMode_Left
81845>>>        Set Label_Col_Offset to 47
81846>>>        Set Label_row_Offset to 0
81847>>>    End_Object 
81848>>>
81848>>>    Object oBMPLogomarca is a cComWebBrowser
81850>>>        Set Size to 142 341
81851>>>        Set Location to 73 6
81852>>>        Set Focus_Mode to NonFocusable
81853>>>    End_Object
81854>>>
81854>>>    Object oGroup2 is a Group
81856>>>        Set Size to 35 43
81857>>>        Set Location to 2 303
81858>>>        Set peAnchors to anTopRight
81859>>>
81859>>>        Object oBtnNovo is a Button
81861>>>            Set Size to 14 18
81862>>>            Set Location to 5 3
81863>>>            Set psImage to "New16.bmp"
81864>>>            Set peImageAlign to Button_ImageList_Align_Center
81865>>>            Set psToolTip to "Novo (F5)"
81866>>>        
81866>>>            // fires when the button is clicked
81866>>>            Procedure OnClick
81869>>>                Send Request_Clear
81870>>>            End_Procedure
81871>>>        
81871>>>        End_Object
81872>>>        Object oBtnSalvar is a Button
81874>>>            Set Size to 14 18
81875>>>            Set Location to 5 23
81876>>>            Set psImage to "ActionSave.ico"
81877>>>            Set peImageAlign to Button_ImageList_Align_Center
81878>>>            Set psToolTip to "Salvar (F2)"
81879>>>        
81879>>>            // fires when the button is clicked
81879>>>            Procedure OnClick
81882>>>                Send Request_Save_No_Clear of (focus(Self))
81883>>>            End_Procedure
81884>>>                    
81884>>>        End_Object
81885>>>        Object oBtnExcluir is a Button
81887>>>            Set Size to 14 18
81888>>>            Set Location to 19 3
81889>>>            Set peImageAlign to Button_ImageList_Align_Center
81890>>>            Set psImage to "ActionDelete.ico"
81891>>>            Set psToolTip to "Excluir (Shift+F2)"
81892>>>        
81892>>>            // fires when the button is clicked
81892>>>            Procedure OnClick
81895>>>                Send Request_Delete                
81896>>>            End_Procedure
81897>>>        
81897>>>        End_Object
81898>>>        Object oBtnFechar is a Button
81900>>>            Set Size to 14 18
81901>>>            Set Location to 19 23
81902>>>            Set peImageAlign to Button_ImageList_Align_Center
81903>>>            Set psImage to "Exit.ico"
81904>>>            Set psToolTip to "Sair (Esc)"
81905>>>        
81905>>>            // fires when the button is clicked
81905>>>            Procedure OnClick
81908>>>                Send Close_Panel
81909>>>            End_Procedure
81910>>>            
81910>>>        End_Object
81911>>>    End_Object
81912>>>    
81912>>>    Object oDlgLogomarca is a OpenDialog
81914>>>        String sFolder
81914>>>        Set Filter_String to "Arquivos de Imagem|*.png;*.jpg"
81915>>>        Set Dialog_Caption to "Selecionar logomarca (Max. 100 Kb)"
81916>>>        Get GetPath_WS of oBPCoreBase "BITMAPS" to sFolder
81917>>>        Set Initial_Folder to sFolder                       
81918>>>    End_Object
81919>>>
81919>>>    Object oBtnAddImg is a Button
81921>>>        Set Location to 218 294
81922>>>        Set psImage to "Image_import.ico"
81923>>>        Set peImageAlign to Button_ImageList_Align_Center
81924>>>    
81924>>>        // fires when the button is clicked
81924>>>        Procedure OnClick
81927>>>            Boolean bOpen
81927>>>            String[] sSelectedFiles
81928>>>            String sPath
81928>>>         
81928>>>            Get Show_Dialog of oDlgLogomarca to bOpen
81929>>>            If bOpen Begin
81931>>>                String sFileOut sImageBytes sExtensao // Imagem lida do arquivo
81931>>>                Integer iChannel iChOut iArgSize iLength iPosExt
81931>>>                
81931>>>                Get Selected_Files of oDlgLogomarca to sSelectedFiles
81932>>>                
81932>>>                Get_Argument_Size to iArgSize
81933>>>                
81933>>>                Move (Seq_New_Channel()) to iChannel 
81934>>>                Direct_Input channel iChannel ("binary:" * sSelectedFiles[0])
81936>>>                
81936>>>                // Pega a extensÆo do arquivo
81936>>>                Move (RightPos("." , sSelectedFiles[0])) to iPosExt
81937>>>                If (iPosExt) Move ("." + Right(sSelectedFiles[0], Length(sSelectedFiles[0]) - iPosExt)) to sExtensao
81940>>>                
81940>>>                Get_Channel_Size iChannel to iLength // Tamanho do arquivo
81941>>>                If (iLength <= 100000) Begin
81943>>>                    Read_Block channel iChannel sImageBytes iLength
81945>>>                    Close_Input channel iChannel
81947>>>                    Send Seq_Release_Channel iChannel
81948>>>
81948>>>                    Reread GEMPRESA
81952>>>                    Move sImageBytes to GEMPRESA.LOGO_MARCA
81953>>>                    SaveRecord GEMPRESA
81954>>>                    Unlock
81955>>>>
81955>>>                    
81955>>>                    Get GetPath_WS of oBPCoreBase "BITMAPS" to sPath
81956>>>                    
81956>>>                    // Gravacao da imagem para exibir
81956>>>                    Move (Left(Trim(sPath), (Pos(";", Trim(sPath), 0)) - 1) + "\logo_" + Trim(GEMPRESA.CNPJ_CPF) + sExtensao) to sFileOut
81957>>>                    Move (Seq_New_Channel()) to iChOut
81958>>>                    Direct_Output channel iChOut sFileOut
81960>>>                    Write channel iChOut sImageBytes
81962>>>                    Close_Output channel iChOut
81964>>>                    Send Seq_Release_Channel iChOut
81965>>>                End
81965>>>>
81965>>>                Else Begin
81966>>>                    Send Info_Box "O arquivo deve ter no m ximo 100 Kb." "Tamanho m ximo"
81967>>>                    Close_Input channel iChannel
81969>>>                    Send Seq_Release_Channel iChannel
81970>>>                End
81970>>>>
81970>>>
81970>>>                Send ComNavigate of oBMPLogomarca sFileOut 0 0 0 0
81971>>>                
81971>>>                Set_Argument_Size iArgSize
81972>>>>
81972>>>            End
81972>>>>
81972>>>            Else Send Info_Box "Selecione uma logomarca para gravar"
81974>>>        End_Procedure
81975>>>    
81975>>>    End_Object
81976>>>
81976>>>    Object oBtnDelImg is a Button
81978>>>        Set Location to 218 238
81979>>>        Set psImage to "Delete_1.ico"
81980>>>        Set peImageAlign to Button_ImageList_Align_Center
81981>>>    
81981>>>        // fires when the button is clicked
81981>>>        Procedure OnClick
81984>>>            String sEmpresa sExtensao sPath
81984>>>            String sFileOut sFile sImageBytes // Imagem lida do arquivo
81984>>>            Integer iChannel iChOut iArgSize iPosExt
81984>>>            
81984>>>            Get Value of oGEMPRESACNPJ_CPF to sEmpresa
81985>>>            Move (Replace(".",sEmpresa,"")) to sEmpresa
81986>>>
81986>>>                
81986>>>            Get GetPath_WS of oBPCoreBase "BITMAPS" to sPath
81987>>>            
81987>>>            // Pega apenas o nome do arquivo com a extensÆo    
81987>>>            Move (Left(Trim(sPath), (Pos(";", Trim(sPath), 0)) - 1) + "\logo_" + Trim(GEMPRESA.CNPJ_CPF) + sExtensao) to sFileOut
81988>>>            Direct_Input ("dir: " + sFileOut + ".*")
81989>>>            Readln sFile
81990>>>            
81990>>>            // Pega a extensÆo do arquivo
81990>>>            Move (RightPos("." , sFile)) to iPosExt
81991>>>            If (iPosExt) Move ("." + Right(sFile, Length(sFile) - iPosExt)) to sExtensao
81994>>>            
81994>>>            //Concatena o caminho + o nome do arquivo com a extensÆo
81994>>>            Move (Trim(sFileOut) + Trim(sExtensao)) to sFileOut
81995>>>            
81995>>>            //Apagar arquivo de logomarca
81995>>>            EraseFile (Trim(sFileOut)) 
81996>>>>
81996>>>            Send ComNavigate of oBMPLogomarca sFileOut 0 0 0 0
81997>>>            
81997>>>            Reread GEMPRESA
82001>>>                Move 0 to GEMPRESA.LOGO_MARCA
82002>>>                SaveRecord GEMPRESA
82003>>>            Unlock
82004>>>>
82004>>>
82004>>>        End_Procedure
82005>>>    
82005>>>    End_Object
82006>>>
82006>>>
82006>>>End_Object 
82007>        Use DGLoginCfg.dg
Including file: DGLoginCfg.dg    (C:\Users\Jimerson Carlos\Documents\OneDrive - gcap.com.br\Pessoal\Des\Projetos\vdf\sag-rm\AppSrc\DGLoginCfg.dg)
82007>>>Use Windows.pkg
82007>>>
82007>>>Object oDGLoginCfg is a ModalPanel
82009>>>    Set Border_Style to Border_Thick
82010>>>    Set Label to "DGLoginCfg"
82011>>>    Set Location to 2 2
82012>>>    Set Size to 89 211
82013>>>    Set piMinSize to 89 211
82014>>>
82014>>>    Object oUserIDForm is a Form
82016>>>        Set Label to "Enter your User ID"
82017>>>        Set Size to 13 85
82018>>>        Set Location to 15 79
82019>>>        Set Label_Col_Offset to 64
82020>>>                Set peAnchors to anTopLeftRight
82021>>>
82021>>>        //OnChange will be called on every changed character
82021>>>        //Procedure OnChange
82021>>>        //    String sValue
82021>>>        //
82021>>>        //    Get Value to sValue
82021>>>        //End_Procedure
82021>>>
82021>>>    End_Object
82022>>>
82022>>>    Object oPwdForm is a Form
82024>>>        Set Label to "Enter your Password"
82025>>>        Set Size to 13 85
82026>>>        Set Location to 35 79
82027>>>        Set Label_Col_Offset to 70
82028>>>        Set Password_State to TRUE
82029>>>                Set peAnchors to anTopLeftRight
82030>>>
82030>>>        //OnChange will be called on every changed character
82030>>>        //Procedure OnChange
82030>>>        //    String sValue
82030>>>        //
82030>>>        //    Get Value to sValue
82030>>>        //End_Procedure
82030>>>
82030>>>    End_Object
82031>>>
82031>>>    Object oOK_btn is a Button
82033>>>        Set Label to "&OK"
82034>>>        Set Location to 71 102
82035>>>        Set peAnchors to anBottomRight
82036>>>
82036>>>        Procedure OnClick
82039>>>            Boolean bOK
82039>>>
82039>>>            // Validate_UserInformation is a method you should define
82039>>>            // using the criteria you need to validate user_ids and passwords
82039>>>            // in your program
82039>>>            Get Validate_UserInformation to bOK
82040>>>            If (bOK) Begin
82042>>>                Send Close_Panel
82043>>>            End
82043>>>>
82043>>>            Else Begin
82044>>>                Send Info_Box "Usu rio ou senha incorretos!" "Informativo"
82045>>>            End
82045>>>>
82045>>>        End_Procedure
82046>>>    End_Object
82047>>>
82047>>>    Object oCancel_btn is a Button
82049>>>        Set Label to "&Cancel"
82050>>>        Set Location to 71 157
82051>>>        Set peAnchors to anBottomRight
82052>>>
82052>>>        Procedure OnClick
82055>>>            Send Close_Panel
82056>>>        End_Procedure
82057>>>    End_Object
82058>>>
82058>>>    // Change this method in order to validate
82058>>>    // the user and password typed in the forms of this dialog
82058>>>    Function Validate_UserInformation Returns Boolean
82061>>>        Boolean bValid
82061>>>        String sUserID sPwd
82061>>>
82061>>>        Get value of oUserIDForm to sUserID
82062>>>        Get value of oPwdForm to sPwd
82063>>>        
82063>>>        If (Trim(Uppercase(sUserID)) = 'M1A1' and trim(Uppercase(sPwd)) = 'M1A1') Begin 
82065>>>            Move (Trim(Uppercase(sUserID))) to gsCodUser
82066>>>            Move True to bValid
82067>>>        End
82067>>>>
82067>>>        Else Begin 
82068>>>            Move '' to gsCodUser
82069>>>            Move False to bValid
82070>>>        End
82070>>>>
82070>>>        Move bValid to gbLoginCfg
82071>>>
82071>>>        Function_Return bValid
82072>>>    End_Function
82073>>>
82073>>>    On_Key Key_Alt+Key_O Send KeyAction of oOk_btn
82074>>>    On_Key Key_Alt+Key_C Send KeyAction of oCancel_btn
82075>>>End_Object
82076>>>
82076>
82076>        Procedure Activate_About
82079>            Send DoAbout "" "" "" "" ""
82080>        End_Procedure
82081>        
82081>        Object oIdleHandleDgLogin is a cIdleHandler
82083>            Procedure OnIdle
82086>                String sResult
82086>                
82086>                Set pbEnabled to False
82087>                
82087>                Send Popup_Modal to oDGLoginCfg
82088>                //Set pbEnabled of (oMain(oCommandBarSystem(oMenuBar(oViewMenu(Self))))) to gbLoginCfg
82088>                
82088>            End_Procedure      
82089>        End_Object
82090>        
82090>        Procedure Entering_Scope Returns Integer
82093>            Integer iRetVal
82093>            Forward Get msg_Entering_Scope to iRetVal
82095>            
82095>            Set pbEnabled of oIdleHandleDgLogin to True
82096>            
82096>            Procedure_Return iRetVal
82097>        End_Procedure
82098>
82098>    End_Object
82099>
82099>End_Object
82100>
82100>Start_UI
82101>
Summary
Memory Available: 2147483646
Total Warnings : 0
Total Errors   : 0
Total Symbols  : 46351
Total Resources: 0
Total Commands : 82100
Total Windows  : 1
Total Pages    : 1
Static Data    : 498489
Message area   : 567793
Total Blocks   : 29340
